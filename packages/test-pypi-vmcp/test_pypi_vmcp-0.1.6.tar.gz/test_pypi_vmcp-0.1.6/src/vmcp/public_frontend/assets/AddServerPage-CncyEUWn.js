import{j as e}from"./ui-DNQDtwue.js";import{r as x,W as O}from"./vendor-HYqqWE7B.js";import{u as I,e as D,f as _,B as u,P as b,S as F,I as c,G as N,r as h,n as J,a as B}from"./index-CIKZHYu_.js";import{C as q,a as H}from"./card-DWrRA40y.js";import{A as L,a as M}from"./alert-DzUt8RdD.js";import{S as p}from"./separator-D88cCeUq.js";import{A as R}from"./arrow-left-CpOOR2_n.js";import{T as U}from"./triangle-alert-DygTjznp.js";import{T as g,W as y}from"./wifi-BjaPai-i.js";import{C as W}from"./circle-check-big-BYCA3xfh.js";import{R as G}from"./refresh-cw-Wqq_BhAe.js";function te(){const l=I(),{user:C,loading:d,isAuthenticated:v}=D(),{success:S,error:k}=_(),[i,f]=x.useState(!1),[j,n]=x.useState(null),[s,w]=x.useState({name:"",description:"",transport:"stdio",command:"",url:"",args:"",env:"",headers:"",auto_connect:!1,enabled:!0});O.useEffect(()=>{if(!d&&!v){l.push("/login");return}},[d,v,l]);const T=async r=>{if(r.preventDefault(),!s.name.trim()){n("Server name is required");return}if(s.transport==="stdio"&&!s.command.trim()){n("Command is required for STDIO transport");return}if((s.transport==="http"||s.transport==="sse")&&!s.url.trim()){n("URL is required for HTTP/SSE transport");return}if(s.env.trim()&&s.env!=="{}")try{JSON.parse(s.env)}catch{n('Environment variables must be valid JSON (e.g., {"KEY": "value"})');return}if(s.headers.trim()&&s.headers!=="{}")try{JSON.parse(s.headers)}catch{n('Headers must be valid JSON (e.g., {"Authorization": "Bearer token"})');return}f(!0),n(null);try{const a=localStorage.getItem("access_token");if(!a)throw new Error("No access token available");const o={name:s.name,mode:s.transport,description:s.description,command:s.transport==="stdio"?s.command:void 0,args:s.args?s.args.split(",").map(P=>P.trim()):void 0,env:s.env?JSON.parse(s.env):void 0,url:s.transport==="http"||s.transport==="sse"?s.url:void 0,headers:s.headers?JSON.parse(s.headers):void 0,auto_connect:s.auto_connect,enabled:s.enabled},m=await J.installMCPServer(o,a);if(m.success)console.log("âœ… Server added successfully:",m.server),S("Server added successfully!"),l.push("/servers?success=added");else throw new Error(m.error||"Failed to add server")}catch(a){const o=a instanceof Error?a.message:"Failed to add server";n(o),k(o),console.error("Error adding server:",a)}finally{f(!1)}},t=(r,a)=>{w(o=>({...o,[r]:a}))},A=r=>{switch(r){case"stdio":return g;case"http":return N;case"sse":return y;default:return B}};if(d)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})});if(!C)return null;const E=A(s.transport);return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"h-screen overflow-y-auto",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center gap-4 mb-6",children:e.jsxs(u,{variant:"ghost",onClick:()=>l.push("/servers"),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Back to Servers"]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(b,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Add MCP Server"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure a new Model Context Protocol server connection"})]})]})]}),j&&e.jsxs(L,{variant:"destructive",className:"mb-6",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx(M,{children:j})]}),e.jsxs("form",{onSubmit:T,children:[e.jsx(q,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(H,{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(F,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Basic Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Server Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(c,{type:"text",value:s.name,onChange:r=>t("name",r.target.value),placeholder:"my-mcp-server",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Unique identifier for this server"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Transport Type ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"stdio",label:"STDIO",icon:g,desc:"Command line process"},{value:"http",label:"HTTP",icon:N,desc:"HTTP endpoint"},{value:"sse",label:"SSE",icon:y,desc:"Server-sent events"}].map(r=>{const a=r.icon;return e.jsxs("button",{type:"button",onClick:()=>t("transport",r.value),className:`p-4 rounded-lg border-2 text-center transition-all ${s.transport===r.value?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50 text-muted-foreground hover:text-foreground"}`,children:[e.jsx(a,{className:"h-6 w-6 mx-auto mb-2"}),e.jsx("div",{className:"font-medium text-sm",children:r.label}),e.jsx("div",{className:"text-xs opacity-75",children:r.desc})]},r.value)})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description"}),e.jsx(h,{value:s.description,onChange:r=>t("description",r.target.value),placeholder:"Brief description of this server",rows:3})]})]}),s.transport==="stdio"&&e.jsxs("div",{className:"mb-8 pt-8",children:[e.jsx(p,{className:"mb-6"}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(g,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"STDIO Configuration"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Command ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(c,{type:"text",value:s.command,onChange:r=>t("command",r.target.value),placeholder:"python -m mcp_server",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Command to execute the MCP server"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Arguments"}),e.jsx(c,{type:"text",value:s.args,onChange:r=>t("args",r.target.value),placeholder:'["--config", "config.json"] or --config config.json'}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Command line arguments (JSON array or space-separated)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Environment Variables"}),e.jsx(h,{value:s.env,onChange:r=>t("env",r.target.value),placeholder:'{"API_KEY": "your-key", "DEBUG": "true"}',rows:3}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Environment variables as JSON object"})]})]})]}),(s.transport==="http"||s.transport==="sse")&&e.jsxs("div",{className:"mb-8 pt-8",children:[e.jsx(p,{className:"mb-6"}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(E,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsxs("h3",{className:"text-xl font-semibold text-foreground",children:[s.transport.toUpperCase()," Configuration"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Server URL ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(c,{type:"url",value:s.url,onChange:r=>t("url",r.target.value),placeholder:"https://api.example.com/mcp",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Full URL to the MCP server endpoint"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"HTTP Headers"}),e.jsx(h,{value:s.headers,onChange:r=>t("headers",r.target.value),placeholder:'{"User-Agent": "MCP-Client", "Accept": "application/json"}',rows:3}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Custom HTTP headers as JSON object"})]})]})]}),e.jsxs("div",{className:"pt-8",children:[e.jsx(p,{className:"mb-6"}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(W,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Connection Options"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"auto_connect",checked:s.auto_connect,onChange:r=>t("auto_connect",r.target.checked),className:"w-4 h-4 text-primary bg-background border-border rounded focus:ring-primary focus:ring-2"}),e.jsx("label",{htmlFor:"auto_connect",className:"ml-3 text-sm text-foreground",children:"Auto-connect on startup"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"enabled",checked:s.enabled,onChange:r=>t("enabled",r.target.checked),className:"w-4 h-4 text-primary bg-background border-border rounded focus:ring-primary focus:ring-2"}),e.jsx("label",{htmlFor:"enabled",className:"ml-3 text-sm text-foreground",children:"Enabled"})]})]})]})]})}),e.jsxs("div",{className:"flex gap-4 justify-end mt-8 pb-6",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>l.push("/servers"),disabled:i,children:"Cancel"}),e.jsx(u,{type:"submit",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding Server..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Server"]})})]})]})]})})})}export{te as default};
//# sourceMappingURL=AddServerPage-CncyEUWn.js.map
