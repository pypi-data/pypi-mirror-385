import{j as e}from"./ui-DNQDtwue.js";import{f as U,r as d,W as q}from"./vendor-HYqqWE7B.js";import{u as H,e as R,f as M,B as p,a as y,S as W,I as x,G as C,r as g,n as k}from"./index-CIKZHYu_.js";import{C as w,a as T}from"./card-DWrRA40y.js";import{A as G,a as z}from"./alert-DzUt8RdD.js";import{B as K}from"./badge-B3GQfgeA.js";import{S as v}from"./separator-D88cCeUq.js";import{A as Y}from"./arrow-left-CpOOR2_n.js";import{S as V}from"./square-pen-CEx3w6DD.js";import{T as $}from"./triangle-alert-DygTjznp.js";import{T as f,W as E}from"./wifi-BjaPai-i.js";import{C as Q}from"./circle-check-big-BYCA3xfh.js";import{R as X}from"./refresh-cw-Wqq_BhAe.js";import{S as Z}from"./save-BpFT7_1H.js";function pe(){const i=H(),m=U().name,{user:A,loading:u,isAuthenticated:j}=R(),{success:_,error:D}=M(),[h,b]=d.useState(!1),[O,I]=d.useState(!0),[N,n]=d.useState(null),[c,P]=d.useState(null),[s,S]=d.useState({name:"",description:"",transport:"stdio",command:"",url:"",args:"",env:"",headers:"",auto_connect:!1,enabled:!0});q.useEffect(()=>{if(!u&&!j){i.push("/login");return}},[u,j,i]),d.useEffect(()=>{(async()=>{if(m)try{const a=localStorage.getItem("access_token");if(!a){n("No access token available");return}const l=await k.getServerByName(m,a);if(!l.success){n(l.error||"Failed to load server data");return}const t=l.data;P(t),S({name:t.name,description:t.description||"",transport:t.transport_type,command:t.command||"",url:t.url||"",args:Array.isArray(t.args)?t.args.join(", "):"",env:t.env?JSON.stringify(t.env,null,2):"{}",headers:t.headers?JSON.stringify(t.headers,null,2):"{}",auto_connect:t.auto_connect,enabled:t.enabled})}catch(a){n(a instanceof Error?a.message:"Failed to load server data")}finally{I(!1)}})()},[m]);const B=async r=>{if(r.preventDefault(),!s.name.trim()){n("Server name is required");return}if(s.transport==="stdio"&&!s.command.trim()){n("Command is required for STDIO transport");return}if((s.transport==="http"||s.transport==="sse")&&!s.url.trim()){n("URL is required for HTTP/SSE transport");return}if(s.env.trim()&&s.env!=="{}")try{JSON.parse(s.env)}catch{n('Environment variables must be valid JSON (e.g., {"KEY": "value"})');return}if(s.headers.trim()&&s.headers!=="{}")try{JSON.parse(s.headers)}catch{n('Headers must be valid JSON (e.g., {"Authorization": "Bearer token"})');return}b(!0),n(null);try{const a=localStorage.getItem("access_token");if(!a)throw new Error("No access token available");const l={name:s.name,mode:s.transport,description:s.description,command:s.transport==="stdio"?s.command:void 0,args:s.args?s.args.split(",").map(L=>L.trim()):void 0,env:s.env?JSON.parse(s.env):void 0,url:s.transport==="http"||s.transport==="sse"?s.url:void 0,headers:s.headers?JSON.parse(s.headers):void 0,auto_connect:s.auto_connect,enabled:s.enabled},t=await k.updateServer(m,l,a);if(!t.success)throw new Error(t.error||"Failed to update server");_("Server updated successfully!"),i.push("/servers?success=updated")}catch(a){const l=a instanceof Error?a.message:"Failed to update server";n(l),D(l),console.error("Error updating server:",a)}finally{b(!1)}},o=(r,a)=>{S(l=>({...l,[r]:a}))},F=r=>{switch(r){case"stdio":return f;case"http":return C;case"sse":return E;default:return y}};if(u||O)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})});if(!A)return null;const J=F(s.transport);return e.jsx("div",{className:"min-h-screen",children:e.jsx("div",{className:"h-screen overflow-y-auto",children:e.jsxs("div",{className:"mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center gap-4 mb-6",children:e.jsxs(p,{variant:"ghost",onClick:()=>i.push("/servers"),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Back to Servers"]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-orange-100 dark:bg-orange-900 flex items-center justify-center",children:e.jsx(V,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Edit MCP Server"}),e.jsxs("p",{className:"text-muted-foreground",children:["Update configuration for ",m]})]})]})]}),c&&e.jsx(w,{className:"mb-6",children:e.jsxs(T,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary mb-2",children:[e.jsx(y,{size:20}),e.jsx("span",{className:"font-medium",children:"Current Server Info"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(K,{variant:c.status==="connected"?"default":c.status==="disconnected"?"secondary":"destructive",className:"ml-2 text-xs",children:c.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Transport:"}),e.jsx("span",{className:"ml-2 text-foreground",children:c.transport_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Connected:"}),e.jsx("span",{className:"ml-2 text-foreground",children:c.last_connected?new Date(c.last_connected).toLocaleDateString():"Never"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Capabilities:"}),e.jsxs("span",{className:"ml-2 text-foreground",children:[Object.values(c.capabilities).filter(Boolean).length,"/3"]})]})]})]})}),N&&e.jsxs(G,{variant:"destructive",className:"mb-6",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx(z,{children:N})]}),e.jsxs("form",{onSubmit:B,children:[e.jsx(w,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(T,{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Basic Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Server Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(x,{type:"text",value:s.name,onChange:r=>o("name",r.target.value),placeholder:"my-mcp-server",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Unique identifier for this server"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Transport Type ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"stdio",label:"STDIO",icon:f,desc:"Command line process"},{value:"http",label:"HTTP",icon:C,desc:"HTTP endpoint"},{value:"sse",label:"SSE",icon:E,desc:"Server-sent events"}].map(r=>{const a=r.icon;return e.jsxs("button",{type:"button",onClick:()=>o("transport",r.value),className:`p-4 rounded-lg border-2 text-center transition-all ${s.transport===r.value?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50 text-muted-foreground hover:text-foreground"}`,children:[e.jsx(a,{className:"h-6 w-6 mx-auto mb-2"}),e.jsx("div",{className:"font-medium text-sm",children:r.label}),e.jsx("div",{className:"text-xs opacity-75",children:r.desc})]},r.value)})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description"}),e.jsx(g,{value:s.description,onChange:r=>o("description",r.target.value),placeholder:"Brief description of this server",rows:3})]})]}),s.transport==="stdio"&&e.jsxs("div",{className:"mb-8 pt-8",children:[e.jsx(v,{className:"mb-6"}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(f,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"STDIO Configuration"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Command ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(x,{type:"text",value:s.command,onChange:r=>o("command",r.target.value),placeholder:"python -m mcp_server",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Command to execute the MCP server"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Arguments"}),e.jsx(x,{type:"text",value:s.args,onChange:r=>o("args",r.target.value),placeholder:'["--config", "config.json"] or --config config.json'}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Command line arguments (JSON array or space-separated)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Environment Variables"}),e.jsx(g,{value:s.env,onChange:r=>o("env",r.target.value),placeholder:'{"API_KEY": "your-key", "DEBUG": "true"}',rows:3}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Environment variables as JSON object"})]})]})]}),(s.transport==="http"||s.transport==="sse")&&e.jsxs("div",{className:"mb-8 pt-8",children:[e.jsx(v,{className:"mb-6"}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(J,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsxs("h3",{className:"text-xl font-semibold text-foreground",children:[s.transport.toUpperCase()," Configuration"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Server URL ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(x,{type:"url",value:s.url,onChange:r=>o("url",r.target.value),placeholder:"https://api.example.com/mcp",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Full URL to the MCP server endpoint"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"HTTP Headers"}),e.jsx(g,{value:s.headers,onChange:r=>o("headers",r.target.value),placeholder:'{"User-Agent": "MCP-Client", "Accept": "application/json"}',rows:3}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Custom HTTP headers as JSON object"})]})]})]}),e.jsxs("div",{className:"pt-8",children:[e.jsx(v,{className:"mb-6"}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Q,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Connection Options"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"auto_connect",checked:s.auto_connect,onChange:r=>o("auto_connect",r.target.checked),className:"w-4 h-4 text-primary bg-background border-border rounded focus:ring-primary focus:ring-2"}),e.jsx("label",{htmlFor:"auto_connect",className:"ml-3 text-sm text-foreground",children:"Auto-connect on startup"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"enabled",checked:s.enabled,onChange:r=>o("enabled",r.target.checked),className:"w-4 h-4 text-primary bg-background border-border rounded focus:ring-primary focus:ring-2"}),e.jsx("label",{htmlFor:"enabled",className:"ml-3 text-sm text-foreground",children:"Enabled"})]})]})]})]})}),e.jsxs("div",{className:"flex gap-4 justify-end mt-8 pb-6",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>i.push("/servers"),disabled:h,children:"Cancel"}),e.jsx(p,{type:"submit",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating Server..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Update Server"]})})]})]})]})})})}export{pe as default};
//# sourceMappingURL=EditServerPage-DXVvIYd-.js.map
