import{j as e}from"./ui-DNQDtwue.js";import{r as a}from"./vendor-HYqqWE7B.js";import{c as U,s as f,u as ue,f as he,O as ge,B as p,a as H,I as fe,A as je,S as pe,C as Ne,n as be}from"./index-CIKZHYu_.js";import{C as h,a as g,d as R,b as A,c as M}from"./card-DWrRA40y.js";import{B as O}from"./badge-B3GQfgeA.js";import{a as $,C as ve}from"./checkbox-BJoNt-Yh.js";import{S as P}from"./searchable-select-GMvT-rjf.js";import{R as q}from"./refresh-cw-Wqq_BhAe.js";import{A as we}from"./activity-CDRN6tWN.js";import{B as b,C as ye}from"./chevron-left-1p-5aAjy.js";import{Z as Ce}from"./zap-Dz7rlsxm.js";import{C as J}from"./chevron-down-DBexedX7.js";import{C as ke}from"./clock-ChxKOB9y.js";import{F as Se}from"./file-text-C4BplQr4.js";import"./check-kIa0kVRI.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Q=U("funnel",_e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Fe=U("target",Te),L=a.forwardRef(({className:l,...t},n)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:n,className:f("w-full caption-bottom text-sm",l),...t})}));L.displayName="Table";const G=a.forwardRef(({className:l,...t},n)=>e.jsx("thead",{ref:n,className:f("[&_tr]:border-b",l),...t}));G.displayName="TableHeader";const K=a.forwardRef(({className:l,...t},n)=>e.jsx("tbody",{ref:n,className:f("[&_tr:last-child]:border-0",l),...t}));K.displayName="TableBody";const Re=a.forwardRef(({className:l,...t},n)=>e.jsx("tfoot",{ref:n,className:f("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...t}));Re.displayName="TableFooter";const _=a.forwardRef(({className:l,...t},n)=>e.jsx("tr",{ref:n,className:f("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...t}));_.displayName="TableRow";const d=a.forwardRef(({className:l,...t},n)=>e.jsx("th",{ref:n,className:f("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l),...t}));d.displayName="TableHead";const o=a.forwardRef(({className:l,...t},n)=>e.jsx("td",{ref:n,className:f("p-4 align-middle [&:has([role=checkbox])]:pr-0",l),...t}));o.displayName="TableCell";const Ae=a.forwardRef(({className:l,...t},n)=>e.jsx("caption",{ref:n,className:f("mt-4 text-sm text-muted-foreground",l),...t}));Ae.displayName="TableCaption";const Z=({data:l,label:t,maxChars:n})=>{const[v,C]=a.useState(!1),j=JSON.stringify(l,null,2),w=j.length>n,i=v?j:w?j.substring(0,n)+"...":j;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t}),w&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>C(!v),className:"h-6 px-2 text-xs hover:bg-muted",children:v?"Show Less":"Show More"})]}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto whitespace-pre-wrap border border-border",children:i})]})};function Ge(){ue();const{error:l}=he(),[t,n]=a.useState(null),[v,C]=a.useState(!0),[j,w]=a.useState(!1),[i,W]=a.useState(1),[k]=a.useState(20),[m,D]=a.useState([]),[x,I]=a.useState([]),[u,B]=a.useState([]),[V,z]=a.useState(""),[r,X]=a.useState({index:!0,client:!0,timestamp:!0,method:!0,vmcp:!0,mcpServer:!0,operationId:!0,arguments:!0,result:!0,activeConfig:!0}),[T,Y]=a.useState(!0),[F,ee]=a.useState(!0),[Me,Pe]=a.useState(0),N=async(s=1,c={})=>{try{C(!0);const S=localStorage.getItem("access_token");if(!S){l("Please log in to view stats");return}const y=await be.getStats({page:s,limit:k,...c},S);if(y.success&&y.data){const de={...y.data,logs:y.data.logs.sort((me,xe)=>new Date(xe.timestamp).getTime()-new Date(me.timestamp).getTime())};n(de),W(s)}else l(y.error||"Failed to fetch stats")}catch(S){console.error("Error fetching stats:",S),l("Failed to fetch stats")}finally{C(!1),w(!1)}},se=()=>{w(!0);const s={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0};N(1,s)},te=()=>{const s={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0};N(1,s)},E=s=>{if(s!==i&&s>=1&&s<=(t?.pagination.total_pages||1)){const c={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0};N(s,c)}},ae=()=>{const s={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0,search:V||void 0};N(1,s)},re=()=>{D([]),I([]),B([]),z(""),N(1,{})};a.useEffect(()=>{N(1,{})},[]);const le=s=>new Date(s).toLocaleString(),ne=s=>{const c=s.toLowerCase();return c.includes("claude")?e.jsx(b,{className:"h-4 w-4 text-orange-600"}):c.includes("visual studio")||c.includes("vscode")||c.includes("vs code")?e.jsx(b,{className:"h-4 w-4 text-blue-600"}):c.includes("cursor")?e.jsx(b,{className:"h-4 w-4 text-purple-600"}):c.includes("gemini")?e.jsx(b,{className:"h-4 w-4 text-yellow-600"}):e.jsx(b,{className:"h-4 w-4 text-blue-600"})},ce=s=>s.includes("tool")?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s.includes("resource")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s.includes("prompt")?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",oe=s=>{X(c=>({...c,[s]:!c[s]}))},ie=[{key:"index",label:"#"},{key:"client",label:"Client"},{key:"timestamp",label:"Timestamp"},{key:"method",label:"Method"},{key:"vmcp",label:"vMCP"},{key:"mcpServer",label:"MCP Server"},{key:"operationId",label:"Operation ID"},{key:"arguments",label:"Arguments"},{key:"result",label:"Result"},{key:"activeConfig",label:"Active Config"}];return v?e.jsx("div",{className:"min-h-screen text-foreground flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading stats..."})]})}):e.jsxs("div",{className:"min-h-screen mx-auto p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(ge,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Statistics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Comprehensive analytics and logs overview"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(p,{onClick:se,disabled:j,variant:"outline",size:"sm",children:[e.jsx(q,{className:`h-4 w-4 mr-2 ${j?"animate-spin":""}`}),"Refresh"]})})]})}),t&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-2 mb-4",children:[e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(we,{className:"h-3 w-3 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Total Logs"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_logs.toLocaleString()})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(b,{className:"h-3 w-3 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Active Clients"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_agents})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-purple-100 dark:bg-purple-900 flex items-center justify-center",children:e.jsx(H,{className:"h-3 w-3 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"vMCPs"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_vmcps})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-orange-100 dark:bg-orange-900 flex items-center justify-center",children:e.jsx(Ce,{className:"h-3 w-3 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Tool Calls"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_tool_calls.toLocaleString()})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-cyan-100 dark:bg-cyan-900 flex items-center justify-center",children:e.jsx(Fe,{className:"h-3 w-3 text-cyan-600 dark:text-cyan-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Avg Tools/Call"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.avg_tools_per_call})]})]})})})]}),e.jsxs(h,{className:"mb-4",children:[e.jsxs(R,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>Y(!T),children:[e.jsxs(A,{className:"text-foreground flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Filters & Search"]}),T?e.jsx(J,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})]}),e.jsx(M,{className:"text-muted-foreground",children:"Filter logs by client, vMCP, method, or search across all fields"})]}),!T&&e.jsxs(g,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"vMCP Name"}),e.jsx(P,{options:t?.filter_options?.vmcp_names||[],value:x,onValueChange:I,placeholder:"Select vMCPs...",searchPlaceholder:"Search vMCPs...",emptyText:"No vMCPs found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Client Name"}),e.jsx(P,{options:t?.filter_options?.agent_names||[],value:m,onValueChange:D,placeholder:"Select clients...",searchPlaceholder:"Search clients...",emptyText:"No clients found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Method"}),e.jsx(P,{options:t?.filter_options?.methods||[],value:u,onValueChange:B,placeholder:"Select methods...",searchPlaceholder:"Search methods...",emptyText:"No methods found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Search"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(fe,{placeholder:"Search logs...",value:V,onChange:s=>z(s.target.value),className:"bg-background border-border text-foreground"}),e.jsx(p,{onClick:ae,size:"sm",children:e.jsx(je,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{onClick:te,className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Apply Filters"]}),e.jsx(p,{onClick:re,variant:"outline",className:"flex items-center gap-2",children:"Clear Filters"})]})]})]}),e.jsxs(h,{className:"mb-4",children:[e.jsxs(R,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>ee(!F),children:[e.jsxs(A,{className:"text-foreground flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),"Column Visibility"]}),F?e.jsx(J,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})]}),e.jsx(M,{className:"text-muted-foreground",children:"Select which columns to display in the logs table"})]}),!F&&e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:ie.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{id:s.key,checked:r[s.key],onCheckedChange:()=>oe(s.key)}),e.jsx("label",{htmlFor:s.key,className:"text-sm font-medium text-foreground cursor-pointer",children:s.label})]},s.key))})})]}),e.jsxs(h,{children:[e.jsxs(R,{children:[e.jsx(A,{className:"text-foreground",children:"System Logs"}),e.jsx(M,{className:"text-muted-foreground",children:"Detailed view of all system activities with filtering and pagination"})]}),e.jsxs(g,{children:[e.jsxs("div",{className:"w-full overflow-hidden",children:[e.jsx("div",{className:"sticky top-0 bg-background z-30 border-b border-border",children:e.jsx(L,{className:"min-w-full",children:e.jsx(G,{children:e.jsxs(_,{className:"border-border",children:[r.index&&e.jsx(d,{className:"text-muted-foreground w-[2%] bg-background",children:"#"}),r.client&&e.jsx(d,{className:"text-muted-foreground w-[8%] bg-background",children:"Client"}),r.timestamp&&e.jsx(d,{className:"text-muted-foreground w-[12%] bg-background",children:"Timestamp"}),r.method&&e.jsx(d,{className:"text-muted-foreground w-[10%] bg-background",children:"Method"}),r.vmcp&&e.jsx(d,{className:"text-muted-foreground w-[12%] bg-background",children:"vMCP"}),r.mcpServer&&e.jsx(d,{className:"text-muted-foreground w-[10%] bg-background",children:"MCP Server"}),r.operationId&&e.jsx(d,{className:"text-muted-foreground w-[13%] bg-background",children:"Operation ID"}),r.arguments&&e.jsx(d,{className:"text-muted-foreground w-[15%] bg-background",children:"Arguments"}),r.result&&e.jsx(d,{className:"text-muted-foreground w-[15%] bg-background",children:"Result"}),r.activeConfig&&e.jsx(d,{className:"text-muted-foreground w-[10%] bg-background",children:"Active Config"})]})})})}),e.jsx("div",{id:"logs-table-container",className:"h-[700px] overflow-auto",children:e.jsx(L,{className:"min-w-full",children:e.jsx(K,{children:t&&t.logs&&t.logs.length>0?t.logs.map((s,c)=>e.jsxs(_,{className:"border-border hover:bg-muted/50",children:[r.index&&e.jsx(o,{className:"text-foreground font-medium text-center w-[5%]",children:(i-1)*k+c+1}),r.client&&e.jsx(o,{className:"text-foreground w-[8%]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[ne(s.agent_name),e.jsx("span",{className:"text-sm font-medium truncate",children:s.agent_name})]})}),r.timestamp&&e.jsx(o,{className:"text-foreground w-[12%]",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ke,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate",children:le(s.timestamp)})]})}),r.method&&e.jsx(o,{className:"text-foreground w-[10%]",children:e.jsx(O,{className:`text-xs ${ce(s.method)}`,children:s.method})}),r.vmcp&&e.jsx(o,{className:"text-foreground w-[12%]",children:e.jsx("div",{className:"truncate",children:s.vmcp_name?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-3 w-3 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-sm font-mono truncate",children:s.vmcp_name})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),r.mcpServer&&e.jsx(o,{className:"text-foreground w-[10%]",children:e.jsx("div",{className:"truncate",children:s.mcp_server?e.jsx(O,{variant:"secondary",className:"bg-muted text-foreground truncate max-w-full",children:s.mcp_server}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),r.operationId&&e.jsx(o,{className:"text-foreground w-[13%]",children:e.jsx("span",{className:"text-sm font-mono truncate block",children:s.operation_id||"N/A"})}),r.arguments&&e.jsx(o,{className:"text-foreground w-[15%]",children:e.jsx("div",{className:"truncate",children:s.arguments?e.jsx(Z,{data:s.arguments,label:"Arguments",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No arguments"})})}),r.result&&e.jsx(o,{className:"text-foreground w-[15%]",children:e.jsx("div",{className:"truncate",children:s.result?e.jsx(Z,{data:s.result,label:"Result",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No result"})})}),r.activeConfig&&e.jsx(o,{className:"text-foreground w-[10%]",children:e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[s.total_tools||0," tools"]}),e.jsxs("div",{children:[s.total_prompts||0," prompts"]}),e.jsxs("div",{children:[s.total_resources||0," resources"]})]})})]},c)):e.jsx(_,{children:e.jsxs(o,{colSpan:Object.values(r).filter(Boolean).length,className:"text-center py-8",children:[e.jsx(Se,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No logs found"}),e.jsx("p",{className:"text-muted-foreground",children:"Logs will appear here when agents make requests."})]})})})})})]}),t&&t.pagination.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(i-1)*k+1," to ",Math.min(i*k,t.pagination.total)," of ",t.pagination.total," logs"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>E(i-1),disabled:i===1,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground px-3",children:["Page ",i," of ",t.pagination.total_pages]}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>E(i+1),disabled:i>=t.pagination.total_pages,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:["Next",e.jsx(Ne,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})}export{Ge as default};
//# sourceMappingURL=StatsPage-thbeIG22.js.map
