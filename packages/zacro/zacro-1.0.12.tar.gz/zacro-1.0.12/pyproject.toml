[build-system]
requires = ["maturin>=1.0,<2.0"]
build-backend = "maturin"

[project]
name = "zacro"
description = "Fast Rust implementation of xacro with enhanced features for modular robotics"
readme = "README.md"
authors = [{name = "Iori Yanokura"}]
license = {text = "MIT"}
requires-python = ">=3.8"
classifiers = [
    "Development Status :: 3 - Alpha",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Rust",
    "Topic :: Software Development :: Libraries :: Python Modules",
]
version = "1.0.12"

[project.urls]
Repository = "https://github.com/iory/zacro"

[tool.maturin]
features = ["pyo3/extension-module", "python"]
python-source = "python"

[project.scripts]
zacro = "zacro.cli:main"

[project.optional-dependencies]
test = ["pytest", "pytest-cov"]
dev = ["black", "isort", "flake8", "maturin"]

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]

[tool.ruff]
# Exclude directories from linting
extend-exclude = [".?*", "src/", "build", "docs"]
line-length = 120

[tool.ruff.lint]
preview = true

# Enable flake8-style rules
select = [
    "E", # style errors
    "F", # flakes
    "W", # style warnings
    "G", # flake8-logging-format
    "I", # import sorting
]
# Ignore specific rules to match current flake8 config
ignore = [
    "E741",  # ambiguous variable name
]

[tool.ruff.lint.isort]
# Match current isort configuration
force-single-line = true
force-sort-within-sections = true
order-by-type = false
lines-after-imports = 2

[tool.typos]
default.extend-ignore-re = [
    "(?Rm)^.*(#|//)\\s*spellchecker:disable-line$",  # spellchecker:disable-line
    "(?s)(#|//)\\s*spellchecker:off.*?\\n\\s*(#|//)\\s*spellchecker:on",  # spellchecker:<on|off>
    "thre",  # TODO(iory) delete thre by using threshold
]

default.extend-ignore-identifiers-re = [
    # Add individual words here to ignore them
]

[tool.cibuildwheel]
build = "cp38-* cp39-* cp310-* cp311-* cp312-*"
skip = "cp38-win32 cp39-win32 cp310-win32 cp311-win32 cp312-win32 *-win32 *-musllinux*"

[tool.cibuildwheel.linux]
before-all = "curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y && source ~/.cargo/env"
environment = { PATH = "$HOME/.cargo/bin:$PATH" }

[tool.cibuildwheel.macos]
before-all = "curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y && source ~/.cargo/env"
environment = { PATH = "$HOME/.cargo/bin:$PATH" }

[tool.cibuildwheel.windows]
before-all = "rustup-init.exe -y"
environment = { PATH = "$UserProfile\\.cargo\\bin;$PATH" }
