## CVE -> Vulncheck KEV (`cve-vulncheck-kev`)

The intention here is to use vulncheck as the main source of KEVs.

If this service ever goes offline, we can default back to CISA (`cve-kev`).

The following request returns a list of Vulncheck KEV backups (all KEVs)

```shell
curl --request GET \
    --url 'https://api.vulncheck.com/v3/backup/vulncheck-kev' \
    --header 'Accept: application/json' \
    --header 'Authorization: Bearer insert_token_here'
```

The response contains a download URL to a zip file (`url`) that contains a 50mb json file.

Each entry is structured as shown below;

```json
    {
      "vendorProject": "Google",
      "product": "Chromium",
      "shortDescription": "Google Chromium contains an improper input validation vulnerability in ANGLE and GPU. This vulnerability could allow a remote attacker to potentially perform a sandbox escape via a crafted HTML page. This vulnerability could affect multiple web browsers that utilize Chromium, including, but not limited to, Google Chrome, Microsoft Edge, and Opera.",
      "vulnerabilityName": "Google Chromium ANGLE and GPU Improper Input Validation Vulnerability",
      "required_action": "Apply mitigations per vendor instructions, follow applicable BOD 22-01 guidance for cloud services, or discontinue use of the product if mitigations are unavailable.",
      "knownRansomwareCampaignUse": "Unknown",
      "cve": [
        "CVE-2025-6558"
      ],
      "cwes": [
        "CWE-20"
      ],
      "vulncheck_xdb": [
        {
          "xdb_id": "04497c8079e3",
          "xdb_url": "https://vulncheck.com/xdb/04497c8079e3",
          "date_added": "2025-07-24T01:32:45Z",
          "exploit_type": "client-side",
          "clone_ssh_url": "git@github.com:DevBuiHieu/CVE-2025-6558-Proof-Of-Concept.git"
        }
      ],
      "vulncheck_reported_exploitation": [
        {
          "url": "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json",
          "date_added": "2025-07-22T00:00:00Z"
        },
        {
          "url": "https://chromereleases.googleblog.com/2025/07/stable-channel-update-for-desktop_15.html",
          "date_added": "2025-07-15T00:00:00Z"
        },
        {
          "url": "https://45734016.fs1.hubspotusercontent-na1.net/hubfs/45734016/Global%20Threat%20Report%2c%202025.pdf",
          "date_added": "2025-07-28T00:00:00Z"
        },
        {
          "url": "https://cert.europa.eu/publications/threat-intelligence/cb25-08/",
          "date_added": "2025-08-04T00:00:00Z"
        }
      ],
      "dueDate": "2025-08-12T00:00:00Z",
      "cisa_date_added": "2025-07-22T00:00:00Z",
      "date_added": "2025-07-15T00:00:00Z",
      "_timestamp": "2025-08-05T01:25:10.330253129Z"
    },
```

It is also possible to do this per CVE, e.g.

Get a CVE

```shell
curl --request GET \
    --url 'https://api.vulncheck.com/v3/index/vulncheck-kev?cve=CVE-2025-6558' \
    --header 'Accept: application/json' \
    --header 'Authorization: Bearer insert_token_here'
```

Get first page of 500

```shell
curl --request GET \
    --url 'https://api.vulncheck.com/v3/index/vulncheck-kev?page=1&limit=500' \
    --header 'Accept: application/json' \
    --header 'Authorization: Bearer insert_token_here'
```

Get last mod after

```shell
curl --request GET \
    --url 'https://api.vulncheck.com/v3/index/vulncheck-kev?lastModStartDate=2024-01-01' \
    --header 'Accept: application/json' \
    --header 'Authorization: Bearer insert_token_here'
```

More docs https://docs.vulncheck.com/api/indice

On run-time (`cve-vulncheck-kev` request) we grab the latest document. 

We should model these as Report objects as follows

```json
{
    "type": "report",
    "spec_version": "2.1",
    "id": "report--<UUIDV5 GENERATION LOGIC>",
    "created_by_ref": "identity--9779a2db-f98c-5f4b-8d08-8ee04e02dbb5",
    "created": "<date_added>",
    "modified": "<_timestamp>",
    "published": "<SAME AS CREATED>",
    "name": "Vulncheck KEV: <vulnerabilityName>",
    "description": "<shortDescription>",
    "object_refs": [
        "vulnerability--<CVE STIX ID>",
        "weakness--<CWE STIX ID for all cwes listed>",
        "exploit--<ALL LINKED EXPLOITS>"
    ],
    "labels": [
        "kev"
    ],
    "report_types": [
    	"vulnerability"
    ],
    "external_references": [
        {
            "source_name": "cve",
            "external_id": "<vulnerabilities.cve.id>",
            "url": "https://nvd.nist.gov/vuln/detail/<vulnerabilities.cve.id>"
        },
        {
            "source_name": "<domain part of vulncheck_reported_exploitation.url>",
            "url": "<vulncheck_reported_exploitation.url>"
        },
        {
            "source_name": "<domain part of vulncheck_reported_exploitation.url>",
            "url": "<vulncheck_reported_exploitation.url>"
        },
        {
            "source_name": "known_ransomware",
            "description": "<knownRansomwareCampaignUse>"
        },
        {
            "source_name": "action_required",
            "description": "<required action>"
        },
        {
            "source_name": "action_due",
            "description": "<due date>"
        },
        {
            "source_name": "arango_cve_processor",
            "external_id": "cve-vulncheck-kev"
        }
    ],
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--152ecfe1-5015-522b-97e4-86b60c57036d"
    ]
}
```

To generate the id a UUIDv5 is generated using the namespace `152ecfe1-5015-522b-97e4-86b60c57036d` and the `name` values.

For each `vulncheck_xdb` entry, an exploit object is created.

You must also include the extension-definition for the exploit as this is a new custom stix object (we own): https://raw.githubusercontent.com/muchdogesec/stix2extensions/refs/heads/main/extension-definitions/sdos/exploit.json

```json
{
    "type": "exploit",
    "spec_version": "2.1",
    "id": "exploit--<UUIDV5>",
    "created_by_ref": "identity--9779a2db-f98c-5f4b-8d08-8ee04e02dbb5",
    "created": "<date_added>",
    "modified": "<date_added>",
    "name": "<CVEID>",
    "vulnerability_ref": "vulnerability--<CVE STIX ID>",
    "exploit_type": "<exploit_type>",
    "proof_of_concept": "<clone_ssh_url>",
    "external_references": [
        {
            "source_name": "cve",
            "url": "https://nvd.nist.gov/vuln/detail/<CVE STIX ID>",
            "external_id": "<CVE STIX ID>"
        }
    ],
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--60c0f466-511a-5419-9f7e-4814e696da40"
    ],
    "extensions": {
        "extension-definition--5a047f57-0149-59b6-a079-e2d7c7ac799a": {
            "extension_type": "new-sdo"
        }
    }
}
```

To generate the id a UUIDv5 is generated using the namespace `152ecfe1-5015-522b-97e4-86b60c57036d` and the `xdb_id` values.

## Updating records

The records can be updated over time. The only way to easily know if update has occured is if `<vulncheck_reported_exploitation.LATEST date_added>` OR `<vulncheck_xdb.date_added>` has increased compared to last `modified` time.

If HIGHEST `<vulncheck_reported_exploitation.date_added>` OR `<vulncheck_xdb>` whichever is greater is greater than `modified` time, record (inc. `modified` time) should be updated.

## OpenCTI Compliance

Note, this command will also update each vulnerability object with an KEV property so that is can be read by OpenCTI properly.

The following property will be added to the vulnerability object at the top level

```json
 "x_opencti_cisa_kev": true,
```

**Important considerations**

* This update DOES NOT change the `vulnerability` object `modified` time (because this would cause time issues on NVD updates)
* If running `cve-vulncheck-kev`, this command will also update the `vulnerability` object in the same way