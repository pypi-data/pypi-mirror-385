apiVersion: v1
kind: Service
metadata:
  finalizers:
    - service.kubernetes.io/load-balancer-cleanup
  labels:
    app: mqtt-server-external
  name: mqtt-server-external
  namespace: <feature_stack_namespace>
spec:
  allocateLoadBalancerNodePorts: true
  externalTrafficPolicy: Cluster
  internalTrafficPolicy: Cluster
  ipFamilies:
    - IPv4
  ipFamilyPolicy: SingleStack
  ports:
    - name: mqtts
      port: 8883
      protocol: TCP
      targetPort: 8883
    - name: wss
      port: 443
      protocol: TCP
      targetPort: 9002
  selector:
    app: mqtt-server
  sessionAffinity: None
  type: LoadBalancer