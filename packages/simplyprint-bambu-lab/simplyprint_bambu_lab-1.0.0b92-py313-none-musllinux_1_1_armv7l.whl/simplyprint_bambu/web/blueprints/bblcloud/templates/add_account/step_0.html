{% import 'macros.jinja' as macros %}

{# Ask user if they login with a password, if not client sided ensure
that they read a guide on how to add a password to their account
in retrospect. Either way then redirect to step 1. #}

<style>
    .selectable-card {
        cursor: pointer;
        transition: box-shadow 0.125s;
        transition: transform 0.125s;
        background: #2b3035;
    }

    .selectable-card:hover {
        box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.2);
        background: #1c1f22;
        transform: scale(1.0069);
    }
</style>

<script>
    function toggleCards() {
        document.getElementById('initialContainer').classList.toggle('d-none');
        document.getElementById('extraInfoForm').classList.toggle('d-none');
    }
</script>


<form id="bblcloud-step-0" hx-post="{{ url_for('bblcloud.add_account_step0') }}" hx-target="#bblcloud_account_form"
      hx-swap="innerHTML" class="pt-3">
    <div id="initialContainer">
        <div class="text-center">
            <h4>How do you sign in with Bambu Lab?</h4>
            <p class="text-muted small">
                We need to know how you sign in to your Bambu Lab account for BambuStudio, MakerWorld or Bambu Handy.
            </p>
        </div>

        <div class="pt-4 container h-100 d-flex">
            <div class="row w-100 justify-content-center gap-sm-4">

                <div class="col-md-4" role="button" onclick="htmx.trigger('#bblcloud-step-0', 'submit')">
                    <div class="card selectable-card h-100">

                        <div class="card-body text-center p-4 d-flex flex-column">
                            <h2>ðŸ”’</h2>
                            <h5 class="card-title">
                                Username + Password
                            </h5>
                            <p class="card-text">You already log in using a password</p>
                        </div>
                    </div>
                </div>

                <div class="col-md-4" role="button" onclick="toggleCards()">
                    <div class="card selectable-card h-100">

                        <div class="card-body text-center p-4 d-flex flex-column">
                            <h2>ðŸ”—</h2>
                            <h5 class="card-title">Linked Account</h5>
                            <p class="card-text">You created your account using <b>Google</b>, <b>Facebook</b> or <b>Apple</b>,
                                and don't
                                have a password yet</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <div id="extraInfoForm" class="d-none col-md-16">
        <div class="text-center">
            <h4>Adding a password to your Bambu Lab account</h4>
        </div>

        <div class="row justify-content-center align-items-center">
            <div class="container pt-5 col-md-8">
                <p>
                    To log in into the Bambu Lab integration with your Bambu Lab account you need to have added a
                    password. Most of these steps will take you
                    to {{ macros.externalLink('https://bambulab.com/en-eu/account/forgot-password', 'https://bambulab.com/en-eu/account/forgot-password') }}
                    in the end.
                </p>

                <ul class="nav nav-tabs" id="guides" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="guides-bambulab-tab" data-bs-toggle="tab"
                                data-bs-target="#guide-bambulab-content" type="button" role="tab"
                                aria-controls="guide-bambulab-content" aria-selected="true">
                            BambuLab.com
                        </button>
                    </li>

                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="guides-makerworld-tab" data-bs-toggle="tab"
                                data-bs-target="#guide-makerworld-content" type="button" role="tab"
                                aria-controls="guide-makerworld-content" aria-selected="false">
                            MakerWorld.com
                        </button>
                    </li>

                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="guides-handy-tab" data-bs-toggle="tab"
                                data-bs-target="#guide-handy-content" type="button" role="tab"
                                aria-controls="guide-handy-content" aria-selected="false">
                            Bambu Handy
                        </button>
                    </li>

                </ul>

                {# TODO: Add screenshots. #}

                <div class="tab-content" id="guides-content">
                    <div class="tab-pane fade show active" id="guide-bambulab-content" role="tabpanel"
                         aria-labelledby="guides-bambulab-tab">
                        {# Instructions for web browser BambuLab.com #}
                        {% call macros.accordian("guide-bambulab") %}
                            {% call macros.accordianItem("guide-bambulab", "login", "Step 1", "Login into BambuLab.com") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-bambulab", "settings", "Step 2", "Go to Profile Settings") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-bambulab", "resetpassword", "Step 3", "Reset password") %}
                            {% endcall %}
                        {% endcall %}
                    </div>

                    <div class="tab-pane fade" id="guide-makerworld-content" role="tabpanel"
                         aria-labelledby="guides-makerworld-tab">
                        {# Instructions for web browser MakerWorld.com #}
                        {% call macros.accordian("guide-makerworld") %}
                            {% call macros.accordianItem("guide-makerworld", "login", "Step 1", "Login into MakerWorld.com") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-makerworld", "settings", "Step 2", "Go to Account Settings") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-makerworld", "settings-2", "Step 3", "Security and privacy") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-makerworld", "resetpassword", "Step 4", "Reset password") %}
                            {% endcall %}
                        {% endcall %}
                    </div>

                    <div class="tab-pane fade" id="guide-handy-content" role="tabpanel"
                         aria-labelledby="guides-handy-tab">
                        {# Instructions for handy / mobile. #}
                        {% call macros.accordian("guide-handy") %}
                            {% call macros.accordianItem("guide-handy", "login", "Step 1", "Login into Bambu Handy") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-handy", "settings", "Step 2", "Go to Settings") %}
                            {% endcall %}


                            {% call macros.accordianItem("guide-handy", "settings-2", "Step 3", "Go to Account Security") %}
                            {% endcall %}

                            {% call macros.accordianItem("guide-handy", "resetpassword", "Step 4", "Reset password") %}
                            {% endcall %}
                        {% endcall %}
                    </div>
                </div>
            </div>


            <div class="form-group d-flex justify-content-between">
                <div class="btn btn-secondary" onclick="toggleCards()">Previous</div>
                <button type="submit" class="btn btn-info btn-block">I have a password now!</button>
            </div>

        </div>
    </div>
    </div>
</form>
