{# Email Code / 2FA step, hidden state fields #}


<form id="bblcloud-step-2" hx-post="{{ url_for('bblcloud.add_account_step2') }}" hx-target="#bblcloud_account_form"
      hx-swap="innerHTML" class="col-md-8 col-sm-12">

    <div class="mb-3 form-group">
        <label for="verification_code" class="form-label">
            {% if verification_type == 'tfa' %}
                2FA Code
            {% elif verification_type == 'verifyCode' %}
                Email Code
            {% endif %}

        </label>

        <input type="text" class="form-control" id="verification_code" name="verification_code" required
               minlength="6" maxlength="6"
               title="Please enter a valid verification code"
               placeholder="000000" autocomplete="off">
    </div>

    <input type="hidden" id="verification_type" name="verification_type" value="{{ verification_type }}">
    <input type="hidden" id="verification_state" name="verification_state" value="{{ verification_state }}">
    <input type="hidden" id="region" name="region" value="{{ region }}">

    {# Add "Resend code" button that submits inner form to resend_email_verification_code with same hidden fields  #}
    {% if verification_type == 'verifyCode' %}
        <div class="form-group">
            <button type="button"
                    class="btn btn-link"
                    hx-boost="false"
                    hx-post="{{ url_for('bblcloud.resend_email_verification_code') }}"
                    hx-target="#bblcloud-step-2"
                    hx-swap="innerHTML" class="btn btn-link">
                Resend Code (Only once every 60 seconds)
            </button>
        </div>
    {% endif %}

    {% if error %}
        <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    {% if success %}
        <div class="alert alert-success">{{ success }}</div>
    {% endif %}

    <div class="form-group d-flex justify-content-between">
        <button type="button"
                hx-boost="false"
                hx-get="{{ url_for('bblcloud.add_account_get_step1') }}"
                hx-target="#bblcloud_account_form"
                hx-swap="innerHTML" class="btn btn-secondary">
            Previous
        </button>


        <button type="submit" class="btn btn-primary">Next</button>
    </div>
</form>
