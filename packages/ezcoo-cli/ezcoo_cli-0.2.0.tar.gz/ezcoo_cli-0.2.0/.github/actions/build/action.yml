name: Build distribution
description: Builds the distribution

runs:
  using: composite
  steps:
    - name: Disable initramfs update
      shell: bash
      run: sudo sed -i 's/yes/no/g' /etc/initramfs-tools/update-initramfs.conf

    - name: Disable man-db update
      shell: bash
      run: sudo rm -f /var/lib/man-db/auto-update

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.x"

    - name: Install uv
      shell: bash
      run: python3 -m pip install uv

    - name: Build distribution packages
      shell: bash
      run: uv build
      env:
        UV_PROJECT_ENVIRONMENT: .venv

    - name: Store distribution packages
      uses: actions/upload-artifact@v4
      with:
        name: python-package-distributions
        path: dist/