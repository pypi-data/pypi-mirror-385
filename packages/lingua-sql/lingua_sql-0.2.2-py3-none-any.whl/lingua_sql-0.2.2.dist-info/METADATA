Metadata-Version: 2.4
Name: lingua-sql
Version: 0.2.2
Summary: é¢å‘ä¸­æ–‡ä¼˜åŒ–çš„ Text-to-SQL ç³»ç»Ÿï¼Œæ”¯æŒ FastAPI Web ç•Œé¢ã€å¤šç§å¤§è¯­è¨€æ¨¡å‹å’Œå‘é‡æ•°æ®åº“ï¼ˆéœ€è¦ Python 3.12ï¼‰
Project-URL: Homepage, https://github.com/yin xu/lingua-sql
Project-URL: Documentation, https://lingua-sql.readthedocs.io/
Project-URL: Repository, https://github.com/yinxu-4869/lingua-sql
Project-URL: Bug Tracker, https://github.com/4869-yinxu/lingua-sql/issues
Project-URL: Changelog, https://github.com/4869-yinxu/lingua-sql/blob/main/CHANGELOG.md
Author-email: æ®·æ—­ <2337302325@qq.com>
License: MIT
License-File: LICENSE
Keywords: ai,chinese,chromadb,database,deepseek,fastapi,llm,nlp,text-to-sql,vector-database
Classifier: Development Status :: 4 - Beta
Classifier: Framework :: FastAPI
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Database
Classifier: Topic :: Internet :: WWW/HTTP :: HTTP Servers
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Text Processing :: Linguistic
Requires-Python: ~=3.12.0
Requires-Dist: chromadb>=0.4.22
Requires-Dist: fastapi>=0.109.0
Requires-Dist: httpx>=0.27.0
Requires-Dist: jinja2>=3.1.0
Requires-Dist: mysql-connector-python>=8.0.0
Requires-Dist: openai>=1.12.0
Requires-Dist: pandas>=2.0.0
Requires-Dist: plotly>=5.18.0
Requires-Dist: pydantic>=2.6.0
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: python-multipart>=0.0.6
Requires-Dist: requests>=2.31.0
Requires-Dist: sqlparse>=0.4.4
Requires-Dist: streamlit>=1.32.0
Requires-Dist: uvicorn>=0.27.0
Provides-Extra: dev
Requires-Dist: black>=23.0.0; extra == 'dev'
Requires-Dist: flake8>=6.0.0; extra == 'dev'
Requires-Dist: isort>=5.12.0; extra == 'dev'
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pytest-cov>=4.0.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Provides-Extra: docs
Requires-Dist: myst-parser>=2.0.0; extra == 'docs'
Requires-Dist: sphinx-rtd-theme>=1.3.0; extra == 'docs'
Requires-Dist: sphinx>=7.0.0; extra == 'docs'
Description-Content-Type: text/markdown

# LinguaSQL

[![PyPI version](https://badge.fury.io/py/lingua-sql.svg)](https://badge.fury.io/py/lingua-sql)
[![Python Versions](https://img.shields.io/pypi/pyversions/lingua-sql.svg)](https://pypi.org/project/lingua-sql/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Downloads](https://static.pepy.tech/badge/lingua-sql)](https://pepy.tech/project/lingua-sql)
[![GitHub Release](https://img.shields.io/github/v/release/4869-yinxu/lingua_sql)](https://github.com/4869-yinxu/lingua_sql/releases)
[![GitHub Actions](https://github.com/4869-yinxu/lingua_sql/workflows/æµ‹è¯•/badge.svg)](https://github.com/4869-yinxu/lingua_sql/actions)
[![GitHub stars](https://img.shields.io/github/stars/4869-yinxu/lingua_sql.svg?style=social&label=Star)](https://github.com/4869-yinxu/lingua_sql)

ä¸€ä¸ªé¢å‘ä¸­æ–‡ä¼˜åŒ–çš„æ™ºèƒ½æ–‡æœ¬è½¬ SQLï¼ˆText-to-SQLï¼‰ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹å’Œå‘é‡æ•°æ®åº“ï¼Œæä¾›å®Œæ•´çš„ Web ç•Œé¢å’Œ API æœåŠ¡ã€‚

## é¡¹ç›®ç®€ä»‹
LinguaSQL æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ Text-to-SQL è§£å†³æ–¹æ¡ˆï¼Œä¸“ä¸ºä¸­æ–‡ç”¨æˆ·ä¼˜åŒ–ã€‚é€šè¿‡è‡ªç„¶è¯­è¨€é—®é¢˜è‡ªåŠ¨ç”Ÿæˆ SQL æŸ¥è¯¢ï¼Œæ”¯æŒæ™ºèƒ½è®­ç»ƒã€æ•°æ®åº“ç»“æ„è‡ªåŠ¨å¯¼å…¥ã€å¯è§†åŒ–ç•Œé¢ç­‰ï¼Œé€‚ç”¨äºæ•°æ®åˆ†æã€æ™ºèƒ½é—®ç­”ã€BI å·¥å…·ç­‰åœºæ™¯ã€‚

## æ ¸å¿ƒç‰¹æ€§
### ğŸ¤– å¤šæ¨¡å‹æ”¯æŒ
- **å¤§è¯­è¨€æ¨¡å‹**: DeepSeekã€OpenAIã€é€šä¹‰åƒé—®ã€æ™ºè°±AIã€ç™¾åº¦åƒå¸†ç­‰
- **å‘é‡æ•°æ®åº“**: ChromaDBã€Qdrantã€Milvusã€Weaviateã€Pinecone ç­‰
- **æ•°æ®åº“**: MySQLã€PostgreSQLã€SQLite ç­‰

### ğŸš€ æ™ºèƒ½åŠŸèƒ½
- **è‡ªåŠ¨è®­ç»ƒ**: æ™ºèƒ½ç”Ÿæˆé—®ç­”å¯¹ï¼Œæ”¯æŒå¤šç§è®­ç»ƒç­–ç•¥
- **ç»“æ„å¯¼å…¥**: è‡ªåŠ¨åˆ†ææ•°æ®åº“ç»“æ„ï¼Œç”Ÿæˆ DDL å’Œæ–‡æ¡£
- **ä¸­æ–‡ä¼˜åŒ–**: ä¸“ä¸ºä¸­æ–‡é—®ç­”åœºæ™¯ä¼˜åŒ–ï¼Œæ”¯æŒä¸­æ–‡æç¤ºè¯
- **æŒä¹…åŒ–å­˜å‚¨**: æ”¯æŒæœ¬åœ°å’Œäº‘ç«¯å‘é‡æ•°æ®åº“å­˜å‚¨

### ğŸŒ Web ç•Œé¢
- **FastAPI åç«¯**: é«˜æ€§èƒ½å¼‚æ­¥ API æœåŠ¡
- **ç°ä»£å‰ç«¯**: å“åº”å¼ Web ç•Œé¢ï¼Œæ”¯æŒå›¾è¡¨å¯è§†åŒ–
- **å®æ—¶äº¤äº’**: æ”¯æŒå®æ—¶ SQL ç”Ÿæˆã€æ‰§è¡Œå’Œç»“æœå±•ç¤º
- **æ•°æ®å¯¼å‡º**: æ”¯æŒ CSV ä¸‹è½½å’Œå›¾è¡¨ç”Ÿæˆ

## å®‰è£…æ–¹æ³•

### ä» PyPI å®‰è£…ï¼ˆæ¨èï¼‰
```bash
pip install lingua-sql
```

### ä»æºç å®‰è£…
```bash
git clone https://github.com/4869-yinxu/lingua_sql.git
cd lingua_sql
pip install -e .
```

### ç¯å¢ƒè¦æ±‚
- Python 3.12ï¼ˆä»…æ”¯æŒ 3.12.xï¼‰
- æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ

### ä¾èµ–å®‰è£…
```bash
pip install -r requirements.txt
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®
```bash
# åˆ›å»º .env æ–‡ä»¶
cat > .env << EOF
DEEPSEEK_API_KEY=your_deepseek_api_key
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_DATABASE=your_database
EOF
```

### 2. åŸºæœ¬ç”¨æ³•
```python
import os
from dotenv import load_dotenv
from lingua_sql import LinguaSQL
from lingua_sql.config import LinguaSQLConfig, APIConfig, DatabaseConfig

# åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv()

# ä½¿ç”¨æ–°é…ç½®ç³»ç»Ÿ
config = LinguaSQLConfig(
    api=APIConfig(
        api_key=os.getenv("DEEPSEEK_API_KEY"),
        model="deepseek-chat",
        client="persistent",
        path="./chroma_db"  # å‘é‡æ•°æ®åº“å­˜å‚¨è·¯å¾„
    ),
    database=DatabaseConfig(
        type="mysql",
        host=os.getenv("DB_HOST", "localhost"),
        port=3306,
        user=os.getenv("DB_USER", "root"),
        password=os.getenv("DB_PASSWORD", ""),
        database=os.getenv("DB_DATABASE", ""),
        auto_import_ddl=True
    )
)

# åˆå§‹åŒ– LinguaSQL
nl = LinguaSQL(config=config)

# æ·»åŠ  DDL
nl.train(ddl="""
CREATE TABLE customers (
    id INT PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(100),
    created_at TIMESTAMP
);
""")

# æ·»åŠ ç¤ºä¾‹é—®ç­”
nl.train(
    question="æŸ¥è¯¢æœ€è¿‘æ³¨å†Œçš„5ä¸ªå®¢æˆ·",
    sql="SELECT name, email, created_at FROM customers ORDER BY created_at DESC LIMIT 5;"
)

# ç”Ÿæˆ SQL
question = "æŸ¥è¯¢è®¢å•é‡‘é¢æœ€é«˜çš„å‰3ä¸ªå®¢æˆ·"
result = nl.ask(question)
print(f"é—®é¢˜: {question}")
print(f"ç”Ÿæˆçš„ SQL: {result}")
```

### 3. å¯åŠ¨ Web ç•Œé¢
```bash
# æ–¹å¼1ï¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
lingua-sql-server --port 8085

# æ–¹å¼2ï¼šä½¿ç”¨ Python ä»£ç 
from lingua_sql.fastapi import LinguaSQLFastAPIApp
app = LinguaSQLFastAPIApp()
app.run(port=8085)

# æ–¹å¼3ï¼šä½¿ç”¨ uvicorn
uvicorn lingua_sql.fastapi:create_app --factory --host 0.0.0.0 --port 8085
```

è®¿é—® http://localhost:8085 å³å¯ä½¿ç”¨ Web ç•Œé¢ã€‚

### 4. æ™ºèƒ½è®­ç»ƒ
```python
from lingua_sql.config import IntelligentTrainingConfig

# å¯ç”¨æ™ºèƒ½è®­ç»ƒ
config = LinguaSQLConfig(
    # ... å…¶ä»–é…ç½®
    intelligent_training=IntelligentTrainingConfig(
        enabled=True,
        max_questions_per_table=30,
        max_related_fields=3,
        auto_generate_sql=True,
        use_sample_data=True
    )
)

nl = LinguaSQL(config=config)

# è‡ªåŠ¨è®­ç»ƒæ‰€æœ‰è¡¨
nl.intelligent_auto_train()
```

### 5. æ•°æ®åº“ç»“æ„è‡ªåŠ¨å¯¼å…¥
```python
# è‡ªåŠ¨å¯¼å…¥æ•°æ®åº“ç»“æ„
nl.auto_import_schema()

# æˆ–æ‰‹åŠ¨å¯¼å…¥
from lingua_sql.database.mysql_connector import MySQLConnector

conn = MySQLConnector(
    host="localhost",
    user="root", 
    password="your_password",
    database="your_db"
)
conn.connect()

# è·å–æ‰€æœ‰è¡¨ç»“æ„å¹¶å¯¼å…¥
for table in conn.get_all_tables():
    ddl = conn.generate_ddl_from_schema(table)
    nl.train(ddl=ddl)
conn.disconnect()
```

## API æ–‡æ¡£

### REST API ç«¯ç‚¹
- `GET /api/v0/generate_sql?question=é—®é¢˜` - ç”Ÿæˆ SQL
- `GET /api/v0/run_sql?id=ä¼šè¯ID` - æ‰§è¡Œ SQL
- `POST /api/v0/train` - æ·»åŠ è®­ç»ƒæ•°æ®
- `GET /api/v0/get_training_data` - è·å–è®­ç»ƒæ•°æ®
- `GET /api/v0/download_csv?id=ä¼šè¯ID` - ä¸‹è½½ CSV
- `GET /api/v0/generate_plotly_figure?id=ä¼šè¯ID` - ç”Ÿæˆå›¾è¡¨

### å‘½ä»¤è¡Œå·¥å…·
```bash
# æŸ¥çœ‹å¸®åŠ©
lingua-sql --help

# å¯åŠ¨æœåŠ¡å™¨
lingua-sql-server --help
```

## é«˜çº§åŠŸèƒ½

### å¤šæ¨¡å‹æ”¯æŒ
```python
# ä½¿ç”¨ä¸åŒçš„å¤§è¯­è¨€æ¨¡å‹
config = LinguaSQLConfig(
    api=APIConfig(
        api_key="your_api_key",
        model="gpt-4",  # æˆ– "deepseek-chat", "qwen-plus" ç­‰
        client="persistent"
    )
)
```

### è‡ªå®šä¹‰å‘é‡æ•°æ®åº“
```python
# ä½¿ç”¨ä¸åŒçš„å‘é‡æ•°æ®åº“
from lingua_sql.chromadb import ChromaDBVectorStore
from lingua_sql.qdrant import QdrantVectorStore

# ChromaDBï¼ˆé»˜è®¤ï¼‰
vector_store = ChromaDBVectorStore(config)

# Qdrant
vector_store = QdrantVectorStore(config)
```

### æ™ºèƒ½è®­ç»ƒé…ç½®
```python
# è‡ªå®šä¹‰è®­ç»ƒç­–ç•¥
intelligent_training = IntelligentTrainingConfig(
    enabled=True,
    max_questions_per_table=50,  # æ¯ä¸ªè¡¨æœ€å¤šç”Ÿæˆ50ä¸ªé—®é¢˜
    max_related_fields=5,        # æœ€å¤šå…³è”5ä¸ªå­—æ®µ
    auto_generate_sql=True,      # è‡ªåŠ¨ç”ŸæˆSQL
    use_sample_data=True,        # ä½¿ç”¨æ ·æœ¬æ•°æ®
    interactive_confirmation=False  # éäº¤äº’æ¨¡å¼
)
```

## é¡¹ç›®ç»“æ„
```
lingua_sql/
â”œâ”€â”€ src/lingua_sql/
â”‚   â”œâ”€â”€ __init__.py              # ä¸»å…¥å£
â”‚   â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ fastapi/                 # FastAPI Web æœåŠ¡
â”‚   â”œâ”€â”€ chromadb/                # ChromaDB å‘é‡æ•°æ®åº“
â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“è¿æ¥å™¨
â”‚   â”œâ”€â”€ intelligent_training.py  # æ™ºèƒ½è®­ç»ƒ
â”‚   â””â”€â”€ prompts/                 # æç¤ºè¯æ¨¡æ¿
â”œâ”€â”€ examples/                    # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ tests/                       # æµ‹è¯•ç”¨ä¾‹
â””â”€â”€ docs/                        # æ–‡æ¡£
```

## è´¡çŒ®æŒ‡å—
æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æ–¹å¼
- ä½œè€…ï¼šæ®·æ—­
- é‚®ç®±ï¼š2337302325@qq.com
- GitHubï¼š[https://github.com/4869-yinxu/lingua_sql](https://github.com/4869-yinxu/lingua_sql)
- PyPIï¼š[https://pypi.org/project/lingua-sql/](https://pypi.org/project/lingua-sql/)

## æ›´æ–°æ—¥å¿—
- **v0.2.1** - æ·»åŠ  FastAPI Web ç•Œé¢ï¼Œæ”¯æŒæ™ºèƒ½è®­ç»ƒ
- **v0.2.0** - é‡æ„é…ç½®ç³»ç»Ÿï¼Œæ”¯æŒå¤šæ¨¡å‹
- **v0.1.0** - åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€ Text-to-SQL åŠŸèƒ½

