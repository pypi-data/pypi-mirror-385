import{S as ae}from"./BOdr3NOm.js";import{S as te}from"./CCJaWx_1.js";import{u as ne,V as ue,D as oe,b as ie,a as se,f as re}from"./vRc2BJuY.js";import{J as de,K as ce,av as fe,al as me,aP as O,aQ as ve,k as m,aR as U,r as v,a9 as pe,aK as ye,aS as Ve,aT as $,aU as Se,B as a,aG as F,aV as ge,aW as Ce,aX as be,V as P,aY as ke,aZ as Ie,_ as he,ag as we,a_ as xe,d as Fe,a as Pe,x as Ae,af as y,C as c,y as Be,D as C,aa as A,a5 as Re,a4 as M,Z as E}from"#entry";import"./EcQIca6j.js";import"./DIRTgmGz.js";import"./DPQgZEES.js";import"./DlAUqK2U.js";import"./CiZyL2M5.js";import"./D2lCyhx0.js";const ze=ce({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...be({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>O(e).every(p=>p!=null&&typeof p=="object")},...Ce({clearable:!0})},"VFileInput"),Ne=de()({name:"VFileInput",inheritAttrs:!1,props:ze(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,p){let{attrs:b,emit:k,slots:u}=p;const{t:s}=fe(),n=me(e,"modelValue",e.modelValue,l=>O(l),l=>e.multiple||Array.isArray(e.modelValue)?l:l[0]??null),{isFocused:o,focus:h,blur:w}=ve(e),I=m(()=>typeof e.showSize!="boolean"?e.showSize:void 0),V=m(()=>(n.value??[]).reduce((l,f)=>{let{size:S=0}=f;return l+S},0)),t=m(()=>U(V.value,I.value)),i=m(()=>(n.value??[]).map(l=>{const{name:f="",size:S=0}=l;return e.showSize?`${f} (${U(S,I.value)})`:f})),j=m(()=>{const l=n.value?.length??0;return e.showSize?s(e.counterSizeString,l,t.value):s(e.counterString,l)}),B=v(),R=v(),r=v(),_=m(()=>o.value||e.active),z=m(()=>["plain","underlined"].includes(e.variant));function x(){r.value!==document.activeElement&&r.value?.focus(),o.value||h()}function q(l){r.value?.click()}function J(l){k("mousedown:control",l)}function K(l){r.value?.click(),k("click:control",l)}function Z(l){l.stopPropagation(),x(),we(()=>{n.value=[],xe(e["onClick:clear"],l)})}return pe(n,l=>{(!Array.isArray(l)||!l.length)&&r.value&&(r.value.value="")}),ye(()=>{const l=!!(u.counter||e.counter),f=!!(l||u.details),[S,G]=Ve(b),{modelValue:De,...L}=$.filterProps(e),Q=Se(e);return a($,F({ref:B,modelValue:n.value,"onUpdate:modelValue":g=>n.value=g,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":z.value},e.class],style:e.style,"onClick:prepend":q},S,L,{centerAffix:!z.value,focused:o.value}),{...u,default:g=>{let{id:W,isDisabled:N,isDirty:D,isReadonly:T,isValid:X}=g;return a(Ie,F({ref:R,"prepend-icon":e.prependIcon,onMousedown:J,onClick:K,"onClick:clear":Z,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Q,{id:W.value,active:_.value||D.value,dirty:D.value||e.dirty,disabled:N.value,focused:o.value,error:X.value===!1}),{...u,default:Y=>{let{props:{class:H,...ee}}=Y;return a(P,null,[a("input",F({ref:r,type:"file",readonly:T.value,disabled:N.value,multiple:e.multiple,name:e.name,onClick:d=>{d.stopPropagation(),T.value&&d.preventDefault(),x()},onChange:d=>{if(!d.target)return;const le=d.target;n.value=[...le.files??[]]},onFocus:x,onBlur:w},ee,G),null),a("div",{class:H},[!!n.value?.length&&!e.hideInput&&(u.selection?u.selection({fileNames:i.value,totalBytes:V.value,totalBytesReadable:t.value}):e.chips?i.value.map(d=>a(he,{key:d,size:"small",text:d},null)):i.value.join(", "))])])}})},details:f?g=>a(P,null,[u.details?.(g),l&&a(P,null,[a("span",null,null),a(ke,{active:!!n.value?.length,value:j.value,disabled:e.disabled},u.counter)])]):void 0})}),ge({},B,R,r)}}),Ke=Fe({__name:"import",setup(e){const p=Pe(),b=ne(),k=new ae(p.$axios),u=v(null),s=v(null),n=v(null),o=v(!1),h=[{text:"Scan",disabled:!0,exact:!0},{text:"Import",disabled:!0,to:"/scan/import",exact:!0}],w=()=>{u.value=null,s.value=null,n.value=null},I=async()=>{try{if(o.value=!0,u.value===void 0||u.value===null||n.value===void 0||n.value===null)return;await k.importScan(u.value,n.value,s.value),b.reportSuccess("Scan imported successfully.")}catch(V){b.reportError(V?.message||"An error was encountered while importing scan.")}finally{o.value=!1,w()}};return(V,t)=>(Be(),Ae("div",null,[a(y(oe),{breadcrumbs:h,class:"mb-5"}),a(ue,{variant:"outlined",class:"my-4",loading:y(o)},{default:c(()=>[a(ie,{class:"font-weight-light"},{default:c(()=>[...t[3]||(t[3]=[C(" Please fill in the required fields to import the scan: ",-1)])]),_:1}),a(se,null,{default:c(()=>[a(te,{"selected-scanner":y(u),"onUpdate:selectedScanner":t[0]||(t[0]=i=>A(u)?u.value=i:null),class:"mb-6"},null,8,["selected-scanner"]),a(Ne,{modelValue:y(n),"onUpdate:modelValue":t[1]||(t[1]=i=>A(n)?n.value=i:null),variant:"outlined","show-size":"",label:"File",placeholder:"Required JSON scan import file","prepend-icon":"mdi-file-upload-outline",density:"compact"},null,8,["modelValue"]),a(Re,{modelValue:y(s),"onUpdate:modelValue":t[2]||(t[2]=i=>A(s)?s.value=i:null),label:"Scan Id",placeholder:"Optional scan id to amend",clearable:"",variant:"outlined","prepend-icon":"mdi-format-text",density:"compact"},null,8,["modelValue"])]),_:1}),a(re,null,{default:c(()=>[a(M,{variant:"elevated",color:"success",loading:y(o),onClick:I},{default:c(()=>[a(E,{start:""},{default:c(()=>[...t[4]||(t[4]=[C(" mdi-check ",-1)])]),_:1}),t[5]||(t[5]=C("Import ",-1))]),_:1},8,["loading"]),a(M,{variant:"elevated"},{default:c(()=>[a(E,{start:""},{default:c(()=>[...t[6]||(t[6]=[C(" mdi-close ",-1)])]),_:1}),t[7]||(t[7]=C("Cancel ",-1))]),_:1})]),_:1})]),_:1},8,["loading"])]))}});export{Ke as default};
