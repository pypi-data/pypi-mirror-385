import{c as ne,Y as D,_ as ue}from"./BaCn2Olm.js";import{J as re,K as ie,al as de,aQ as ce,b2 as pe,k as M,aK as me,aS as ve,aT as K,b3 as R,B as l,aG as $,b4 as fe,aX as ge,b5 as Ve,d as be,r as m,a as ye,o as Ae,a9 as z,T as E,C as o,ai as B,y as A,z as v,x as W,D as c,A as p,a5 as Y,aN as H,Z as J,a2 as Q,af as T,aL as Ce,_ as Se,b6 as ke,a4 as X}from"#entry";import{u as xe,V as _e,b as Ge,a as he}from"./vRc2BJuY.js";import{V as Te,_ as we}from"./DPQgZEES.js";import{a as L,b as Fe,A as Ie}from"./BPg7fJxw.js";import{u as Ue}from"./DIRTgmGz.js";import{a as Z,V as Ne}from"./CiZyL2M5.js";import{_ as Pe}from"./DlAUqK2U.js";const De=ie({...ge(),...fe(Ve(),["inline"])},"VCheckbox"),q=re()({name:"VCheckbox",inheritAttrs:!1,props:De(),emits:{"update:modelValue":n=>!0,"update:focused":n=>!0},setup(n,w){let{attrs:C,slots:s}=w;const f=de(n,"modelValue"),{isFocused:S,focus:k,blur:u}=ce(n),r=pe(),g=M(()=>n.id||`checkbox-${r}`);return me(()=>{const[F,x]=ve(C),i=K.filterProps(n),I=R.filterProps(n);return l(K,$({class:["v-checkbox",n.class]},F,i,{modelValue:f.value,"onUpdate:modelValue":V=>f.value=V,id:g.value,focused:S.value,style:n.style}),{...s,default:V=>{let{id:b,messagesId:y,isDisabled:U,isReadonly:N,isValid:_}=V;return l(R,$(I,{id:b.value,"aria-describedby":y.value,disabled:U.value,readonly:N.value},x,{error:_.value===!1,modelValue:f.value,"onUpdate:modelValue":d=>f.value=d,onFocus:k,onBlur:u}),s)}})}),{}}}),Ee=ne(ue),Be={class:"pb-5"},Le={key:0,class:"mb-0"},Me={key:1,class:"mb-0"},$e={class:"d-flex align-center custom-option"},Oe={class:"d-flex align-center custom-option"},je={class:"mb-4"},Ke="yaml",Re=be({__name:"AgentGroupForm",props:{agentGroup:{type:Object,default:()=>({id:"",key:"",name:"",description:"",agents:{agents:[]}})},isEditMode:{type:Boolean,default:!1},scanner:{type:Object,default:()=>({endpoint:"",name:"",apiKey:""})}},emits:["close-form"],setup(n,{emit:w}){const C={id:"",key:"",name:"",description:"",agents:{agents:[]}},s=n,f=m(),S=w,k=xe(),u=m(C),r=m(""),g=Object.keys(L).map(t=>({title:L[t],icon:Fe[t]})),F=t=>t.toLowerCase().split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),x=Object.values(L).reduce((t,e)=>(t[e]=F(e),t),{}),i=m([]),I=t=>i.value.includes(t.title),V=t=>{if(t.title==="Select All"){y();return}const e=i.value.findIndex(P=>P===t.title);e===-1?i.value.push(t.value):i.value.splice(e,1)},b=M(()=>i.value.length===g.length),y=()=>{b.value===!0?i.value=[]:i.value=g.map(t=>t.title)},U={theme:"vs",wordWrap:"on",wordWrapColumn:"on",fontFamily:"Fira Code",automaticLayout:!0,minimap:{enabled:!1},Placeholder:!0,PlaceholderText:"Start typing here"},{$axios:N}=ye(),_=new Ie(N),d=m(null),O=m([]),G=m(!1);Ae(()=>{r.value="",s.agentGroup!==null&&s.agentGroup!==void 0&&s.agentGroup.yamlSource!==null&&s.agentGroup.yamlSource!==void 0&&(r.value=s.agentGroup.yamlSource),s.scanner!==null&&s.scanner!==void 0&&(d.value=s.scanner)});const h=M(()=>d.value!=null&&r.value.trim()!==""),ee=t=>{const e=D.stringify(D.parse(t));if(e!=null)return e},te=async()=>{if(h.value===!0&&u.value!==null)try{const t=ee(r.value);if(d.value!==null&&t!==null&&t!==void 0){const e=D.parse(t);s.isEditMode==!0&&await _.deleteAgentGroup(d.value,parseInt(u.value.id)),await _.createAgentGroup({scanner:d.value,agentGroup:{description:u.value.description||"",agents:e?.agents,name:u.value.name,assetTypes:i.value}})}j(),S("close-form"),k.reportSuccess("Agent group saved successfully.")}catch(t){k.reportError(t?.message||"Failed to save Agent group information. Please try again.")}},j=()=>{u.value=C,r.value="",d.value=null},ae=()=>{j(),S("close-form")},le=t=>{const e=(t.name||"").trim()!=="";return{title:e?t.name:t.endpoint,subtitle:e?t.endpoint:""}};z(()=>s.agentGroup,t=>{u.value={...t},r.value=s.agentGroup?.yamlSource||""},{immediate:!0,deep:!0}),z(()=>r,t=>{r.value=t.value},{immediate:!0,deep:!0});const oe=Ue();return O.value=oe.scanners||[],(t,e)=>{const P=Ee;return A(),E(Te,{ref_key:"form",ref:f,modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=a=>h.value=a),onSubmit:B(te,["prevent"])},{default:o(()=>[v("div",Be,[l(Z,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),items:O.value,"item-props":le,"hide-details":"",variant:"outlined","item-title":"endpoint",density:"compact",clearable:"","return-object":"",disabled:n.isEditMode,label:"Select a scanner",placeholder:"Select or create a scanner for the agent group"},{selection:o(({item:a})=>[(a.raw.name||"").trim()!==""?(A(),W("p",Le,[c(p(a.raw.name)+" (",1),v("code",null,p(a.raw.endpoint),1),e[9]||(e[9]=c(") ",-1))])):(A(),W("code",Me,p(a.raw.endpoint),1))]),"no-data":o(()=>[v("p",{class:"create-scanner mb-0 pl-4 py-0",onClick:e[0]||(e[0]=a=>G.value=!0)}," Create New Scanner ")]),_:1},8,["modelValue","items","disabled"]),l(Ne,{modelValue:G.value,"onUpdate:modelValue":e[3]||(e[3]=a=>G.value=a),persistent:"","max-width":"600px"},{default:o(()=>[l(_e,null,{default:o(()=>[l(Ge,null,{default:o(()=>[...e[10]||(e[10]=[v("span",{class:"headline"},"Create New Scanner",-1)])]),_:1}),l(he,null,{default:o(()=>[l(we,{onCloseForm:e[2]||(e[2]=a=>G.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l(Y,{modelValue:u.value.name,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value.name=a),variant:"outlined",density:"compact",label:"Agent Group Name",placeholder:"Agent Group Name"},null,8,["modelValue"]),l(Y,{modelValue:u.value.description,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value.description=a),variant:"outlined",density:"compact",label:"Agent Group Description",placeholder:"Agent Group Description"},null,8,["modelValue"]),l(Z,{modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value=a),class:"mb-4",items:T(g),"hide-details":"",variant:"outlined",density:"compact",clearable:"",multiple:"",label:"Choose Asset Types",placeholder:"Choose Asset Types"},{selection:o(({item:a})=>[(A(),E(Se,{key:a.value,variant:"outlined"},{default:o(()=>[l(J,{class:"ml-0",size:"18",start:""},{default:o(()=>[c(p(a.raw.icon),1)]),_:2},1024),c(" "+p(T(x)[a.title]),1)]),_:2},1024))]),"prepend-item":o(()=>[l(H,{disabled:T(g).length===0,onClick:y},{default:o(()=>[v("div",$e,[l(q,{"model-value":b.value,class:"mt-5",onClick:B(y,["stop"])},null,8,["model-value"]),l(Q,null,{default:o(()=>[c(p(b.value===!0?"Deselect All":"Select All"),1)]),_:1})])]),_:1},8,["disabled"]),l(Ce)]),item:o(({item:a})=>[(A(),E(H,$(a,{key:a.value,title:"",onClick:se=>V(a)}),{default:o(()=>[v("div",Oe,[l(q,{"model-value":I(a),class:"mt-5",onClick:B(se=>V(a),["stop"])},null,8,["model-value","onClick"]),l(J,null,{default:o(()=>[c(p(a.raw.icon),1)]),_:2},1024),l(Q,{class:"ml-3"},{default:o(()=>[c(p(T(x)[a.title]),1)]),_:2},1024)])]),_:2},1040,["onClick"]))]),_:1},8,["modelValue","items"]),v("div",je,[l(ke,null,{default:o(()=>[...e[11]||(e[11]=[c(" Agent Group Definition ",-1)])]),_:1}),l(P,{modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value=a),lang:Ke,options:U,style:{"min-height":"300px"}},null,8,["modelValue"])]),l(X,{class:"me-2",type:"submit",color:"success",text:"Save","prepend-icon":"mdi-check",disabled:!h.value},null,8,["disabled"]),l(X,{text:"Cancel","prepend-icon":"mdi-close",onClick:ae})]),_:1},8,["modelValue"])}}}),qe=Pe(Re,[["__scopeId","data-v-5fbf6fc2"]]);export{qe as A};
