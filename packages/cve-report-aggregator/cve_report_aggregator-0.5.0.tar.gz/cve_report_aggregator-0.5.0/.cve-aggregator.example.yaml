---
# CVE Report Aggregator Configuration
# =====================================
#
# This is an example configuration file for CVE Report Aggregator.
# This file can be placed at:
#   - ./.cve-aggregator.yaml (current directory - auto-discovered)
#   - ./.cve-aggregator.yml (current directory - auto-discovered)
# Or specify explicitly with --config flag
#
# Configuration priority (from highest to lowest):
#   1. CLI arguments
#   2. YAML configuration file (--config or auto-discovered)
#   3. Environment variables (CVE_AGGREGATOR_*)
#   4. Default values

# Input directory containing scan report files
# Default: ./reports
input_dir: ./reports

# Output file path for the unified report
# Default: ./unified-report.json
output_file: ./unified-report.json

# Scanner type: grype or trivy
# Default: grype
scanner: grype

# Aggregation mode:
#   - highest-score: Select highest CVSS 3.x score across all reports (default)
#   - first-occurrence: Use severity from first occurrence
#   - grype-only: Process only with Grype scanner
#   - trivy-only: Process only with Trivy scanner
# Default: highest-score
mode: highest-score

# Enable verbose output
# Default: false
verbose: false

# ================================================================================
# Remote Package Download Configuration
# ================================================================================
# Download SBOM reports from a remote registry using UDS Zarf CLI
# Requires: uds CLI (https://github.com/defenseunicorns/uds-cli)
# Default: false
downloadRemotePackages: true

# Container registry URL (required if downloadRemotePackages is true)
registry: registry.defenseunicorns.com

# Organization or namespace in the registry (required if downloadRemotePackages is true)
organization: sld-45

# List of packages to download and scan (required if downloadRemotePackages is true)
# Each package will be downloaded using:
#   uds zarf package inspect sbom <registry>/<organization>/<name>-<version> -a <architecture>
packages:
  - name: gitlab
    version: 18.4.2-uds.0-unicorn
    architecture: amd64
  - name: gitlab-runner
    version: 18.4.0-uds.0-unicorn
    architecture: amd64
  - name: headlamp
    version: 0.35.0-uds.0-registry1
    architecture: amd64

# Examples of different configurations:
# ======================================

# Example 1: Download and scan remote packages
# downloadRemotePackages: true
# registry: registry.example.com
# organization: my-org
# packages:
#   - name: my-app
#     version: 1.0.0-uds.0
#     architecture: amd64

# Example 2: Trivy scanner with highest CVSS scores
# scanner: trivy
# mode: highest-score
# verbose: true

# Example 3: Grype-only mode with custom paths
# input_dir: /path/to/scan/reports
# output_file: /path/to/output/report.json
# mode: grype-only

# Example 4: First-occurrence mode (fastest)
# mode: first-occurrence
# verbose: false

# Environment Variables:
# ======================
# You can also set these values via environment variables:
#
# export CVE_AGGREGATOR_INPUT_DIR=/path/to/reports
# export CVE_AGGREGATOR_OUTPUT_FILE=/path/to/output.json
# export CVE_AGGREGATOR_SCANNER=trivy
# export CVE_AGGREGATOR_MODE=highest-score
# export CVE_AGGREGATOR_VERBOSE=true
# export CVE_AGGREGATOR_DOWNLOADREMOTEPACKAGES=true
# export CVE_AGGREGATOR_REGISTRY=registry.example.com
# export CVE_AGGREGATOR_ORGANIZATION=my-org
