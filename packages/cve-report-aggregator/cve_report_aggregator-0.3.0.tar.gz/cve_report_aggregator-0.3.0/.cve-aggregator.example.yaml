---
# CVE Report Aggregator Configuration
# =====================================
#
# This is an example configuration file for CVE Report Aggregator.
# This file can be placed at:
#   - ./.cve-aggregator.yaml (current directory - auto-discovered)
#   - ./.cve-aggregator.yml (current directory - auto-discovered)
# Or specify explicitly with --config flag
#
# Configuration priority (from highest to lowest):
#   1. CLI arguments
#   2. YAML configuration file (--config or auto-discovered)
#   3. Environment variables (CVE_AGGREGATOR_*)
#   4. Default values

# Input directory containing scan report files
# Default: ./reports
input_dir: ./reports

# Output file path for the unified report
# Default: ./unified-report.json
output_file: ./unified-report.json

# Scanner type: grype or trivy
# Default: grype
scanner: grype

# Aggregation mode:
#   - highest-score: Select highest CVSS 3.x score across all reports (default)
#   - first-occurrence: Use severity from first occurrence
#   - grype-only: Process only with Grype scanner
#   - trivy-only: Process only with Trivy scanner
# Default: highest-score
mode: highest-score

# Enable verbose output
# Default: false
verbose: false

# Container registry configuration (optional)
# registry: registry.defenseunicorns.com
# organization: sld-45

# List of packages to scan (optional)
# packages:
#   - name: gitlab
#     version: 18.4.2-uds.0-unicorn
#     architecture: amd64
#   - name: gitlab-runner
#     version: 18.4.0-uds.0-unicorn
#     architecture: amd64
#   - name: headlamp
#     version: 0.35.0-uds.0-registry1
#     architecture: amd64

# Examples of different configurations:
# ======================================

# Example 1: Trivy scanner with highest CVSS scores
# scanner: trivy
# mode: highest-score
# verbose: true

# Example 2: Grype-only mode with custom paths
# input_dir: /path/to/scan/reports
# output_file: /path/to/output/report.json
# mode: grype-only

# Example 3: First-occurrence mode (fastest)
# mode: first-occurrence
# verbose: false

# Environment Variables:
# ======================
# You can also set these values via environment variables:
#
# export CVE_AGGREGATOR_INPUT_DIR=/path/to/reports
# export CVE_AGGREGATOR_OUTPUT_FILE=/path/to/output.json
# export CVE_AGGREGATOR_SCANNER=trivy
# export CVE_AGGREGATOR_MODE=highest-score
# export CVE_AGGREGATOR_VERBOSE=true
