---

scanner: grype

# Aggregation mode:
#   - highest-score: Select highest CVSS 3.x score across all reports (default)
#   - first-occurrence: Use severity from first occurrence
#   - grype-only: Process only with Grype scanner
#   - trivy-only: Process only with Trivy scanner
# Default: highest-score
mode: highest-score

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Default: INFO
logLevel: DEBUG

# Enable downloading SBOM reports from remote registry
downloadRemotePackages: true

# Registry configuration
registry: registry.defenseunicorns.com
organization: sld-45

# Maximum number of concurrent workers for parallel downloads
# Default: auto-detect (min(32, cpu_count + 4))
# Set to 1 to disable parallelization
# maxWorkers: 14

# List of packages to download and scan (required if downloadRemotePackages is true)
# Each package will be downloaded using:
#   uds zarf package inspect sbom <registry>/<organization>/<name>-<version> -a <architecture>
packages:
  - name: gitlab
    version: 18.4.2-uds.0-unicorn
    architecture: amd64
  - name: gitlab-runner
    version: 18.4.0-uds.0-unicorn
    architecture: amd64

# ============================================================================
# CVE Enrichment with OpenAI
# ============================================================================
#
# CVE enrichment provides:
#   1. Mitigation summary: How UDS Core security controls help mitigate each CVE
#   2. Impact analysis: Potential consequences if UDS Core controls were not in place
#
# Nested enrichment configuration
enrich:
  # Enable CVE enrichment
  enabled: false

  # Enrichment provider (only openai supported currently)
  provider: openai

  # OpenAI model to use
  # Options: gpt-5-nano (default), gpt-5-mini, gpt-4o, gpt-4-turbo, etc.
  model: gpt-5-nano

  # OpenAI API key (can also use OPENAI_API_KEY environment variable)
  # apiKey: YOUR_OPENAI_API_KEY_HERE

  # Reasoning effort level (minimal, low, medium, high)
  # - minimal: Fastest, most concise analysis
  # - low: Faster, more concise analysis with lower token usage
  # - medium: Balanced analysis with good quality and reasonable token usage (default)
  # - high: Most thorough analysis with highest quality but increased token usage
  # Default: medium
  # Note: GPT-5 models support all levels; gpt-5-pro defaults to (and only supports) high
  reasoningEffort: medium

  # Verbosity level for model responses (low, medium, high)
  # - low: Most concise responses
  # - medium: Balanced responses (default)
  # - high: Most verbose responses
  # Default: medium
  verbosity: medium

  # Optional: Upper bound for total tokens including reasoning tokens
  # Useful for controlling costs with reasoning models
  # Recommended: 650 for gpt-5 with high reasoning (500 reasoning + 150 output)
  #              350 for gpt-5 with medium reasoning (200 reasoning + 150 output)
  # maxCompletionTokens: 650

  # Optional: Seed for reproducible results
  # seed: 42

  # Optional: Metadata tags for OpenAI requests (key-value pairs)
  # Useful for tracking and categorization in OpenAI dashboard
  # Note: Automatically enables 'store: true' for distillation/evals products
  # metadata:
  #   project: cve-report-aggregator
  #   organization: defenseunicorns
  #   environment: production

  # Severity levels to enrich (list)
  # Only CVEs with these severity levels will be enriched
  # Default: ["Critical", "High"]
  severities:
    - Critical
    - High
    # - Medium
    # - Low
