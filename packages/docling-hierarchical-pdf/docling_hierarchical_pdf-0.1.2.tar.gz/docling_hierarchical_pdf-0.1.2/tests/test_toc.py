from pathlib import Path

import numpy as np
import pytest
from docling_core.types.doc.page import TextDirection

from hierarchical.hierarchy_builder import DocumentHierarchyBuilder, cleanup_non_headings, create_toc
from hierarchical.postprocessor import flatten_hierarchy_tree

results_path = Path(__file__).parent / "results"

sample_0 = [
    {
        "font": "/Arial",
        "font_size": np.float64(18.834999999999923),
        "is_bold": True,
        "is_italic": False,
        "text": "Richtlinie 10-00",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 196.0469829101562,
    },
    {
        "font": "/ArialMT",
        "font_size": np.float64(18.834999999999923),
        "is_bold": False,
        "is_italic": False,
        "text": "Einfuhrzollveranlagungsverfahren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 244.0469829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "Abkürzungsverzeichnis",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 68.94498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1  Veranlagungsschritte im Zollveranlagungsverfahren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "Ablaufschema Zollveranlagungsverfahren:",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 140.3649829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.1  Zuführen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.2  Zollüberwachung und Zollprüfung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 257.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.3  Gestellen und summarisches Anmelden",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.3.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.3.2  Form der summarischen Anmeldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 289.31498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.3.3  Manipulationen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.3.4  Präzisierungen zum Ende des Gewahrsams des BAZG",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 271.0749829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.3.5  Abstellen auf dem Amtsplatz",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4  Anmelden",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 192.20498291015622,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 211.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.2  Form der Einfuhrzollanmeldung (EZA)",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 308.27498291015627,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.3  Vereinfachte Zollanmeldung für abgabenfreie Sendungen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.4  Bedeutung der zolltarifarischen Einreihung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 253.64498291015627,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.5  Veranlagungstext",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.6  Antrag auf Zollermässigung oder Zollbefreiung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 148.04498291015625,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.7  Zollbemessung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 336.11498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.8  Kollektive Zollanmeldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 291.4749829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.4.9  Begleitdokumente",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 174.0849829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.5  Summarische Prüfung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 108.20498291015622,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.6  Annahme der EZA",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 121.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.6.1  Selektion e-dec Import",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 505.09498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.6.2  Selektion e-dec-web Import",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 160.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.7  Formelle Überprüfung der angenommenen EZA",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 244.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.7.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 263.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.7.2  Prüfung von Ursprungsnachweisen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.7.3  Unstimmigkeiten bei der formellen Überprüfung der EZA",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 453.85498291015625,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.7.4  Erneute Vorlage einer beanstandeten EZA",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8  Beschau",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.2  Zweck der Beschau",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 458.29498291015625,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.3  Vorgehen bei der Beschau",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 529.3349829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.4  Protokollierung von Schäden",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 134.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.5  Unstimmigkeiten bei der Beschau",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 309.2349829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.6  Beschau am Domizil",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 380.27498291015627,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.7  Kontrolle des Bruttogewichts",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.8  Kontrolle der Eigenmasse",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.9  Musterentnahme",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.8.10  Zollbefund",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9  Ausstellen und eröffnen der Veranlagungsverfügung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 270.2349829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 289.31498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.2  Zweck",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 412.31498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.3  Ausstellen der Veranlagungsverfügung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 509.29498291015625,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.3.1  Barzahlung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 528.2549829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.3.2  Zahlung im Rahmen des zentralisierten Abrechnungsverfahrens des BAZG  (ZAZ)",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 677.3249829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "Elektronische Veranlagungsverfügung (eVV):",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 709.3649829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.3.3  Hinweis auf Rechtsmittel in e-dec",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 160.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.4  Ausstellen von Duplikaten",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.4.1  Allgemein",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "Barzahlung:",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 107.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "Zahlung im Rahmen des zentralisierten Abrechnungsverfahrens des BAZG (ZAZ):",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 224.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.9.4.2  Ausfuhrerstattung in der EU; Duplikate VVZ und VVM",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 276.2349829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "Sonderfälle:",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 425.27498291015627,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.10  Freigabe und Abtransport von Waren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 212.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "1.10.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 231.20498291015622,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "1.10.2  Vorzeitiger Abtransport von Waren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 471.25498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "1.10.3  Unveranlagte Auslieferung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 555.2549829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "Verlagerungsverfahren MWST bei der Einfuhr",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 348.11498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "Kontingentswaren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 480.0149829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "Erläuterungen zu den Phasen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 147.32498291015622,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "2  Besonderheiten",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "2.1  Vernichtung von Waren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "2.2  Haftung des Bundes",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 498.49498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "3  Zeiten und Fristen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "3.1  Übersicht",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "3.2  Frist zur Zollanmeldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 356.6349829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "3.2.1  Zollanmeldung bei Gestellung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 375.59498291015626,
    },
    {
        "font": "/ArialMT",
        "font_size": np.float64(8.072000000000003),
        "is_bold": False,
        "is_italic": False,
        "text": "(Art. 4 ZV-BAZG)",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 394.68998291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "3.2.2  Voranmeldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "Beglaubigung von Ursprungsnachweisen bei Grenzübertritt",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 466.21498291015627,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "3.3  Frist zur Vorlage der Zollanmeldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "3.4  Frist zum Abtransport von Waren",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 284.03498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "4  Pflichten und Rechte der anmeldepflichtigen Person",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "4.1  Übersicht",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "4.2  Rechte vor Abgabe der Zollanmeldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 512.6549829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "4.3  Schriftliche Zolltarifauskunft",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "4.3.1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 88.28498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "4.3.2  Zuständigkeit",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 695.4449829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "4.3.3  Warensortimente",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 225.20498291015622,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "4.3.4  Tarifanfrage (Form 40.10)",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 400.31498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "4.3.5  E-Mail - Anfragen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 733.2449829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "4.4  Mündliche Zolltarifauskunft",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 147.20498291015622,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "4.5  Besichtigung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 322.31498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "4.6  Mitwirkung bei der Beschau",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 484.33498291015627,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "5  Archivierung von Daten und Dokumenten",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 148.04498291015625,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "5.1  Aufbewahrung durch die anmeldepflichtige Person",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 167.0049829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "5.2  Aufbewahrung durch das BAZG",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "6  Rechtsgrundlagen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 271.0749829101562,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "7  Begriffe",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 329.03498291015626,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "7.1  Anmeldepflichtige Personen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 348.11498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.90199999999993),
        "is_bold": True,
        "is_italic": False,
        "text": "7.2  Veranlagungsbehörde",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 69.18498291015624,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "7.3  Veranlagungsobjekt",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 284.8749829101563,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "7.4  Veranlagungspartei",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 368.87498291015623,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.901999999999987),
        "is_bold": True,
        "is_italic": False,
        "text": "7.5  Zollveranlagung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 439.91498291015625,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(9.902000000000044),
        "is_bold": True,
        "is_italic": False,
        "text": "7.6  Zuführungspflichtige Personen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 655.4849829101563,
    },
]

sample_1 = [
    {
        "font": "/Arial",
        "font_size": np.float64(18.728000000000065),
        "is_bold": True,
        "is_italic": False,
        "text": "Pflichtenheft  für  Lohnbrennerinnen  und  - brenner, die alco-dec verwenden",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 209.1869780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Abkürzungsverzeichnis",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 80.38497802734378,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Inhaltsverzeichnis",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 107.77497802734376,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "0  Anpassungen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 80.74497802734379,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "1  Allgemeines",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 263.0049780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Rechtliche Grundlagen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 347.2649780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Brennereieinrichtungen und Lokalitäten",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 535.9849780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Standort und Standortwechsel",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 80.74497802734379,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.0089999999999),
        "is_bold": True,
        "is_italic": False,
        "text": "Meldepflicht für das fahrbare Brennen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 151.7149780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Erwerb, Verkauf, Aufstellung, Änderungen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 222.66497802734375,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Anderweitige Verwendung der Brennapparate",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 281.0049780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Brennereipersonal",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 364.90497802734376,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Nutzung von alco-dec",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 552.9249780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "2  Rohstoffe",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 663.1349780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "3  Herstellung Spirituosen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 210.78497802734375,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Kontrolle der persönlichen Daten der Produzentinnen und Produzenten",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 229.8649780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Entgegennahme der Rohstoffe",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 430.83497802734377,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "3.2.1  Unverzügliche  Erstellung  eines  Brennbewilligungsgesuchs  in  alco-dec  (Variante 1):",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 567.6849780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "3.2.2  Entgegennahme via Rohstoff-Empfangsschein mit "
        "anschliessender Erfassung  in alco-dec (Variante 2)",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 106.69497802734372,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Angaben auf den Behältern mit den Rohstoffen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 359.86497802734374,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Brennbewilligung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 496.02497802734376,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Spezialfall fahrbare Brennapparate",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 555.0849780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "4  Besteuerung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 132.6149780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Bestimmung des Alkoholgehalts",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 190.9549780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Bestimmung der hergestellten Spirituosenmenge",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 313.78497802734375,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Meldung der hergestellten Spirituosen für Kleinproduzentinnen und "
        "Kleinprodu- zenten sowie Landwirtinnen und Landwirte",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 436.95497802734377,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Meldung der hergestellten Spirituosen für Gewerbeproduzentinnen und "
        "Gewer- beproduzenten, einschliesslich der Landwirtinnen und "
        "Landwirte, die der ge- werblichen Kontrolle unterstellt sind",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 624.9449780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "4.4.1  Meldung",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 669.9749780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "4.4.2  Sperrfrist",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 210.78497802734375,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Meldung der hergestellten Spirituosen bei Zusatz von Alkohol in den Rohstoffen  oder bei Umbrand",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 346.90497802734376,
    },
    {
        "font": "/ArialMT",
        "font_size": np.float64(10.009000000000015),
        "is_bold": False,
        "is_italic": False,
        "text": "Aufbewahrung der Belege",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 569.1249780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "5  Lagerung und Aushändigung der hergestellten Spirituosen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 672.8549780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Identifizierung der Behälter",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 691.9349780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Aushändigung der hergestellten Spirituosen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 80.74497802734379,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.0089999999999),
        "is_bold": True,
        "is_italic": False,
        "text": "6  Spirituosenhandel und Werbung für Spirituosen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 151.7149780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "7  Ausschank von Spirituosen",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 209.7049780273437,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "8  Aufhebung und Inkrafttreten",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 267.68497802734373,
    },
]


sample_2 = [
    {
        "font": "/Arial",
        "font_size": np.float64(18.728000000000065),
        "is_bold": True,
        "is_italic": False,
        "text": "Some text 1",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 209.1869780273438,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Abkürzungsverzeichnis",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 80.38497802734378,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.009000000000015),
        "is_bold": True,
        "is_italic": False,
        "text": "Inhaltsverzeichnis",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 107.77497802734376,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.0089999999999),
        "is_bold": True,
        "is_italic": False,
        "text": "Introduction",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 60.265000000000000,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(8.00100000),
        "is_bold": True,
        "is_italic": False,
        "text": "Context",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 80.265000000000000,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(8.00100000),
        "is_bold": True,
        "is_italic": True,
        "text": "Sub-Context",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 200.265000000000000,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(8.00100000),
        "is_bold": True,
        "is_italic": False,
        "text": "Where the field is moving",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 70.265000000000000,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(8.00100000),
        "is_bold": True,
        "is_italic": True,
        "text": "Exceptions",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 100.265000000000000,
    },
    {
        "font": "/Arial",
        "font_size": np.float64(10.0189999999999),
        "is_bold": True,
        "is_italic": False,
        "text": "Methods",
        "text_direction:": TextDirection.LEFT_TO_RIGHT,
        "top_left": 40.265000000000000,
    },
]

sample_3 = [
    {
        "font": "",
        "font_size": 30.888000000000005,
        "is_bold": False,
        "is_italic": False,
        "text": "LEVERAGING MONOLINGUAL DATA FOR CROSSLINGUAL COMPOSITIONAL WORD REPRESENTATIONS",
        "text_direction:": None,
        "top_left": 64.152,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "1 Introduction",
        "text_direction:": None,
        "top_left": 390.85200000000003,
    },
    {
        "font": "",
        "font_size": 11.879999999999999,
        "is_bold": False,
        "is_italic": False,
        "text": "Published as a conference paper at ICLR 2015",
        "text_direction:": None,
        "top_left": 15.443999999999999,
    },
    {
        "font": "",
        "font_size": 11.879999999999999,
        "is_bold": False,
        "is_italic": False,
        "text": "Published as a conference paper at ICLR 2015",
        "text_direction:": None,
        "top_left": 15.443999999999999,
    },
    {
        "font": "",
        "font_size": 8.316000000000003,
        "is_bold": False,
        "is_italic": False,
        "text": "2.2 CREATING REPRESENTATIONS FOR PHRUSESS AND DOCUMENTS",
        "text_direction:": None,
        "top_left": 92.664,
    },
    {
        "font": "",
        "font_size": 9.504000000000019,
        "is_bold": False,
        "is_italic": False,
        "text": "2.3 OBJECTIVE",
        "text_direction:": None,
        "top_left": 323.136,
    },
    {
        "font": "",
        "font_size": 9.504000000000019,
        "is_bold": False,
        "is_italic": False,
        "text": "3.1 CROSSINGUAL DOCUMENT CLASSIFICATION",
        "text_direction:": None,
        "top_left": 493.02,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "3.2 INDUCE CROSSLINGUAL WORD REPRESENTATIONS",
        "text_direction:": None,
        "top_left": 301.752,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "4 RESULTS",
        "text_direction:": None,
        "top_left": 302.94,
    },
    {
        "font": "",
        "font_size": 10.69199999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "4.1 CROSSINGUAL DOCUMENT CLASSIFICATION",
        "text_direction:": None,
        "top_left": 325.512,
    },
    {
        "font": "",
        "font_size": 9.50399999999999,
        "is_bold": False,
        "is_italic": False,
        "text": "4.2 INTERESTING PROPERTIES OF THE INDUCED CROSSLINGUAL WORLD REPRESENTATIONS",
        "text_direction:": None,
        "top_left": 245.916,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "5 CONCLUSION AND FUTURE WORK",
        "text_direction:": None,
        "top_left": 430.056,
    },
    {
        "font": "",
        "font_size": 11.879999999999999,
        "is_bold": False,
        "is_italic": False,
        "text": "Published as a conference paper at ICLR 2015",
        "text_direction:": None,
        "top_left": 15.443999999999999,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "ACKNOWLEDGEMENTS",
        "text_direction:": None,
        "top_left": 62.964,
    },
    {
        "font": "",
        "font_size": 10.691999999999993,
        "is_bold": False,
        "is_italic": False,
        "text": "REFERENCES",
        "text_direction:": None,
        "top_left": 114.048,
    },
]

sample_4 = [
    {
        "font": "",
        "font_size": 9.504000000000019,
        "is_bold": False,
        "is_italic": False,
        "text": "Abstract",
        "text_direction:": None,
        "top_left": 269.676,
    },
    {
        "font": "",
        "font_size": 13.06800000000004,
        "is_bold": False,
        "is_italic": False,
        "text": "1 Introduction",
        "text_direction:": None,
        "top_left": 430.056,
    },
    {
        "font": "",
        "font_size": 46.331999999999994,
        "is_bold": False,
        "is_italic": False,
        "text": "1.2 Approximation of the halfspace depth",
        "text_direction:": None,
        "top_left": 458.568,
    },
    {
        "font": "",
        "font_size": 19.008000000000038,
        "is_bold": False,
        "is_italic": False,
        "text": "1.3 Proposal",
        "text_direction:": None,
        "top_left": 287.496,
    },
    {
        "font": "",
        "font_size": 14.256,
        "is_bold": False,
        "is_italic": False,
        "text": "2 Theory",
        "text_direction:": None,
        "top_left": 133.056,
    },
    {
        "font": "",
        "font_size": 19.007999999999925,
        "is_bold": False,
        "is_italic": False,
        "text": "Algorithms",
        "text_direction:": None,
        "top_left": 317.196,
    },
    {
        "font": "",
        "font_size": 14.256000000000029,
        "is_bold": False,
        "is_italic": False,
        "text": "3.1 Combinatorial algorithm, k = d - 1",
        "text_direction:": None,
        "top_left": 428.868,
    },
    {
        "font": "",
        "font_size": 17.819999999999993,
        "is_bold": False,
        "is_italic": False,
        "text": "5 Conclusions",
        "text_direction:": None,
        "top_left": 92.664,
    },
    {
        "font": "",
        "font_size": 19.007999999999996,
        "is_bold": False,
        "is_italic": False,
        "text": "A Proof of Lemma 1",
        "text_direction:": None,
        "top_left": 92.664,
    },
]

sample_5 = [
    {
        "font": "",
        "font_size": 27.324000000000005,
        "is_bold": False,
        "is_italic": False,
        "text": "A Fast Randomized Method to Find Homotopy Classes for Socially-Aware Navigation",
        "text_direction:": None,
        "top_left": 51.083999999999996,
    },
    {
        "font": "",
        "font_size": 14.256,
        "is_bold": False,
        "is_italic": False,
        "text": "Luigi Palmieri",
        "text_direction:": None,
        "top_left": 91.476,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "II. Our APPROACH",
        "text_direction:": None,
        "top_left": 116.424,
    },
    {
        "font": "",
        "font_size": 9.504000000000019,
        "is_bold": False,
        "is_italic": False,
        "text": "IV. RESULTS AND DISCUSSION",
        "text_direction:": None,
        "top_left": 258.984,
    },
]


sample_6 = [
    {
        "font": "",
        "font_size": 11.880000000000024,
        "is_bold": False,
        "is_italic": False,
        "text": "1 Motivation",
        "text_direction:": None,
        "top_left": 254.232,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "2 Results",
        "text_direction:": None,
        "top_left": 386.1,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "3 Introduction",
        "text_direction:": None,
        "top_left": 465.696,
    },
    {
        "font": "",
        "font_size": 14.256,
        "is_bold": False,
        "is_italic": False,
        "text": "4 Methods",
        "text_direction:": None,
        "top_left": 91.476,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "4.1 Choosing a set of Databases",
        "text_direction:": None,
        "top_left": 106.92,
    },
    {
        "font": "",
        "font_size": 8.316000000000003,
        "is_bold": False,
        "is_italic": False,
        "text": "4.2 Data extraction and visualisation",
        "text_direction:": None,
        "top_left": 245.916,
    },
    {
        "font": "",
        "font_size": 13.067999999999984,
        "is_bold": False,
        "is_italic": False,
        "text": "5 Results",
        "text_direction:": None,
        "top_left": 155.62800000000001,
    },
    {
        "font": "",
        "font_size": 13.06800000000004,
        "is_bold": False,
        "is_italic": False,
        "text": "5.1 Reuse within Databases",
        "text_direction:": None,
        "top_left": 308.88,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "5.2 Patterns of Reuse within databases",
        "text_direction:": None,
        "top_left": 247.10399999999998,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "5.3 Reuse between Databases",
        "text_direction:": None,
        "top_left": 134.244,
    },
    {
        "font": "",
        "font_size": 9.503999999999962,
        "is_bold": False,
        "is_italic": False,
        "text": "5.4 Patterns between databases",
        "text_direction:": None,
        "top_left": 235.22400000000002,
    },
    {
        "font": "",
        "font_size": 13.067999999999984,
        "is_bold": False,
        "is_italic": False,
        "text": "6 Discussion",
        "text_direction:": None,
        "top_left": 297.0,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "References",
        "text_direction:": None,
        "top_left": 374.22,
    },
]

sample_7 = [
    {
        "font": "",
        "font_size": 21.453999999999994,
        "is_bold": False,
        "is_italic": False,
        "text": "MULTISCALE SURROGATE MODELING AND UNCERTAINTY QUANTIFICATION FOR PERIODIC COMPOSITE STRUCTURES",
        "text_direction:": None,
        "top_left": 127.462,
    },
    {
        "font": "",
        "font_size": 10.096000000000004,
        "is_bold": False,
        "is_italic": False,
        "text": "Charles Mylonas'l,Bemetz Valentin, Eleni Chatzi",
        "text_direction:": None,
        "top_left": 160.274,
    },
    {
        "font": "",
        "font_size": 11.357999999999997,
        "is_bold": False,
        "is_italic": False,
        "text": "1 Introduction",
        "text_direction:": None,
        "top_left": 56.79,
    },
    {
        "font": "",
        "font_size": 11.357999999999947,
        "is_bold": False,
        "is_italic": False,
        "text": "2 Computational Methodology",
        "text_direction:": None,
        "top_left": 424.03200000000004,
    },
    {
        "font": "",
        "font_size": 11.358000000000004,
        "is_bold": False,
        "is_italic": False,
        "text": "2.1 Asymptotic Expansion Homogenization",
        "text_direction:": None,
        "top_left": 483.346,
    },
    {
        "font": "",
        "font_size": 13.882000000000005,
        "is_bold": False,
        "is_italic": False,
        "text": "3.1 Dimensionality reduction with PCA for the homogenized stiffness tensor",
        "text_direction:": None,
        "top_left": 318.024,
    },
    {
        "font": "",
        "font_size": 11.358000000000004,
        "is_bold": False,
        "is_italic": False,
        "text": "3.3 Conclusion",
        "text_direction:": None,
        "top_left": 335.692,
    },
    {
        "font": "",
        "font_size": 11.357999999999997,
        "is_bold": False,
        "is_italic": False,
        "text": "REFERENCES",
        "text_direction:": None,
        "top_left": 55.528,
    },
]

sample_8 = [
    {
        "font": "",
        "font_size": 33.26399999999998,
        "is_bold": False,
        "is_italic": False,
        "text": "Spectral Calibration of the Fluorescence Telescopes of the Pierre Auger Observatory",
        "text_direction:": None,
        "top_left": 147.312,
    },
    {
        "font": "",
        "font_size": 9.504000000000019,
        "is_bold": False,
        "is_italic": False,
        "text": "Abstract",
        "text_direction:": None,
        "top_left": 362.34,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "1. Introduction",
        "text_direction:": None,
        "top_left": 187.704,
    },
    {
        "font": "",
        "font_size": 14.255999999999986,
        "is_bold": False,
        "is_italic": False,
        "text": "2. Optical Components of the Fluorescence Telescopes",
        "text_direction:": None,
        "top_left": 96.22800000000001,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "3. Monochromator Drum Setup",
        "text_direction:": None,
        "top_left": 427.68,
    },
    {
        "font": "",
        "font_size": 11.88000000000001,
        "is_bold": False,
        "is_italic": False,
        "text": "4. Lab Measurements and the Drum Spectrum",
        "text_direction:": None,
        "top_left": 124.74,
    },
    {
        "font": "",
        "font_size": 11.880000000000024,
        "is_bold": False,
        "is_italic": False,
        "text": "4.1. Drum Emission",
        "text_direction:": None,
        "top_left": 205.52399999999997,
    },
    {
        "font": "",
        "font_size": 14.256000000000029,
        "is_bold": False,
        "is_italic": False,
        "text": "4.3. Uncertainties in Lab Measurements",
        "text_direction:": None,
        "top_left": 152.064,
    },
    {
        "font": "",
        "font_size": 10.692000000000007,
        "is_bold": False,
        "is_italic": False,
        "text": "5.2. Photodiode Monitor Data",
        "text_direction:": None,
        "top_left": 447.876,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "6. Calculation of the FD Efficiency",
        "text_direction:": None,
        "top_left": 305.31600000000003,
    },
    {
        "font": "",
        "font_size": 10.691999999999979,
        "is_bold": False,
        "is_italic": False,
        "text": "7. Comparison of telescopes with differing optical components",
        "text_direction:": None,
        "top_left": 197.208,
    },
    {
        "font": "",
        "font_size": 11.879999999999995,
        "is_bold": False,
        "is_italic": False,
        "text": "8. Effect on Physics Measurabless",
        "text_direction:": None,
        "top_left": 428.868,
    },
    {
        "font": "",
        "font_size": 9.50399999999999,
        "is_bold": False,
        "is_italic": False,
        "text": "9. Conclusions",
        "text_direction:": None,
        "top_left": 100.98,
    },
    {
        "font": "",
        "font_size": 9.504000000000019,
        "is_bold": False,
        "is_italic": False,
        "text": "References",
        "text_direction:": None,
        "top_left": 345.70799999999997,
    },
]

sample_9 = [
    {
        "font": "",
        "font_size": 33.26399999999998,
        "is_bold": False,
        "is_italic": False,
        "text": "Spectral Calibration of the Fluorescence Telescopes of the Pierre Auger Observatory",
        "text_direction:": None,
        "top_left": 147.312,
    },
]


def compare(res_text, i):
    p = results_path / f"sample_{i}.txt"
    if p.exists():
        assert res_text == p.read_text()
    else:
        p.write_text(res_text)


def test_sample_0():
    headings = cleanup_non_headings(sample_0)

    builder = DocumentHierarchyBuilder(headings)

    root_node = builder._infer_from_numbering()
    compare(str(root_node), 0)


def test_sample_1():
    headings = cleanup_non_headings(sample_1)

    builder = DocumentHierarchyBuilder(headings)

    root_node = builder._infer_from_numbering()
    compare(str(root_node), 1)


def test_sample_2():
    root_node = create_toc(sample_2)
    compare(str(root_node), 2)


def test_sample_3():
    root_node = create_toc(sample_3)
    compare(str(root_node), 3)


def test_sample_4():
    root_node = create_toc(sample_4)
    compare(str(root_node), 4)


@pytest.mark.skip(reason="inferring of titles currently ignored. Super edge case.")
def test_sample_5():
    root_node = create_toc(sample_5)
    compare(str(root_node), 5)


def test_sample_6():
    root_node = create_toc(sample_6)
    compare(str(root_node), 6)


def test_sample_7():
    root_node = create_toc(sample_7)
    compare(str(root_node), 7)


def test_sample_8():
    root_node = create_toc(sample_8)
    compare(str(root_node), 8)


def test_sample_9():
    root_node = create_toc(sample_9)
    compare(str(root_node), 9)


def test_skip_empty_header_list():
    root_node = create_toc([])
    assert root_node.parent is None
    assert len(root_node.children) == 0


def test_flatten_hierarchy_tree():
    root_node = create_toc(sample_0)
    current_non_num_level = 1
    for h, level in flatten_hierarchy_tree(root_node):
        if h.level_numerical:
            assert level == len(h.level_numerical)
            current_non_num_level = level + 1
        else:
            assert current_non_num_level == level


def test_catch_illformatted_arabic_numbering():
    headings = [
        {
            "text": "APPENDIX 1 TO ANNEX I",
            "font_size": np.float64(10.331999999999994),
            "is_bold": False,
            "is_italic": False,
            "top_left": 111.356,
            "text_direction:": TextDirection.LEFT_TO_RIGHT,
            "font": "/Times New Roman",
            "reference": "#/texts/0",
        },
        {
            "text": "PRODUCT-SPECIFIC RULES",
            "font_size": np.float64(10.331999999999994),
            "is_bold": False,
            "is_italic": False,
            "top_left": 138.9559999999999,
            "text_direction:": TextDirection.LEFT_TO_RIGHT,
            "font": "/Times New Roman",
            "reference": "#/texts/1",
        },
        {
            "text": "Interpretative Notes",
            "font_size": np.float64(10.093000000000075),
            "is_bold": False,
            "is_italic": False,
            "top_left": 180.54899999999998,
            "text_direction:": TextDirection.LEFT_TO_RIGHT,
            "font": "/Times New Roman,Bold",
            "reference": "#/texts/2",
        },
        {
            "text": "25-97 EFTA-Central America",
            "font_size": np.float64(10.092999999999961),
            "is_bold": False,
            "is_italic": False,
            "top_left": 83.92899999999997,
            "text_direction:": TextDirection.LEFT_TO_RIGHT,
            "font": "/Times New Roman,Bold",
            "reference": "#/texts/33",
        },
    ]
    builder = DocumentHierarchyBuilder(headings)
    hh = builder.infer()

    ref_output = """  APPENDIX 1 TO ANNEX I
  PRODUCT-SPECIFIC RULES
    Interpretative Notes
    25-97 EFTA-Central America
"""
    assert str(hh) == ref_output
