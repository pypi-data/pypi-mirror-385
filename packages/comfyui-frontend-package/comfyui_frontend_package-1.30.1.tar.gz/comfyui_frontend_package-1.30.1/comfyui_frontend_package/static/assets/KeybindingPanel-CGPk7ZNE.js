var L=Object.defineProperty;var o=(v,s)=>L(v,"name",{value:s,configurable:!0});import{defineComponent as V,computed as x,openBlock as m,createElementBlock as g,Fragment as T,renderList as R,createVNode as n,unref as t,withCtx as l,createTextVNode as A,toDisplayString as C,createCommentVNode as N,ref as p,watchEffect as G,resolveDirective as J,createBlock as $,createElementVNode as K,withModifiers as Q,withDirectives as W}from"vue";import{F as X}from"./index-BTSUBtd4.js";import f from"primevue/button";import h from"primevue/column";import Y from"primevue/datatable";import Z from"primevue/dialog";import P from"primevue/inputtext";import ee from"primevue/message";import U from"primevue/tag";import{useToast as ie}from"primevue/usetoast";import{useI18n as te}from"vue-i18n";import{b1 as ne,a as oe,a4 as le,db as ae,de as re,df as de,dg as se,f as me}from"./index-BI8HSLID.js";import{u as ue}from"./keybindingService-BadIL09I.js";import"@primevue/themes";import"@primevue/themes/aura";import"primevue/config";import"primevue/confirmationservice";import"primevue/toastservice";import"primevue/tooltip";import"primevue/blockui";import"primevue/progressspinner";import"primevue/checkbox";import"primevue/divider";import"primevue/scrollpanel";import"primevue/card";import"primevue/listbox";import"primevue/skeleton";import"primevue/progressbar";import"primevue/floatlabel";import"@primevue/forms";import"@primevue/forms/resolvers/zod";import"primevue/password";import"primevue/inputnumber";import"primevue/tabpanels";import"primevue/tabs";import"primevue/iconfield";import"primevue/inputicon";import"primevue/badge";import"primevue/chip";import"primevue/tabpanel";import"primevue/select";import"primevue/toggleswitch";import"primevue/colorpicker";import"primevue/radiobutton";import"primevue/knob";import"primevue/slider";import"primevue/panel";import"primevue/tabmenu";import"primevue/popover";import"primevue/tab";import"primevue/tablist";import"primevue";import"primevue/multiselect";import"primevue/contextmenu";import"primevue/tree";import"primevue/toolbar";import"primevue/tieredmenu";import"primevue/chart";import"primevue/galleria";import"primevue/imagecompare";import"primevue/textarea";import"primevue/treeselect";import"primevue/selectbutton";import"primevue/confirmpopup";import"primevue/useconfirm";import"primevue/confirmdialog";import"primevue/autocomplete";import"primevue/dropdown";const pe={key:0,class:"px-2"},ce=V({__name:"KeyComboDisplay",props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(v){const s=x(()=>v.keyCombo.getKeySequences());return(a,c)=>(m(),g("span",null,[(m(!0),g(T,null,R(s.value,(w,k)=>(m(),g(T,{key:k},[n(t(U),{severity:a.isModified?"info":"secondary"},{default:l(()=>[A(C(w),1)]),_:2},1032,["severity"]),k<s.value.length-1?(m(),g("span",pe,"+")):N("",!0)],64))),128))]))}}),be={class:"actions invisible flex flex-row"},ye=["title"],fe={key:1},ge={class:"overflow-hidden text-ellipsis"},ve=V({__name:"KeybindingPanel",setup(v){const s=p({global:{value:"",matchMode:X.CONTAINS}}),a=ne(),c=ue(),w=oe(),{t:k}=te(),D=x(()=>Object.values(w.commands).map(e=>({id:e.id,label:k(`commands.${le(e.id)}.label`,e.label??""),keybinding:a.getKeybindingByCommandId(e.id),source:e.source}))),I=p(null),b=p(!1),d=p(null),u=p(null),S=p(null),y=x(()=>!u.value||u.value.keybinding?.combo?.equals(d.value)||!d.value?null:a.getKeybinding(d.value));function E(e){u.value=e,d.value=e.keybinding?e.keybinding.combo:null,b.value=!0}o(E,"editKeybinding"),G(()=>{b.value&&setTimeout(()=>{S.value?.$el?.focus()},300)});async function O(e){e.keybinding&&(a.unsetKeybinding(e.keybinding),await c.persistUserKeybindings())}o(O,"removeKeybinding");async function F(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case"Escape":_();return;case"Enter":await M();return}const r=de.fromEvent(e);d.value=r}o(F,"captureKeybinding");function _(){b.value=!1,u.value=null,d.value=null}o(_,"cancelEdit");async function M(){u.value&&d.value&&a.updateKeybindingOnCommand(new se({commandId:u.value.id,combo:d.value}))&&await c.persistUserKeybindings(),_()}o(M,"saveKeybinding");async function q(e){a.resetKeybindingForCommand(e.id)?await c.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}o(q,"resetKeybinding");const j=ie();async function z(){a.resetAllKeybindings(),await c.persistUserKeybindings(),j.add({severity:"info",summary:"Info",detail:"All keybindings reset",life:3e3})}return o(z,"resetAllKeybindings"),(e,r)=>{const H=J("tooltip");return m(),$(ae,{value:"Keybinding",class:"keybinding-panel"},{header:l(()=>[n(re,{modelValue:s.value.global.value,"onUpdate:modelValue":r[0]||(r[0]=i=>s.value.global.value=i),placeholder:e.$t("g.searchKeybindings")+"..."},null,8,["modelValue","placeholder"])]),default:l(()=>[n(t(Y),{selection:I.value,"onUpdate:selection":r[1]||(r[1]=i=>I.value=i),value:D.value,"global-filter-fields":["id","label"],filters:s.value,"selection-mode":"single","striped-rows":"",pt:{header:"px-0"},onRowDblclick:r[2]||(r[2]=i=>E(i.data))},{default:l(()=>[n(t(h),{field:"actions",header:""},{body:l(i=>[K("div",be,[n(t(f),{icon:"pi pi-pencil",class:"p-button-text",onClick:o(B=>E(i.data),"onClick")},null,8,["onClick"]),n(t(f),{icon:"pi pi-replay",class:"p-button-text p-button-warn",disabled:!t(a).isCommandKeybindingModified(i.data.id),onClick:o(B=>q(i.data),"onClick")},null,8,["disabled","onClick"]),n(t(f),{icon:"pi pi-trash",class:"p-button-text p-button-danger",disabled:!i.data.keybinding,onClick:o(B=>O(i.data),"onClick")},null,8,["disabled","onClick"])])]),_:1}),n(t(h),{field:"id",header:e.$t("g.command"),sortable:"",class:"max-w-64 2xl:max-w-full"},{body:l(i=>[K("div",{class:"truncate",title:i.data.id},C(i.data.label),9,ye)]),_:1},8,["header"]),n(t(h),{field:"keybinding",header:e.$t("g.keybinding")},{body:l(i=>[i.data.keybinding?(m(),$(ce,{key:0,"key-combo":i.data.keybinding.combo,"is-modified":t(a).isCommandKeybindingModified(i.data.id)},null,8,["key-combo","is-modified"])):(m(),g("span",fe,"-"))]),_:1},8,["header"]),n(t(h),{field:"source",header:e.$t("g.source")},{body:l(i=>[K("span",ge,C(i.data.source||"-"),1)]),_:1},8,["header"])]),_:1},8,["selection","value","filters"]),n(t(Z),{visible:b.value,"onUpdate:visible":r[3]||(r[3]=i=>b.value=i),class:"min-w-96",modal:"",header:u.value?.label,onHide:_},{footer:l(()=>[n(t(f),{label:y.value?"Overwrite":"Save",icon:y.value?"pi pi-pencil":"pi pi-check",severity:y.value?"warn":void 0,autofocus:"",onClick:M},null,8,["label","icon","severity"])]),default:l(()=>[K("div",null,[n(t(P),{ref_key:"keybindingInput",ref:S,class:"mb-2 text-center","model-value":d.value?.toString()??"",placeholder:"Press keys for new binding",autocomplete:"off",fluid:"",onKeydown:Q(F,["stop","prevent"])},null,8,["model-value"]),y.value?(m(),$(t(ee),{key:0,severity:"warn"},{default:l(()=>[A(C(e.$t("g.keybindingAlreadyExists"))+" ",1),n(t(U),{severity:"secondary",value:y.value.commandId},null,8,["value"])]),_:1})):N("",!0)])]),_:1},8,["visible","header"]),W(n(t(f),{class:"mt-4",label:e.$t("g.resetAll"),icon:"pi pi-replay",severity:"danger",fluid:"",text:"",onClick:z},null,8,["label"]),[[H,e.$t("g.resetAllKeybindingsTooltip")]])]),_:1})}}}),Ai=me(ve,[["__scopeId","data-v-438c61fa"]]);export{Ai as default};
//# sourceMappingURL=KeybindingPanel-CGPk7ZNE.js.map
