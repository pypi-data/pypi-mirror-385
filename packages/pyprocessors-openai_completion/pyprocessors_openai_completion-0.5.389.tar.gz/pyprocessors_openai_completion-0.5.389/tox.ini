[tox]
isolated_build = True
envlist = clean,py38,report

[gh-actions]
python =
  3.8: clean,py38,report

[pytest]
addopts =
  --durations=5
  --flake8
norecursedirs =
  docs

filterwarnings =
    ignore:<class '.*'> is not using a cooperative constructor:pytest.PytestDeprecationWarning
    ignore:The \(fspath. py.path.local\) argument to .* is deprecated.:pytest.PytestDeprecationWarning
    ignore:.* is an Item subclass and should not be a collector.*:pytest.PytestWarning

[testenv]
deps = .[test]
commands = pytest --junit-xml={env:TEST_REPORT_DIR:.}/{env:TEST_REPORT_FILE:results.xml}
passenv = *
depends =
  report: py38

[testenv:docs]
changedir=docs
deps = .[docs]
commands = sphinx-build . _build

[flake8]
max-line-length = 140
ignore =
  E131,
  E126,
  E203,
  E266,
  E501,
  W503,
  W291,
  C901
per-file-ignores =
  __init__.py: F401
max-complexity = 18
select = B, C, E, F, W, T4, B9
exclude =
  .git,
  .tox,
  __pycache__,
  dist,
