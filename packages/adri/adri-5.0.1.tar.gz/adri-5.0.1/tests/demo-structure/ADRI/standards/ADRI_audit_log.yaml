# ADRI Audit Log Standard
# Defines the required structure and validation rules for ADRI audit log CSV files
# This standard is used to validate that ADRI's audit trail is consistent and complete

standards:
  id: ADRI_audit_log
  name: ADRI Audit Log Standard
  version: 1.0.0
  authority: ADRI Framework
  description: Standard for validating ADRI audit log CSV structure and content

record_identification:
  primary_key_fields:
    - assessment_id
  strategy: primary_key_with_fallback

requirements:
  overall_minimum: 95.0  # High bar for ADRI's own audit logs

  field_requirements:
    # Core identification fields
    assessment_id:
      type: string
      nullable: false
      pattern: '^adri_\d{8}_\d{6}_[a-f0-9]+$'
      description: Unique assessment identifier

    timestamp:
      type: string
      nullable: false
      pattern: '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+$'
      description: ISO 8601 timestamp of assessment

    adri_version:
      type: string
      nullable: false
      description: ADRI version that performed the assessment

    # Assessment type and context
    assessment_type:
      type: string
      nullable: false
      valid_values:
        - QUALITY_CHECK
        - VALIDATION
        - PROFILING
      description: Type of assessment performed

    function_name:
      type: string
      nullable: false
      description: Function that triggered the assessment

    module_path:
      type: string
      nullable: false
      description: Module path where assessment was triggered

    environment:
      type: string
      nullable: false
      valid_values:
        - PRODUCTION
        - DEVELOPMENT
        - TESTING
        - STAGING
      description: Environment where assessment ran

    # System information
    hostname:
      type: string
      nullable: false
      description: Hostname of system running assessment

    process_id:
      type: integer
      nullable: false
      min_value: 0
      description: Process ID of assessment execution

    # Standard information
    standard_id:
      type: string
      nullable: false
      description: ID of standard used for assessment

    standard_version:
      type: string
      nullable: false
      description: Version of standard (may be 'unknown')

    standard_checksum:
      type: string
      nullable: true
      description: Checksum of standard file (optional)

    # Dataset information
    data_row_count:
      type: integer
      nullable: false
      min_value: 0
      description: Number of rows in assessed dataset

    data_column_count:
      type: integer
      nullable: false
      min_value: 0
      description: Number of columns in assessed dataset

    data_columns:
      type: string
      nullable: false
      description: JSON array of column names

    data_checksum:
      type: string
      nullable: false
      description: Checksum of data

    # Assessment results
    overall_score:
      type: float
      nullable: false
      min_value: 0.0
      max_value: 100.0
      description: Overall quality score (0-100)

    required_score:
      type: float
      nullable: false
      min_value: 0.0
      max_value: 100.0
      description: Required minimum score for passing

    passed:
      type: boolean
      nullable: false
      description: Whether assessment passed threshold

    # Execution context
    execution_decision:
      type: string
      nullable: false
      valid_values:
        - ALLOWED
        - BLOCKED
        - WARNED
      description: Decision made based on assessment result

    failure_mode:
      type: string
      nullable: false
      valid_values:
        - raise
        - warn
        - log
      description: How failures are handled

    function_executed:
      type: boolean
      nullable: false
      description: Whether protected function was executed

    # Performance metrics
    assessment_duration_ms:
      type: integer
      nullable: false
      min_value: 0
      description: Duration of assessment in milliseconds

    rows_per_second:
      type: float
      nullable: false
      min_value: 0.0
      description: Processing rate (rows per second)

    cache_used:
      type: boolean
      nullable: false
      description: Whether cached results were used

  dimension_requirements:
    validity:
      minimum_score: 19.0
      weight: 1.0
      scoring:
        rule_weights:
          data_types: 1.0
          value_ranges: 1.0
        field_overrides: {}

    completeness:
      minimum_score: 19.0
      weight: 1.0
      scoring:
        rule_weights:
          required_fields: 1.0
        field_overrides: {}

    consistency:
      minimum_score: 19.0
      weight: 1.0
      scoring:
        rule_weights:
          field_consistency: 1.0
        field_overrides: {}

    freshness:
      minimum_score: 18.0
      weight: 1.0
      scoring:
        rule_weights:
          timestamp_validity: 1.0
        field_overrides: {}

    plausibility:
      minimum_score: 18.0
      weight: 1.0
      scoring:
        rule_weights:
          score_ranges: 1.0
          enum_values: 1.0
        field_overrides: {}

metadata:
  purpose: Self-validation of ADRI audit log outputs
  usage: |
    This standard validates that ADRI audit log CSV files contain:
    1. All required tracking fields with correct types
    2. Valid timestamps and identifiers
    3. Proper score ranges and boolean flags
    4. Valid enum values for categorical fields
    5. Complete execution and performance metrics

  validation_notes: |
    - assessment_id must follow pattern: adri_YYYYMMDD_HHMMSS_hexhash
    - timestamp must be valid ISO 8601 format
    - overall_score and required_score must be 0-100
    - Categorical fields have specific valid values
    - All performance metrics must be non-negative
    - data_columns should be valid JSON array format

  created_by: ADRI Framework
  created_date: 2025-10-03
