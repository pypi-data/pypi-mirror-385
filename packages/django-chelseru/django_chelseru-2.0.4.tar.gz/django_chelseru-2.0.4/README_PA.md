django-chelseru
ฺฉ ุจุณุชู ุฌูฺฏู ุจุฑุง ฺฏูพโุฒู ููุฒูุงูุ ุฑุงุณุชโุขุฒูุง ูพุงูฺฉ ู ูุฑุณุชุงุฏู ูพุงูฺฉ ุจุง ุงุฑโุฏููุฏูโูุง ุงุฑุงู.

ููุณูุฏู
Sobhan Bahman Rashnu

๐ ูฺฺฏโูุง
๐ฑ ุฑุงุณุชโุขุฒูุง ูพุงูฺฉ (ุฑูุฒ ฺฉโุจุงุฑูุตุฑู): ุฑุงุณุชโุขุฒูุง ุงูู ฺฉุงุฑุจุฑุงู ุจุง ุงุฑโฺฏุฑ ุงุฒ ุฑูุฒูุง ฺฉโุจุงุฑูุตุฑู ฺฉู ุงุฒ ุฑุงู ูพุงูฺฉ ูุฑุณุชุงุฏู ูโุดููุฏ.

๐ฌ ฺฏูพโุฒู ููุฒูุงู: ฺฉุงุฑฺฉุฑุฏ ูพุงูโุฑุณุงู ููุฒูุงู ุจุฑ ูพุงู WebSocket.

โ๏ธ ุณุงูุงููโูุง ูพุงูฺฉ: ูุฑุณุชุงุฏู ูพุงูฺฉ ุงุฒ ุฑุงู ุงุฑโุฏููุฏูโูุง ูุงููุฑ ูพุงูฺฉ ุงุฑุงู.

โ๏ธ ูุตุจ
ุจุณุชู ุฑุง ุจุง ุงุฑโฺฏุฑ ุงุฒ pip ูุตุจ ฺฉูุฏ:

pip install django-chelseru

'drfchelseru' ุฑุง ุจู INSTALLED_APPS ุฏุฑ ูพุฑููุฏู settings.py ุฎูุฏ ุจูุฒุงุฏ:

INSTALLED_APPS = [
    ...
    'channels',
    'rest_framework',
    'rest_framework_simplejwt',
    'drfchelseru',
    ...
]

๐๏ธ ูพฺฉุฑุจูุฏ
ุจุฑุง ูพฺฉุฑุจูุฏ ุจุณุชูุ ูุงฺูโูุงูู DJANGO_CHELSERU ุฑุง ุจู ูพุฑููุฏู settings.py ุฎูุฏ ุจูุฒุงุฏ. ุงู ูุงฺูโูุงูู ุจู ุดูุง ูพุฑูุงูู ูโุฏูุฏ ุชุง ฺุฏูุงูโูุง ุฑุงุณุชโุขุฒูุง ู ูพุงูฺฉ ุฑุง ุฎูุฏุณุงุฎุชู ููุงุฏ.

# settings.py

DJANGO_CHELSERU = {
    'AUTH': {
        'AUTH_METHOD'           : 'OTP',                        # ุฑูุดโูุง ูพุดุชุจุงู ุดุฏู: OTP, PASSWD
        'AUTH_SERVICE'          : 'rest_framework_simplejwt',   # ุณุฑูุณโูุง ูพุดุชุจุงู ุดุฏู: rest_framework_simplejwt
        'OPTIONS': {
            'OTP_LENGTH'            : 8,    # ูพุดโูุฑุถ: 8
            'OTP_EXPIRE_PER_MINUTES': 4,    # ูพุดโูุฑุถ: 4
            'OTP_SMS_TEMPLATE_ID'   : 1,    # ุดูุงุณู ูุงูุจ ูพุงูฺฉ ุจุฑุง ุฑูุฒ ฺฉโุจุงุฑูุตุฑู
        }
    },
    'SMS': {
        'SMS_SERVICE': 'PARSIAN_WEBCO_IR',  # ุงุฑโุฏููุฏูโูุง ูพุดุชุจุงู ุดุฏู: PARSIAN_WEBCO_IR, MELI_PAYAMAK_COM, KAVENEGAR_COM
        'SETTINGS': {
            'PARSIAN_WEBCO_IR_API_KEY'  : '',
            'MELI_PAYAMAK_COM_USERNAME' : '',
            'MELI_PAYAMAK_COM_PASSWORD' : '',
            'MELI_PAYAMAK_COM_FROM'     : '',
            'KAVENEGAR_COM_API_KEY'     : 'YOUR_KAVENEGAR_API_KEY',
            'KAVENEGAR_COM_FROM'        : 'YOUR_KAVENEGAR_FROM_NUMBER',
        },
        'TEMPLATES': {
            'T1': 1,
            'T2': 2,
            ...
        }
    }
}

AUTH_METHOD: ุฑูุด ุฑุงุณุชโุขุฒูุง ุฑุง ุฑูุดู ูโุณุงุฒุฏ. ุจุฑุง ุฑุงุณุชโุขุฒูุง ูพุงูฺฉุ ุงุฒ 'OTP' ุจูุฑู ุจฺฏุฑุฏ.

OTP_LENGTH: ุฏุฑุงุฒุง ุฑูุฒ ฺฉโุจุงุฑูุตุฑู.

OTP_EXPIRE_PER_MINUTES: ุฒูุงู ูพุงุงูโุงูุชู ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุจุฑ ูพุงู ุฏููู.

OTP_SMS_TEMPLATE_ID: ุดูุงุณู ูุงูุจ ูพุงูฺฉ ฺฉู ุจุฑุง ูุฑุณุชุงุฏู ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุจูุฑู ฺฏุฑูุชู ูโุดูุฏ.

SMS_SERVICE: ุงุฑโุฏููุฏู ูพุงูฺฉ ุฏูุฎูุงู ุฎูุฏ ุฑุง ุจุฑฺฏุฒูุฏ.

SETTINGS: ุขฺฏุงูโูุง ูุงุฒ ุจุฑุง ุงุฑโุฏููุฏู ูพุงูฺฉ ุจุฑฺฏุฒุฏูโุชุงู ุฑุง ูุฑุงูู ุขูุฑุฏ.

TEMPLATES: ุดูุงุณูโูุง ูุงูุจ ูพุงูฺฉ ุฎูุฏ ุฑุง ุฑูุดู ุณุงุฒุฏ.

๐ ููุทูโูุง ูพุงุงู
ุจุฑุง ุจู ฺฉุงุฑฺฏุฑ ฺฉุงุฑฺฉุฑุฏูุง ุงู ุจุณุชูุ URLูุง ุฒุฑ ุฑุง ุจู ูพุฑููุฏู urls.py ุฎูุฏ ุจูุฒุงุฏ.

# urls.py

from django.urls import path, include

urlpatterns = [
    ...
    path('api/', include('drfchelseru.urls')),
    ...
]

ุงู ุจุณุชู ููุทูโูุง ูพุงุงู API ุฒุฑ ุฑุง ูุฑุงูู ูโุขูุฑุฏ:

ููุทูโ ูพุงุงู

ุดุฑุญ

ุฑูุด

/api/otp/send/

ฺฉ ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุจู ุดูุงุฑู ููุฑุงู ฺฏูุชูโุดุฏู ูโูุฑุณุชุฏ.

POST

/api/authenticate/

ฺฉุงุฑุจุฑ ุฑุง ุจุง ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุฏุฑุงูุชโุดุฏูุ ุฑุงุณุชโุขุฒูุง ูโฺฉูุฏ.

POST

/api/sessions/

ูุดุณุชโูุง ูุนุงู ฺฉุงุฑุจุฑ ุฑุง ููุฑุณุช ฺฉุฑุฏู ู ุฏุฑุงูุฑ ูโฺฉูุฏ.

GET

/api/message/send/

ฺฉ ูพุงูฺฉ ุจุง ุงุฑโุฏููุฏู ูพฺฉุฑุจูุฏโุดุฏู ูโูุฑุณุชุฏ.

POST

ุจู ฺฉุงุฑฺฏุฑ ููุทูโูุง ูพุงุงู
1. ูุฑุณุชุงุฏู ุฑูุฒ ฺฉโุจุงุฑูุตุฑู (/api/otp/send/)
ุฑูุด: POST ุดุฑุญ: ฺฉ ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุจู ุดูุงุฑู ููุฑุงู ฺฉุงุฑุจุฑ ูโูุฑุณุชุฏ.

ุฏุงุฏูโููุงูุง ูุงุฒ:

ุฏุงุฏูโููุง

ฺฏููู

ุดุฑุญ

ููููู

mobile_number

str

ุดูุงุฑู ููุฑุงู ฺฉุงุฑุจุฑ.

09121234567

ูพุงุณุฎโูุง:

HTTP 200 OK: ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุจุง ฺฉุงูุงุจ ูุฑุณุชุงุฏู ุดุฏ.

{"details": "The OTP code was sent correctly."}

HTTP 400 BAD REQUEST: ุณุงุฎุชุงุฑ ูุงุฏุฑุณุช mobile_number.

HTTP 409 CONFLICT: ฺฉ ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ูพุดโุชุฑ ูุฑุณุชุงุฏู ุดุฏู ู ูููุฒ ุฑูุง ุฏุงุฑุฏ.

{"details": "An OTP code has already been sent. Please wait X seconds before trying again."}

HTTP 500 INTERNAL SERVER ERROR: ฺฉ ุฏุดูุงุฑ ุฏุฑ ฺฉุงุฑฺฏุฐุงุฑ ูพุด ุขูุฏู ุงุณุช.

2. ุฑุงุณุชโุขุฒูุง (/api/authenticate/)
ุฑูุด: POST ุดุฑุญ: ฺฉุงุฑุจุฑ ุฑุง ุจุง ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ูุฑุงูู ุดุฏูุ ุฑุงุณุชโุขุฒูุง ูโฺฉูุฏ. ุงฺฏุฑ ุจุง ฺฉุงูุงุจ ุงูุฌุงู ุดูุฏุ ุชูฺฉูโูุง JWT (access ู refresh) ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.

ุฏุงุฏูโููุงูุง ูุงุฒ:

ุฏุงุฏูโููุง

ฺฏููู

ุดุฑุญ

ููููู

mobile_number

str

ุดูุงุฑู ููุฑุงู ฺฉุงุฑุจุฑ.

09121234567

code

str

ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ุฏุฑุงูุช ุดุฏู ุงุฒ ุฑุงู ูพุงูฺฉ.

12345678

group

int

ุงุฎุชุงุฑ: ฺฉ ุดูุงุณู ุฏุณุชู ุจุฑุง ฺฉุงุฑุจุฑ.

1

ูพุงุณุฎโูุง:

HTTP 200 OK: ุฑุงุณุชโุขุฒูุง ุจุง ฺฉุงูุงุจ ุงูุฌุงู ุดุฏ.

{
  "access": "...",
  "refresh": "..."
}

HTTP 401 UNAUTHORIZED: ุฑูุฒ ฺฉโุจุงุฑูุตุฑู ูุงุฑูุง ุง ูพุงุงูโุงูุชู.

{"error": "The code sent to this mobile number was not found."}

HTTP 400 BAD REQUEST: ุฏุงุฏูโููุงูุง ูุงุฒ ูุงูพุฏุง ุง ุณุงุฎุชุงุฑ ูุงุฏุฑุณุช.

HTTP 500 INTERNAL SERVER ERROR: ฺฉ ุฏุดูุงุฑ ุฏุฑ ฺฉุงุฑฺฏุฐุงุฑ ูพุด ุขูุฏู ุงุณุช.

3. ูุฑุณุชุงุฏู ูพุงูฺฉ (/api/message/send/)
ุฑูุด: POST ุดุฑุญ: ฺฉ ูพุงูฺฉ ุฎูุฏุณุงุฎุชู ุฑุง ุจุง ุงุฑโุฏููุฏู ูพฺฉุฑุจูุฏโุดุฏู ูโูุฑุณุชุฏ.

ุฏุงุฏูโููุงูุง ูุงุฒ:

ุฏุงุฏูโููุง

ฺฏููู

ุดุฑุญ

ููููู

mobile_number

str

ุดูุงุฑู ููุฑุงู ฺฏุฑูุฏู.

09121234567

message_text

str

ููุดุชุงุฑ ูพุงู. (ุจุดูู ฒนฐ ููุณู)

Hello, World!

template_id

int

ุจุฑุง ุจุฑุฎ ุงุฑโุฏููุฏูโูุง (ุจุฑุง ููููู ูพุงุฑุณุงู) ูุงุฒ ุงุณุช.

1

ูพุงุณุฎโูุง:

HTTP 200 OK: ูพุงู ุจุง ฺฉุงูุงุจ ูุฑุณุชุงุฏู ุดุฏ.

{"details": "The Message was sent correctly."}

HTTP 400 BAD REQUEST: ุฏุดูุงุฑโูุง ุฏุฑุณุชโุณูุฌ ุจุฑุง ุฏุงุฏูโููุงูุง.

HTTP 401 UNAUTHORIZED: ุฑุงุณุชโุขุฒูุง ุงูุฌุงู ูุดุฏ.

HTTP 500 INTERNAL SERVER ERROR: ฺฉ ุฏุดูุงุฑ ุฏุฑ ฺฉุงุฑฺฏุฐุงุฑ ูพุด ุขูุฏู ุงุณุช.

HTTP 502 BAD GATEWAY: ุงุฑโุฏููุฏู ูพุงูฺฉ ฺฉ ุฏุดูุงุฑ ุฑุง ุจุงุฒฺฏุฑุฏุงูุฏ.

4. ููุฑุณุช ูุดุณุชโูุง (/api/sessions/)
ุฑูุด: GET ุดุฑุญ: ููู ูุดุณุชโูุง ูุนุงู ฺฉุงุฑุจุฑุงู ุฑุง ููุฑุณุช ูโฺฉูุฏ. ูุงุฒ ุจู ุฑุงุณุชโุขุฒูุง (IsAuthenticated) ุฏุงุฑุฏ.

ุณุฑุจุฑฺฏโูุง ูุงุฒ:

ุณุฑุจุฑฺฏ

ุงุฑุฒุด

Authorization

Bearer <your_access_token>

๐ก ูุฏูโูุง
ุงู ุจุณุชู ฺฉ ูุฏู Session ุจุฑุง ุฏุฑุงูุฑ ูุดุณุชโูุง ูุนุงู ฺฉุงุฑุจุฑุงู ุฏุงุฑุฏ. ูโุชูุงูุฏ ุจู ุงู ูุดุณุชโูุง ุงุฒ ุฑุงู ููุทูโ ูพุงุงู /api/sessions/ ุฏุณุชุฑุณ ุงูุชู ู ุขููุง ุฑุง ุฏุฑุงูุฑ ฺฉูุฏ.