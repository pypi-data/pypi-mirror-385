============= CLI >>-h<< ====================
usage: ncrystal_vdos2ncmat [-h] [--plot] [--cutoff CUTOFF [CUTOFF ...]]
                           [--unit UNIT] [--ref REF [REF ...]]
                           [--forceregular [FORCEREGULAR]] [--debye [DEBYE]]
                           [--g1 TEMP] [--stdout] [--dpi DPI]
                           FILE

WARNING: This script is somewhat outdated. Many users will instead wish to use the
PhononDOSAnalyser helper class from the Python API in the NCrystal.vdos python
module. For more information, see the jupyter notebook about "Adding phonon
information" on: https://github.com/mctools/ncrystal-notebooks

Script which can read vdos curves from either .ncmat files or simple two-column
ascii text files (the two columns being energy grid and density) and help users
prepare output suitable for inclusion in .ncmat files. When the input is not an
.ncmat file, the user must specify the energy grid units by adding a line in the
file like for instance "#unit:THz" or "#unit:meV".

In case of NCMAT files with more than one VDOS, just post-fix the filename with
the element to investigate, separated by '@@', e.g. "Al2O3.ncmat@@O". In case of
.txt files with more than 2 columns, select the column representing the VDOS
density in the same manner, e.g. "Al2O3.txt@2" (the first column is always the
energy or frequency).

Thus it is possible to plot the curve, compare against vdos curves from other
.ncmat files, apply low-E truncation (cutoff), regularise binning, and overlay
with an ideal Debye spectrum for a given Debye energy or Debye temperature.
Finally, when running without --plot, it will output the resulting spectrum into
format which is ready for inclusion in .ncmat files.

positional arguments:
  FILE                  Either .ncmat file with VDOS or a text file with two colums
                        of data: egrid and density.

options:
  -h, --help            show this help message and exit
  --plot, -p            Plot extracted spectrum
  --cutoff, -c CUTOFF [CUTOFF ...]
                        Emin cutoff points in eV (more than one can be provided for
                        simultaneous inspection with --plot).
  --unit, -u UNIT       Visualisation unit (ignored unless --plot is supplied).
                        Defaults to meV. Possible options are 1/cm, GHz, Hz, MHz,
                        MeV, THz, eV, kHz, keV, meV.
  --ref, -r REF [REF ...]
                        Optionally provide list of .ncmat files with vdos data, to
                        superimpose on plots.
  --forceregular, -f [FORCEREGULAR]
                        Optionally provide this argument to reparameterise with that
                        amount of linearly spaced points in [emin,emax+epsilon],
                        where epsilon is chosen so the grid can be extended to 0
                        with a whole number of bins. This format will be directly
                        used by NCrystal without on-the-fly reparameterisation upon
                        loading.
  --debye, -d [DEBYE]   Set to debye temperature (unit K) or egrid point (units like
                        meV, eV, THz, ...) in order to plot Debye spectrum with that
                        parameter on top.
  --g1 TEMP             Use with --plot to show Sjolander's G1 function at the
                        indicated temperature value (in kelvin) instead of the DOS
                        directly. This is the Symmetric G1 fct without a detailed
                        balance factor, and it will be plotted assuming gamma0=1.0.
  --stdout              Produce no output file but print vdos_egrid and vdos_density
                        lines to stdout (for scripting)
  --dpi DPI             Change plot resolution. Set to 0 to leave matplotlib
                        defaults alone. (default value is 200, or whatever the
                        NCRYSTAL_DPI env var is set to).

=============================================
============= CLI >>Al_sg225.ncmat<< ====================
Loaded VDOS with 275 grid points from Al_sg225.ncmat
NB: Detected linearly spaced input egrid
Wrote converted_output.ncmat
OUTFILE>NCMAT v5
OUTFILE>#Autogenerated file from Al_sg225.ncmat.
OUTFILE>@DENSITY
OUTFILE>  1.0 g_per_cm3 #FIXME!! Please replace with proper value, or remove and optionally provide crystal structure!
OUTFILE>@DYNINFO
OUTFILE>  element  <UNKNOWN-PLEASE-EDIT>
OUTFILE>  fraction 1
OUTFILE>  type     vdos
OUTFILE>  vdos_egrid 0.00485015 0.0398222
OUTFILE>  vdos_density .013232 .0141193 .0150065 .0158938 .0167811 .0176684 .0185557
OUTFILE>   .0195536 .020725 .0218964 .0230678 .0242392 .0254106 .0265808 .027748
OUTFILE>   .0289152 .0300825 .0312497 .032417 .0338129 .0352559 .0366988 .0381418
OUTFILE>   .0395847 .0412955 .043043 .0447906 .0465382 .0482858 .0500848 .0519404
OUTFILE>   .0537959 .0556515 .057507 .0593626 .0613858 .0638226 .0662593 .0686961
OUTFILE>   .0711328 .0735696 .0760063 .0785759 .081366 .0841561 .0869462 .0897363
OUTFILE>   .0925265 .0954792 .0987494 .10202 .10529 .10856 .11183 .115538 .119309 .12308
OUTFILE>   .126851 .130875 .135268 .139661 .144055 .148448 .152842 .157573 .162305
OUTFILE>   .167036 .171767 .176499 .18201 .187579 .193147 .198833 .20494 .211048 .217155
OUTFILE>   .223262 .229369 .236467 .243837 .251208 .258578 .266432 .275333 .284233
OUTFILE>   .293133 .303592 .314275 .324959 .335642 .349394 .363213 .377789 .396045
OUTFILE>   .414301 .439971 .471089 .514605 .610025 .707931 .696698 .687436 .679569
OUTFILE>   .672862 .667612 .662494 .65946 .656426 .653391 .651511 .649818 .648548
OUTFILE>   .648291 .648033 .648114 .648959 .649803 .650648 .652271 .654251 .656231
OUTFILE>   .658385 .660883 .66338 .666831 .670734 .674636 .678939 .68327 .687962 .693084
OUTFILE>   .698207 .703766 .710271 .716775 .72328 .73082 .738646 .746472 .755309 .764205
OUTFILE>   .773061 .781132 .789068 .794645 .797985 .798822 .798529 .79508 .774768 .71273
OUTFILE>   .67965 .649939 .627278 .607527 .590861 .57517 .561495 .54884 .537956 .527173
OUTFILE>   .516685 .506197 .496343 .487181 .478019 .46898 .460042 .451104 .442408
OUTFILE>   .434216 .426025 .415941 .403984 .39053 .375124 .372167 .371561 .37199 .372419
OUTFILE>   .372847 .373079 .373154 .373228 .373214 .372782 .372351 .37192 .371412
OUTFILE>   .370855 .370298 .369741 .368973 .367973 .366974 .365974 .364975 .363901
OUTFILE>   .362208 .360515 .358822 .356884 .354458 .352031 .349604 .347178 .34379
OUTFILE>   .340173 .336555 .332841 .327735 .322629 .317522 .311459 .304041 .296623
OUTFILE>   .287643 .278031 .260712 .247663 .243349 .241651 .241493 .245625 .252347
OUTFILE>   .260515 .272178 .288183 .308977 .337849 .366583 .394604 .428828 .466863
OUTFILE>   .508577 .555451 .617322 .679027 .79657 .954686 .930006 .908781 .916995
OUTFILE>   .932774 .950737 .968525 .988039 1 .979429 .895711 .774741 .718589 .672154
OUTFILE>   .631992 .596623 .565164 .537389 .509862 .484214 .458806 .434668 .410583
OUTFILE>   .386357 .362131 .337836 .313452 .289068 .261524 .233749 .20274 .16795 .125961
OUTFILE>   .0770796 .0135243 0
OUTFILE>
=========================================================
============= CLI >>Al_sg225.ncmat --cutoff=0.03<< ====================
Loaded VDOS with 275 grid points from Al_sg225.ncmat
 => Mapping cutoff value of 0.03 to grid point at 0.03012192335766424
NB: Detected linearly spaced input egrid
Wrote converted_output.ncmat
OUTFILE>NCMAT v5
OUTFILE>#Autogenerated file from Al_sg225.ncmat.
OUTFILE>@DENSITY
OUTFILE>  1.0 g_per_cm3 #FIXME!! Please replace with proper value, or remove and optionally provide crystal structure!
OUTFILE>@DYNINFO
OUTFILE>  element  <UNKNOWN-PLEASE-EDIT>
OUTFILE>  fraction 1
OUTFILE>  type     vdos
OUTFILE>  vdos_egrid 0.030121923357664 0.0398222
OUTFILE>  vdos_density .362208 .360515 .358822 .356884 .354458 .352031 .349604 .347178
OUTFILE>   .34379 .340173 .336555 .332841 .327735 .322629 .317522 .311459 .304041
OUTFILE>   .296623 .287643 .278031 .260712 .247663 .243349 .241651 .241493 .245625
OUTFILE>   .252347 .260515 .272178 .288183 .308977 .337849 .366583 .394604 .428828
OUTFILE>   .466863 .508577 .555451 .617322 .679027 .79657 .954686 .930006 .908781
OUTFILE>   .916995 .932774 .950737 .968525 .988039 1 .979429 .895711 .774741 .718589
OUTFILE>   .672154 .631992 .596623 .565164 .537389 .509862 .484214 .458806 .434668
OUTFILE>   .410583 .386357 .362131 .337836 .313452 .289068 .261524 .233749 .20274 .16795
OUTFILE>   .125961 .0770796 .0135243 0
OUTFILE>
=======================================================================
============= CLI >>Al_sg225.ncmat --cutoff=0.03 --stdout<< ====================
Loaded VDOS with 275 grid points from Al_sg225.ncmat
 => Mapping cutoff value of 0.03 to grid point at 0.03012192335766424
NB: Detected linearly spaced input egrid
<<<GENERATED-CONTENT-BEGIN>>>
  vdos_egrid 0.030121923357664 0.0398222
  vdos_density .362208 .360515 .358822 .356884 .354458 .352031 .349604 .347178
   .34379 .340173 .336555 .332841 .327735 .322629 .317522 .311459 .304041
   .296623 .287643 .278031 .260712 .247663 .243349 .241651 .241493 .245625
   .252347 .260515 .272178 .288183 .308977 .337849 .366583 .394604 .428828
   .466863 .508577 .555451 .617322 .679027 .79657 .954686 .930006 .908781
   .916995 .932774 .950737 .968525 .988039 1 .979429 .895711 .774741 .718589
   .672154 .631992 .596623 .565164 .537389 .509862 .484214 .458806 .434668
   .410583 .386357 .362131 .337836 .313452 .289068 .261524 .233749 .20274 .16795
   .125961 .0770796 .0135243 0
================================================================================
