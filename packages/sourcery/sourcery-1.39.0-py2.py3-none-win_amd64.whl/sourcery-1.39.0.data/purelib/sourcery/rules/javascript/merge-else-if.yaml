version: '2'
rules:
- id: merge-else-if
  description: Merge else clause's nested if statement into `else if`
  explanation: |
    Flattening if statements nested within else clauses generates code that is
    easier to read and expand upon.
  language:
  - javascript
  - typescript
  tags:
  - default
  any:
  - pattern: |
      if (${cond1}) ...
      else {
        if (${cond2}) ...
        else ...
      }
    replacement: |
      if (${cond1}) ...
      else if (${cond2}) ...
      else ...
  - pattern: |
      if (${cond1}) ...
      else {
        if (${cond2}) ...
      }
    replacement: |
      if (${cond1}) ...
      else if (${cond2}) ...
  tests:
  - match: |
      if (response.status == 200) {
          return response.data
      } else {
        if (response.status == 404) {
          return "Not Found"
        } else if (response.status == 403) {
          return "Forbidden"
        } else {
          return "Error"
        }
      }
    expect: |
      if (response.status == 200) {
          return response.data
      } else if (response.status == 404) {
        return "Not Found"
      } else if (response.status == 403) {
        return "Forbidden"
      } else {
        return "Error"
      }
  - match: |
      if (response.status == 200) {
          return response.data
      } else {
        if (response.status == 404) {
          return "Not Found"
        }
      }
    expect: |
      if (response.status == 200) {
          return response.data
      } else if (response.status == 404) {
        return "Not Found"
      }
  - match: |
      if (response.status == 200) {
          return response.data
      } else if (response.status == 201) {
          return "Created"
      } else {
        if (response.status == 404) {
          return "Not Found"
        } else if (response.status == 403) {
          return "Forbidden"
        } else {
          return "Error"
        }
      }
    expect: |
      if (response.status == 200) {
          return response.data
      } else if (response.status == 201) {
          return "Created"
      } else if (response.status == 404) {
        return "Not Found"
      } else if (response.status == 403) {
        return "Forbidden"
      } else {
        return "Error"
      }
