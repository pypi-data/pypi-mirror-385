[project]
name = "nameko-keycloak"
version = "2.2.0"
description = "Helpers to integrate Single Sign-On in nameko-based applications using Keycloak."
requires-python = ">=3.10"
authors = [{name="Emplocity"}]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Intended Audience :: Developers",
    "Operating System :: Unix",
    "Operating System :: POSIX",
    "Programming Language :: Python",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Programming Language :: Python :: Implementation :: CPython",
    "Topic :: Utilities",
]
readme = "README.rst"
license = " Apache-2.0"
license-files = ["LICENSE"]
dependencies = [
    "nameko>=3.0rc11",
    "jwcrypto>=1.5",
    "python-keycloak>=4.2",
    "werkzeug>=2.0",
]

[project.urls]
Homepage = "https://github.com/Emplocity/nameko-keycloak"
Documentation = "https://nameko-keycloak.readthedocs.io/"
Changelog = "https://nameko-keycloak.readthedocs.io/en/latest/changelog.html"
"Issue Tracker" = "https://github.com/Emplocity/nameko-keycloak/issues"

[dependency-groups]
dev = [
    "black>=25.9",
    "coverage>=7.11",
    "isort>=7.0",
    "mypy>=1.18",
    "pre-commit>=4.3",
    "pytest>=8.4",
    "pytest-cov>=6.1",
    "rstcheck>=6.2",
    "ruff>=0.14.1",
    "sphinx>=8",
    "sphinx-rtd-theme>=3",
]

[project.optional-dependencies]
test = ["pytest>=8"]

[build-system]
requires = ["uv_build>=0.8.23,<0.9.0"]
build-backend = "uv_build"

[tool.mypy]
mypy_path = ["src/", "tests/"]
namespace_packages = true
no_implicit_optional = true
no_implicit_reexport = true
strict_equality = true
warn_redundant_casts = true
check_untyped_defs = true

[[tool.mypy.overrides]]
module = [
    "eventlet.*",
    "jwcrypto.*",
    "nameko.*",
    "werkzeug.*",
]
ignore_missing_imports = true

[tool.ruff.lint]
ignore = [
    "E501",
]
select = [
    "E",
    "F",
    "W",
]

[tool.tox]
env_list = ["check", "py310", "py311", "py312", "py313", "py314"]

[tool.tox.env_run_base]
runner = "uv-venv-lock-runner"
commands =[["uv", "run", "nameko", "test", "--cov", "-vv"]]

[tool.tox.env.check]
runner = "uv-venv-lock-runner"
commands = [
    ["uv", "run", "ruff", "check", "src", "tests"],
    ["uv", "run", "isort", "--check-only", "src", "tests"],
    ["uv", "run", "mypy", "src"],
]

[tool.tox.gh-actions]
python = """
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313
    3.14: py314, check
    """
