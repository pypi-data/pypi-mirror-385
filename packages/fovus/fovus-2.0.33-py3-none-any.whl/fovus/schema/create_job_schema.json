{
  "type": "object",
  "default": {},
  "title": "create-job schema",
  "required": [
    "timestamp",
    "workspaceId",
    "jobName",
    "environment",
    "constraints",
    "workload"
  ],
  "properties": {
    "timestamp": {
      "type": "string",
      "default": "",
      "title": "The timestamp Schema",
      "examples": ["1675478135542"],
      "description": "An autogenerated timestamp."
    },
    "debugMode": {
      "type": "boolean",
      "default": "false",
      "title": "The debugMode Schema",
      "examples": ["false"]
    },
    "pipelineId": {
      "type": "string",
      "default": "",
      "title": "The pipelineId Schema",
      "examples": ["p-1675478135542-testuser"]
    },
    "autoDeleteDays": {
      "type": "number",
      "default": "0",
      "title": "The autoDeleteDays Schema",
      "examples": ["30"]
    },
    "workspaceId": {
      "type": "string",
      "default": "",
      "title": "The workspaceId Schema",
      "examples": ["WorkspaceId"]
    },
    "jobName": {
      "type": "string",
      "default": "",
      "title": "The jobName Schema",
      "examples": ["My Job Name"]
    },
    "environment": {
      "type": "object",
      "default": {},
      "title": "The environment Schema",
      "oneOf": [
        {
          "required": ["containerized"]
        },
        {
          "required": ["monolithicList"]
        }
      ],
      "properties": {
        "containerized": {
          "type": "object",
          "default": {},
          "title": "The containerized Schema",
          "required": ["container", "version", "imagePath"],
          "properties": {
            "container": {
              "type": "string",
              "default": "",
              "title": "The container Schema",
              "examples": ["Apptainer"]
            },
            "version": {
              "type": "string",
              "default": "",
              "title": "The version Schema",
              "examples": ["1.3.4"]
            },
            "imagePath": {
              "type": "string",
              "default": "",
              "title": "The imagePath Schema",
              "examples": ["path/to/image"]
            },
            "dockerHubUsername": {
              "type": "string",
              "default": "",
              "title": "The dockerHubUsername Schema",
              "examples": ["username"]
            },
            "dockerHubPassword": {
              "type": "string",
              "default": "",
              "title": "The dockerHubPassword Schema",
              "examples": ["password"]
            }
          }
        },
        "monolithicList": {
          "type": "array",
          "default": [],
          "title": "The monolithicList Schema",
          "items": {
            "type": "object",
            "title": "A Schema",
            "required": ["softwareName", "softwareVersion"],
            "properties": {
              "vendorName": {
                "type": "string",
                "title": "The vendorName Schema",
                "examples": ["MSC", "MATLAB"]
              },
              "softwareName": {
                "type": "string",
                "title": "The softwareName Schema",
                "examples": ["Adams", "Matlab"]
              },
              "softwareVersion": {
                "type": "string",
                "title": "The softwareVersion Schema",
                "examples": ["2022.1", "2020"]
              },
              "licenseAddress": {
                "type": "string",
                "title": "The licenseAddress Schema",
                "examples": ["27500@0.0.0.0"]
              },
              "licenseName": {
                "type": "string",
                "title": "The licenseName Schema",
                "examples": ["Fovus-MSC"]
              },
              "licenseFeature": {
                "type": "string",
                "title": "The licenseFeature Schema",
                "examples": ["MSCONE", "Matlab"]
              },
              "licenseCountPerTask": {
                "type": "integer",
                "title": "The licenseCountPerTask Schema",
                "examples": [20, 10]
              },
              "allowWorkloadManagement": {
                "type": "boolean",
                "default": false,
                "title": "The allowWorkloadManagement Schema",
                "examples": [true, false],
                "description": "If true, the workload manager will be used for this job."
              }
            }
          }
        }
      },
      "examples": [
        {
          "containerized": {
            "container": "Apptainer",
            "version": "1.3.4",
            "imagePath": ""
          },
          "monolithicList": [
            {
              "vendorName": "MSC",
              "softwareName": "Adams",
              "softwareVersion": "2022.1",
              "licenseAddress": "27500@0.0.0.0",
              "licenseFeature": "MSCONE",
              "licenseCountPerTask": 20
            }
          ]
        }
      ]
    },
    "constraints": {
      "type": "object",
      "default": {},
      "title": "The constraints Schema",
      "required": ["jobConstraints", "taskConstraints"],
      "properties": {
        "jobConstraints": {
          "type": "object",
          "default": {},
          "title": "The jobConstraints Schema",
          "required": [
            "computingDevice",
            "supportedCpuArchitectures",
            "benchmarkingProfileName",
            "enableHyperthreading"
          ],
          "properties": {
            "computingDevice": {
              "type": "string",
              "enum": ["cpu", "cpu+gpu"],
              "default": "",
              "title": "The computingDevice Schema",
              "examples": ["cpu", "cpu+gpu"]
            },
            "supportedCpuArchitectures": {
              "type": "array",
              "default": [],
              "title": "The supportedCpuArchitectures Schema",
              "items": {
                "type": "string",
                "title": "A Schema",
                "examples": [["x86-64"], ["x86-64", "arm-64"]]
              }
            },
            "benchmarkingProfileName": {
              "type": "string",
              "default": "",
              "title": "The benchmarkingProfileName Schema",
              "examples": ["Default CPU"]
            },
            "isHybridStrategyAllowed": {
              "type": "boolean",
              "default": false,
              "title": "The isHybridStrategyAllowed Schema.",
              "examples": [false]
            },
            "enableHyperthreading": {
              "type": "boolean",
              "default": false,
              "title": "The enableHyperthreading Schema.",
              "examples": [false]
            },
            "benchmarkingProfileId": {
              "type": "string",
              "default": "",
              "title": "The benchmarkingProfileId Schema",
              "examples": ["default-cpu"]
            },
            "jobMaxClusterSizevCpu": {
              "type": "integer",
              "default": 0,
              "title": "the jobMaxClusterSizevCpu Schema",
              "examples": [0]
            },
            "isSubjectToLicenseAvailability": {
              "type": "boolean",
              "default": false,
              "title": "The isSubjectToLicenseAvailability Schema.",
              "examples": [false]
            }
          }
        },
        "taskConstraints": {
          "type": "object",
          "default": {},
          "title": "The taskConstraints Schema",
          "required": [
            "minvCpu",
            "maxvCpu",
            "minvCpuMemGiB",
            "minGpu",
            "maxGpu",
            "minGpuMemGiB",
            "storageGiB",
            "walltimeHours",
            "scalableParallelism",
            "parallelismOptimization"
          ],
          "properties": {
            "minvCpu": {
              "type": "integer",
              "default": 0,
              "title": "The minvCpu Schema",
              "examples": [10]
            },
            "maxvCpu": {
              "type": "integer",
              "default": 9999,
              "title": "The maxvCpu Schema",
              "examples": [10]
            },
            "minvCpuMemGiB": {
              "type": "number",
              "default": 0,
              "title": "The minvCpuMemGiB Schema",
              "examples": [1]
            },
            "minGpu": {
              "type": "integer",
              "default": 0,
              "title": "The minGpu Schema",
              "examples": [0]
            },
            "maxGpu": {
              "type": "integer",
              "default": 9999,
              "title": "The maxGpu Schema",
              "examples": [10]
            },
            "minGpuMemGiB": {
              "type": "number",
              "default": 0,
              "title": "The minGpuMemGiB Schema",
              "examples": [0]
            },
            "storageGiB": {
              "type": "integer",
              "default": 0,
              "title": "The storageGiB Schema",
              "examples": [1]
            },
            "walltimeHours": {
              "type": "number",
              "default": 0,
              "title": "The walltimeHours Schema",
              "examples": [1]
            },
            "scalableParallelism": {
              "type": "boolean",
              "default": false,
              "title": "The scalableParallelism Schema. Must match benchmarking profile or will be overwritten by benchmarking profile.",
              "examples": [false]
            },
            "parallelismOptimization": {
              "type": "boolean",
              "default": false,
              "title": "The parallelismOptimization Schema. Must match benchmarking profile or will be overwritten by benchmarking profile.",
              "examples": [true]
            }
          }
        }
      }
    },
    "objective": {
      "type": "object",
      "default": {},
      "title": "The objective Schema",
      "properties": {
        "timeToCostPriorityRatio": {
          "type": "string",
          "default": "0.5/0.5",
          "title": "The timeToCostPriorityRatio Schema",
          "examples": ["0.9/0.1"]
        }
      }
    },
    "workload": {
      "type": "object",
      "default": {},
      "title": "The workload Schema",
      "required": [
        "parallelismConfigFiles",
        "runCommand",
        "outputFileOption",
        "outputFileList"
      ],
      "properties": {
        "remoteInputsForAllTasks": {
          "type": "array",
          "default": [],
          "title": "The remoteInputsForAllTasks Schema",
          "items": {
            "type": "string",
            "default": "",
            "title": "A Schema",
            "examples": ["abc/def.txt"]
          },
          "examples": [
            ["abc/def.txt"],
            ["https://app.fovus.co/files?path=abc/def.txt"]
          ]
        },
        "parallelismConfigFiles": {
          "type": "array",
          "default": [],
          "title": "The parallelismConfigFiles Schema",
          "items": {
            "type": "string",
            "default": "",
            "title": "A Schema",
            "examples": ["*"]
          },
          "examples": [["*"], ["config*/*.adm", "input/*.config"]]
        },
        "runCommand": {
          "type": "string",
          "default": "",
          "title": "The runCommand Schema",
          "examples": ["./runAdams.sh"]
        },
        "outputFileOption": {
          "type": "string",
          "default": "",
          "title": "The outputFileOption Schema",
          "examples": ["include"]
        },
        "outputFileList": {
          "type": "array",
          "default": [],
          "title": "The outputFileList Schema",
          "items": {
            "type": "string",
            "default": "",
            "title": "A Schema",
            "examples": ["*"]
          },
          "examples": [["*"], ["output1/*.txt", "output2/log/*.log"]]
        }
      }
    },
    "keywordSearchInput": {
      "type": "object",
      "default": {},
      "title": "The keywordSearchInput Schema",
      "required": ["keywords", "targetOutputFiles"],
      "properties": {
        "keywords": {
          "type": "array",
          "default": [],
          "title": "The keywords Schema",
          "items": {
            "type": "string",
            "minLength": 1,
            "title": "Keyword schema",
            "examples": ["keyword1", "keyword2"]
          }
        },
        "targetOutputFiles": {
          "type": "array",
          "default": [],
          "title": "The targetOutputFiles Schema",
          "items": {
            "type": "string",
            "minLength": 1,
            "title": "Keyword search file schema",
            "examples": ["*"]
          }
        },
        "isRetryIfMatchedEnabled": {
          "type": "boolean",
          "default": false,
          "title": "The isRetryIfMatchedEnabled Schema",
          "examples": [true, false]
        },
        "maxRetryAttempts": {
          "type": "integer",
          "default": 15,
          "minimum": 1,
          "maximum": 100,
          "title": "The maxRetryAttempts Schema",
          "examples": [15, 10]
        }
      }
    }
  }
}
