"use strict";(self.webpackChunk_amzn_sagemaker_post_startup_notification_plugin=self.webpackChunk_amzn_sagemaker_post_startup_notification_plugin||[]).push([[24],{24:(t,i,e)=>{e.r(i),e.d(i,{default:()=>h});var s=e(273),a=e(296),n=e(23);const o=[200,201];var r;!function(t){t.POST="POST",t.GET="GET",t.PUT="PUT"}(r||(r={}));class c extends Error{constructor(t,i,e,s){super(t),this.errorStatus=i,this.errorCode=e,this.cause=s,Object.setPrototypeOf(this,c.prototype)}}var u,l=e(794);!function(t){t.INFO="info",t.IN_PROGRESS="in-progress",t.SUCCESS="success",t.WARNING="warning",t.ERROR="error",t.DEFAULT="default"}(u||(u={}));class d{constructor(){this.inProgressNotificationId=void 0}hasUserSeen(t){return"true"===localStorage.getItem(`notification_seen_${t}`)}markAsSeen(t){localStorage.setItem(`notification_seen_${t}`,"true")}async initialize(){const t=await this.getPostStartupStatus();(null==t?void 0:t.status)&&"success"!==t.status&&(this.dispatchNotification(t),this.isTerminalStatus(t.status)||this.pollStartupStatus()),this.showCustomNotificationIfNeeded()}showCustomNotificationIfNeeded(){const t="smus_q_cli_notification";if(!this.hasUserSeen(t)){const i=[{label:"Learn More",callback:()=>{this.markAsSeen(t),window.open("https://docs.aws.amazon.com/sagemaker-unified-studio/latest/userguide/q-actions.html","_blank")}}];l.Notification.emit("The Amazon Q Command Line Interface (CLI) is installed. You can now access AI-powered assistance in your terminal.",u.INFO,{actions:i,autoClose:!1}),setTimeout((()=>this.markAsSeen(t)),100)}}async getPostStartupStatus(){try{const t=await(async(t,i)=>{var e,s;const r=a.ServerConnection.makeSettings({}),u=n.URLExt.join(r.baseUrl,"/api/poststartup"),l={method:i},d=await a.ServerConnection.makeRequest(u,l,r);if(!o.includes(d.status)){const t=await d.json(),i=null!==(e=t.errorCode)&&void 0!==e?e:void 0,a=null!==(s=t.errorMessage)&&void 0!==s?s:"unable to fetch data";throw new c(a,d.status,i)}return d})(0,r.GET);return await t.json()}catch(t){return void this.dispatchNotification({status:u.ERROR,message:"Failed to fetch post-startup status."})}}pollStartupStatus(t=3e5,i=2e3){const e=setInterval((async()=>{const t=await this.getPostStartupStatus();(null==t?void 0:t.status)&&this.isTerminalStatus(null==t?void 0:t.status)&&(this.dispatchNotification(t),clearInterval(e),clearTimeout(s))}),i),s=setTimeout((()=>{clearInterval(e),this.clearInProgressNotification(),this.dispatchNotification({status:u.INFO,message:"IDE configuration is still running. Refresh the page to retry and contact your administrator if configuration fails to complete."})}),t)}dispatchNotification(t){const{message:i,status:e,link:s,label:a}=t;this.isTerminalStatus(e)&&this.inProgressNotificationId&&this.clearInProgressNotification();const n=l.Notification.emit(i,e,{actions:t.link?[{label:null!=a?a:"Learn more",callback:()=>window.open(s,"_blank")}]:void 0,autoClose:e===u.SUCCESS&&5e3});e===u.IN_PROGRESS&&(this.inProgressNotificationId=n)}clearInProgressNotification(){l.Notification.dismiss(this.inProgressNotificationId)}isTerminalStatus(t){return[u.SUCCESS,u.ERROR].includes(t)}}const p="Terminal with Q",h=[{id:"@amzn/sagemaker-post-startup-notification-plugin:plugin",description:"A JupyterLab extension.",autoStart:!0,activate:t=>{console.log("JupyterLab extension sagemaker-post-startup-notification-plugin is activated!"),t.restored.then((async()=>{const t=new d;await t.initialize()}))}},{id:"@amzn/sagemaker-post-startup-notification-plugin:custom-terminal-launcher-plugin",autoStart:!0,requires:[s.ILauncher],activate:(t,i)=>{const e=()=>{try{const t=document.querySelectorAll('.jp-LauncherCard-label[title="Start a new terminal session"] p');t.length>0&&t.forEach((t=>{t.innerHTML!==p&&(t.innerHTML=p)}))}catch(t){}},s=()=>{e();const t=new MutationObserver((t=>{(t=>{var i,e;for(const s of t){if(s.addedNodes.length>0)return!0;if("attributes"===s.type){const t=s.target;if((null===(i=t.classList)||void 0===i?void 0:i.contains("jp-Launcher"))||(null===(e=t.classList)||void 0===e?void 0:e.contains("jp-LauncherCard")))return!0}}return!1})(t)&&e()})),i=document.querySelector("#jp-main-dock-panel")||document.body;t.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["title"]})};console.log("JupyterLab extension sagemaker-post-startup-notification-custom-terminal-launcher-plugin is running"),t.restored.then((()=>{setTimeout(s,2e3)}))}}]}}]);