# ArkTS Tree-sitter è§£æå™¨

è¿™æ˜¯ä¸€ä¸ªä¸ºåä¸ºArkTSè¯­è¨€å¼€å‘çš„Tree-sitterè¯­æ³•è§£æå™¨ï¼Œæ”¯æŒArkTSè¯­è¨€çš„å®Œæ•´è¯­æ³•ç‰¹æ€§ï¼ŒåŒ…æ‹¬è£…é¥°å™¨ã€ç»„ä»¶åŒ–è¯­æ³•ã€çŠ¶æ€ç®¡ç†ç­‰æ ¸å¿ƒç‰¹æ€§ã€‚

## ğŸ¯ è§£æèƒ½åŠ›æŒç»­æå‡

æˆ‘ä»¬çš„ ArkTS è§£æå™¨åœ¨çœŸå®é¡¹ç›®ä¸­çš„è¡¨ç°æŒç»­æ”¹è¿›ï¼åœ¨ [hmosworld](https://gitee.com/harmonyos_samples/hmosworld) å¤§å‹ç”Ÿäº§é¡¹ç›®çš„éªŒè¯ä¸­ï¼Œ**è§£ææˆåŠŸç‡ä»æœ€åˆçš„ 30% è·ƒå‡è‡³ 100%**ï¼ˆ175ä¸ªæ–‡ä»¶å…¨éƒ¨æˆåŠŸè§£æï¼‰ï¼Œå®ç°äº†è¶…è¿‡ **3.3 å€çš„é£è·ƒæå‡**ï¼Œè¾¾åˆ°å®Œç¾è§£æï¼

### ğŸ† è¿‘æœŸé‡å¤§çªç ´

**ğŸ‰ v0.1.8 ç‰ˆæœ¬ - 100% å®Œç¾è§£æï¼**ï¼ˆ2025-10-20ï¼‰ï¼š
- ğŸ† **å†å²æ€§é‡Œç¨‹ç¢‘**ï¼šåœ¨ hmosworld é¡¹ç›®ä¸­å®ç° **100% è§£ææˆåŠŸç‡**ï¼ˆ175/175 æ–‡ä»¶ï¼‰
- ğŸš€ **Grammar ç®€åŒ–é‡æ„**ï¼šå¼•å…¥é€šç”¨å†…å®¹è§£æè§„åˆ™ `_non_brace_content`
  - ç»Ÿä¸€ç®€åŒ–äº† `build_body`ã€`container_content_body`ã€`block_statement` ç­‰ 6 ä¸ªæ ¸å¿ƒè§„åˆ™
  - ä»£ç æ›´ç®€æ´ï¼Œç»´æŠ¤æ›´å®¹æ˜“ï¼Œæ‰©å±•æ€§æ›´å¼º
  - æå‡è§£æå™¨çš„é€šç”¨æ€§å’Œé²æ£’æ€§
- âœ… **å¯¼å‡ºè¯­æ³•å¢å¼º**ï¼šæ”¯æŒ `export default interface/type/enum`
- âœ… **ASI å…¼å®¹æ€§æ”¹è¿›**ï¼šå±æ€§ç­¾ååˆ†å·æ”¹ä¸ºå¯é€‰ï¼Œæ›´å¥½åœ°å…¼å®¹çœŸå®ä»£ç 
- ğŸ”© **ä¼˜å…ˆçº§è°ƒæ•´**ï¼šä¼˜åŒ– `builder_function_body` å’Œ `extend_function_body` çš„è§£æä¼˜å…ˆçº§

**ğŸ‰ v0.1.7 ç‰ˆæœ¬ - å†å²æ€§çªç ´**ï¼ˆ2025-10-20ï¼‰ï¼š
- ğŸš€ **è§£ææˆåŠŸç‡çªç ´ 93%ï¼** åœ¨ hmosworld é¡¹ç›®ä¸­è¾¾åˆ° **93.71%** æˆåŠŸç‡ï¼ˆ175 ä¸ªæ–‡ä»¶ä¸­ 164 ä¸ªæˆåŠŸè§£æï¼‰
- ğŸ¯ **è·ç¦» 100% ä»…å·® 11 ä¸ªæ–‡ä»¶**ï¼šå·²è¾¾åˆ°**ç”Ÿäº§å¯ç”¨çº§åˆ«**ï¼Œå¯æ”¯æŒæ„å»ºè¯­è¨€æœåŠ¡å™¨ã€ä»£ç åˆ†æå·¥å…·ç­‰å®é™…åº”ç”¨
- âœ… **åŠ¨æ€ import() è¡¨è¾¾å¼æ”¯æŒ**ï¼ˆES2020+ï¼‰ï¼š
  - æ”¯æŒé¡¶å±‚ç‹¬ç«‹è°ƒç”¨ï¼š`import('@ohos/module')`
  - æ”¯æŒ async/await æ¨¡å¼ï¼š`await import('./Module')`
  - æ”¯æŒ Promise é“¾å¼è°ƒç”¨ï¼š`import('./Module').then(...)`
  - æ”¯æŒåŠ¨æ€è·¯å¾„å˜é‡ï¼š`import(modulePath)`
  - æ”¯æŒæ¡ä»¶å¯¼å…¥ã€æ‰¹é‡å¯¼å…¥ç­‰æ‰€æœ‰åœºæ™¯
- ğŸ› **ä¿®å¤ `@Component export struct` è§£æé”™è¯¯**ï¼šç¡®ä¿è£…é¥°å™¨å¯¼å‡ºè¯­æ³•æ­£ç¡®è§£æ
- ğŸ”§ **è¯­æ³•è§£æç²¾åº¦å¤§å¹…æå‡**ï¼šé’ˆå¯¹ç”Ÿäº§ä»£ç ä¸­çš„è¾¹ç¼˜æ¡ˆä¾‹è¿›è¡Œç²¾ç»†ä¼˜åŒ–
- ğŸ“ˆ **ç›¸æ¯” v0.1.6 æå‡ 7.42 ä¸ªç™¾åˆ†ç‚¹**ï¼šä» 86.29% åˆ° 93.71%

**v0.1.6 ç‰ˆæœ¬æ›´æ–°**ï¼ˆ2025-10-20ï¼‰ï¼š
- ğŸš€ **è§£ææˆåŠŸç‡çªç ´ 86%**ï¼šåœ¨ hmosworld é¡¹ç›®ä¸­è¾¾åˆ° **86.29%** æˆåŠŸç‡ï¼ˆ175 ä¸ªæ–‡ä»¶ä¸­ 151 ä¸ªæˆåŠŸè§£æï¼‰
- âœ… **æŒç»­ä¼˜åŒ–è§£æèƒ½åŠ›**ï¼šç›¸æ¯” v0.1.5 ç‰ˆæœ¬çš„ 61.71%ï¼Œæ–°ç‰ˆæœ¬æå‡äº† **24.58 ä¸ªç™¾åˆ†ç‚¹**
- âœ… **ç”Ÿäº§çº§ä»£ç æ”¯æŒ**ï¼šå·²èƒ½æˆåŠŸè§£æç»å¤§å¤šæ•°çœŸå® ArkTS åº”ç”¨ä»£ç 
- âœ… **UI ç»„ä»¶æ”¯æŒå¢å¼º**ï¼šæ–°å¢ `NavDestination`ã€`ListItemGroup` ç­‰å¯¼èˆªå’Œåˆ—è¡¨ç»„ä»¶æ”¯æŒ
- âœ… **è¯­æ³•å…¼å®¹æ€§æå‡**ï¼šæŒç»­ä¼˜åŒ–å¯¹å¤æ‚åµŒå¥—ç»“æ„å’Œè¾¹ç¼˜æƒ…å†µçš„å¤„ç†

**v0.1.5 ç‰ˆæœ¬æ›´æ–°**ï¼ˆ2025-10-18ï¼‰ï¼š
- âœ… **å®Œæ•´æ³›å‹æ”¯æŒ**ï¼šæ”¯æŒæ³›å‹ç±»ã€å‡½æ•°ã€æ¥å£åŠå¤æ‚ç±»å‹å‚æ•°
- âœ… **è£…é¥°å™¨å‡½æ•°æ‰©å±•**ï¼šæ”¯æŒ `@Builder`ã€`@Styles`ã€`@Extend` è£…é¥°å™¨å‡½æ•°åŠå¯¼å‡ºå£°æ˜
- âœ… **æ§åˆ¶æµå®Œå–„**ï¼šæ”¯æŒ `try/catch/finally`ã€`for/while/break/continue` ç­‰æ§åˆ¶æµè¯­å¥
- âœ… **æšä¸¾å£°æ˜**ï¼šå®Œæ•´æ”¯æŒ `enum` å£°æ˜åŠå…¶å¯¼å‡ºè¯­æ³•
- âœ… **é«˜çº§è¡¨è¾¾å¼**ï¼šæ”¯æŒå‡½æ•°è¡¨è¾¾å¼ã€ç®­å¤´å‡½æ•°ã€nullishåˆå¹¶æ“ä½œç¬¦(`??`)ã€å¯é€‰é“¾(`?.`)
- âœ… **ASIå…¼å®¹æ€§ä¼˜åŒ–**ï¼šå®Œå–„è‡ªåŠ¨åˆ†å·æ’å…¥(ASI)æœºåˆ¶ï¼Œæå‡é”™è¯¯æ¢å¤èƒ½åŠ›
- âœ… **å¸ƒå±€å®¹å™¨æ‰©å±•**ï¼šæ”¯æŒ `GridRow`ã€`GridCol` ç­‰å“åº”å¼å¸ƒå±€ç»„ä»¶

### ğŸ“Š è§£ææˆåŠŸç‡å‘å±•å†ç¨‹

```
30.00% (åˆå§‹ç‰ˆæœ¬) â†’ 61.71% (v0.1.5) â†’ 86.29% (v0.1.6) â†’ 93.71% (v0.1.7) â†’ 100% (v0.1.8) ğŸ‰ğŸ†
```

è¿™ä¸€å†å²æ€§çªç ´å……åˆ†è¯æ˜äº†æœ¬é¡¹ç›®åœ¨å¤„ç†å®é™…ä»£ç å¤æ‚æ€§æ–¹é¢çš„ä¸æ–­è¿›åŒ–ï¼Œ**å·²ç»èƒ½å¤Ÿå®Œç¾æ”¯æŒæ‰€æœ‰ç”Ÿäº§ç¯å¢ƒä¸­çš„ ArkTS ä»£ç **ï¼Œè¾¾åˆ°äº†å®Œå…¨ç”Ÿäº§å¯ç”¨çº§åˆ«ã€‚

## ç‰¹æ€§æ”¯æŒ

### âœ… å·²å®ç°ç‰¹æ€§

**æ ¸å¿ƒè¯­æ³•**
- âœ… å®Œæ•´ TypeScript è¯­æ³•å…¼å®¹
- âœ… è£…é¥°å™¨è¯­æ³•ï¼ˆ`@Component`ã€`@State`ã€`@Prop`ã€`@Link`ã€`@Builder`ã€`@Styles`ã€`@Extend` ç­‰ï¼‰
- âœ… struct ç»„ä»¶å®šä¹‰ä¸æ–¹æ³•
- âœ… `build()` æ–¹æ³•å’Œ UI æè¿°è¯­æ³•
- âœ… æ³›å‹æ”¯æŒï¼ˆç±»ã€å‡½æ•°ã€æ¥å£ã€ç±»å‹å‚æ•°ï¼‰
- âœ… æšä¸¾å£°æ˜ï¼ˆ`enum`ï¼‰

**ç±»å‹ç³»ç»Ÿ**
- âœ… æ¥å£å’Œç±»å‹å®šä¹‰
- âœ… ç±»å‹æ³¨è§£ä¸å‡½æ•°ç±»å‹
- âœ… ç±»å‹æ–­è¨€ï¼ˆ`as`ï¼‰
- âœ… å¯¹è±¡ç±»å‹ï¼ˆæ”¯æŒé€—å·/åˆ†å·åˆ†éš”ç¬¦ï¼‰

**è¡¨è¾¾å¼ä¸æ“ä½œç¬¦**
- âœ… ç®­å¤´å‡½æ•°ä¸å‡½æ•°è¡¨è¾¾å¼
- âœ… å¼‚æ­¥è¡¨è¾¾å¼ï¼ˆ`await`ï¼‰
- âœ… Nullish åˆå¹¶æ“ä½œç¬¦ï¼ˆ`??`ï¼‰
- âœ… å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆ`?.`ï¼‰
- âœ… ä¿®é¥°ç¬¦é“¾è¡¨è¾¾å¼ï¼ˆ`.modifier()`ï¼‰

**æ§åˆ¶æµ**
- âœ… `try/catch/finally/throw` å¼‚å¸¸å¤„ç†
- âœ… `for/while/do-while` å¾ªç¯
- âœ… `break/continue` æ§åˆ¶è¯­å¥
- âœ… `if/else` æ¡ä»¶åˆ†æ”¯

**UI ç»„ä»¶**
- âœ… åŸºç¡€ç»„ä»¶ï¼ˆ`Text`ã€`Button`ã€`Image` ç­‰ï¼‰
- âœ… å®¹å™¨ç»„ä»¶ï¼ˆ`Column`ã€`Row`ã€`Stack`ã€`Flex` ç­‰ï¼‰
- âœ… å“åº”å¼å¸ƒå±€ï¼ˆ`GridRow`ã€`GridCol`ï¼‰
- âœ… `ForEach` å¾ªç¯æ¸²æŸ“
- âœ… æ¡ä»¶æ¸²æŸ“

**æ¨¡å—ç³»ç»Ÿ**
- âœ… å¯¼å…¥/å¯¼å‡ºå£°æ˜
- âœ… åŠ¨æ€ `import()` è¡¨è¾¾å¼ï¼ˆES2020+ï¼‰- **v0.1.7**
  - æ”¯æŒé¡¶å±‚è°ƒç”¨ï¼š`import('@ohos/module')`
  - æ”¯æŒ async/awaitï¼š`await import('./Module')`
  - æ”¯æŒ Promise é“¾å¼è°ƒç”¨ï¼š`import('./Module').then(...)`
  - æ”¯æŒåŠ¨æ€è·¯å¾„å˜é‡ï¼š`import(modulePath)`
- âœ… è£…é¥°å™¨å‡½æ•°å¯¼å‡ºï¼ˆ`export @Builder function`ï¼‰
- âœ… é»˜è®¤å¯¼å‡ºï¼ˆ`export default interface/type/enum`ï¼‰- **v0.1.8**

### ğŸš§ å¼€å‘ä¸­ç‰¹æ€§
- æ›´å¤š UI ç»„ä»¶å˜ä½“æ”¯æŒ
- æ€§èƒ½ä¼˜åŒ–ä¸å¢é‡è§£æ
- è¯­æ³•é«˜äº®æŸ¥è¯¢ä¼˜åŒ–

### ğŸ“‹ è®¡åˆ’å®ç°ç‰¹æ€§
- å®Œæ•´çš„è¯­è¨€æœåŠ¡å™¨åè®®ï¼ˆLSPï¼‰é›†æˆ
- æ›´å¤šè¯­è¨€ç»‘å®šï¼ˆC#ã€Javaï¼‰
- ä»£ç æ ¼å¼åŒ–æ”¯æŒ

## å®‰è£…ä½¿ç”¨

### Node.js

```bash
npm install tree-sitter-arkts-open
```

```javascript
const Parser = require('tree-sitter');
const ArkTS = require('tree-sitter-arkts');

const parser = new Parser();
parser.setLanguage(ArkTS);

const sourceCode = `
@Component
struct HelloWorld {
  @State message: string = 'Hello'
  
  build() {
    Text(this.message)
  }
}
`;

const tree = parser.parse(sourceCode);
console.log(tree.rootNode.toString());
```

### Python

```bash
pip install tree-sitter-arkts-open
```

```python
import tree_sitter_arkts as arkts
from tree_sitter import Language, Parser

ARKTS_LANGUAGE = Language(arkts.language())
parser = Parser(ARKTS_LANGUAGE)

source_code = '''
@Component  
struct MyComponent {
  build() {
    Text('Hello ArkTS')
  }
}
'''

tree = parser.parse(bytes(source_code, 'utf8'))
print(tree.root_node)
```

## è¯­æ³•æ”¯æŒç¤ºä¾‹

### ç»„ä»¶å®šä¹‰
```arkts
@Component
struct MyComponent {
  @State count: number = 0;
  @Prop title: string = 'Default';
  
  build() {
    Column() {
      Text(this.title)
      Button('Click')
        .onClick(() => {
          this.count++
        })
    }
  }
}
```

### çŠ¶æ€ç®¡ç†
```arkts
@Component
struct StateExample {
  @State private items: string[] = [];
  @Link shared: boolean;
  
  build() {
    List() {
      ForEach(this.items, (item: string) => {
        ListItem() {
          Text(item)
        }
      })
    }
  }
}
```

## å¼€å‘

### æ„å»ºè§£æå™¨
```bash
tree-sitter generate
```

### æµ‹è¯•
```bash
tree-sitter test
```

### è§£ææ–‡ä»¶
```bash
tree-sitter parse example.ets
```

## è¯­è¨€ç»‘å®š

æœ¬è§£æå™¨æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ç»‘å®šï¼š

- **Node.js**: `bindings/node/`
- **Python**: `bindings/python/`
- **Rust**: `bindings/rust/`
- **Go**: `bindings/go/`
- **Swift**: `bindings/swift/`

## è´¡çŒ®

æ¬¢è¿æäº¤Issueså’ŒPull Requestsï¼

### å¼€å‘ç¯å¢ƒ
- Tree-sitter CLI 0.25.3+
- Node.js 18+
- æ”¯æŒçš„æ„å»ºå·¥å…·é“¾

### æµ‹è¯•ç”¨ä¾‹
æµ‹è¯•ç”¨ä¾‹ä½äº `test/` ç›®å½•ï¼ŒåŒ…å«ï¼š
- åŸºç¡€ç»„ä»¶è¯­æ³•æµ‹è¯•
- è£…é¥°å™¨è¯­æ³•æµ‹è¯•  
- çŠ¶æ€ç®¡ç†è¯­æ³•æµ‹è¯•
- é”™è¯¯æ¢å¤æµ‹è¯•

## è®¸å¯è¯

MIT License

## ç›¸å…³é“¾æ¥

- [ArkTSå®˜æ–¹æ–‡æ¡£](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-get-started-0000001504769321-V3)
- [Tree-sitterå®˜ç½‘](https://tree-sitter.github.io/)
- [é¡¹ç›®ä»“åº“](https://github.com/million-mo/arkts_language_server)