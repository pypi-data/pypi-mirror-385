# QCC v0.5.1 发布说明

**发布日期**: 2025-10-18
**类型**: Bug 修复版本
**重要性**: 🔴 关键更新（v0.5.0 用户必须升级）

## 🐛 Bug 修复

### 修复 Web UI 静态文件打包问题

这是一个**关键bug修复**，解决了 v0.5.0 中 Web UI 无法在通过 PyPI 安装时正常启动的问题。

#### 问题描述

**症状**:
```bash
uvx qcc web start

❌ 前端目录不存在，请确认项目结构
已尝试查找位置:
  - /Users/xxx/.cache/uv/archive-v0/.../qcc-web
  - /Users/xxx/.claude/qcc-web
```

**根本原因**:
- Web UI 的静态文件（HTML、CSS、JS）没有被正确打包到 PyPI 发布的包中
- `pyproject.toml` 配置不完整，缺少静态文件包含规则
- 缺少 `MANIFEST.in` 文件

**影响范围**:
- v0.5.0 版本通过 `uvx` 或 `pip` 安装后无法使用 Web UI 功能
- 仅影响 Web UI，代理服务器等其他功能正常工作

#### 修复方案

**文件**: `pyproject.toml`, `MANIFEST.in`

**修改内容**:

1. **更新 pyproject.toml** - 添加静态文件包含规则
```toml
[tool.hatch.build.targets.wheel.force-include]
"fastcc/web/static" = "fastcc/web/static"
```

2. **新增 MANIFEST.in** - 确保源码分发包含静态文件
```
include README.md
include LICENSE
recursive-include fastcc/web/static *
```

#### 验证

修复后，Web UI 可以正常启动：

```bash
# 测试安装
uvx qcc web start

# 预期输出:
# ==================================================
# 🚀 QCC Web UI
# ==================================================
# ℹ️ 启动生产模式
# --------------------------------------------------
# ✅ 后端 API 服务器已启动
# ✅ 前端静态文件服务已就绪
#
# 🌐 访问地址:
#    http://127.0.0.1:8080
# 📚 API 文档:
#    http://127.0.0.1:8080/api/docs
```

## 📝 详细修改

### 修改的文件

1. **pyproject.toml**
   - 添加 `[tool.hatch.build.targets.wheel.force-include]` 配置
   - 确保静态文件被包含在 wheel 包中

2. **MANIFEST.in**（新增）
   - 确保静态文件被包含在源码分发包中
   - 包含 README 和 LICENSE 文件

3. **fastcc/__init__.py**
   - 版本号更新至 0.5.1

### 包含的静态文件

```
fastcc/web/static/
├── index.html              # Web UI 主页面
├── vite.svg               # 图标
└── assets/                # 前端资源
    ├── index-*.js         # JavaScript 文件（9个）
    └── index-*.css        # 样式文件（1个）
```

## 🔄 向后兼容性

✅ **完全兼容**:
- 所有 v0.5.0 的功能保持不变
- 仅修复了打包问题
- 无需修改配置或代码

## 📦 升级方式

### 从 v0.5.0 升级（必须）

```bash
# 使用 uvx
uvx qcc --version
# 应显示 0.5.1

# 使用 pip
pip install --upgrade qcc
qcc --version
```

### 验证安装

```bash
# 1. 检查版本
uvx qcc --version
# 输出: qcc version 0.5.1

# 2. 启动 Web UI
uvx qcc web start

# 3. 在浏览器访问
# http://127.0.0.1:8080
```

## 🎯 受影响的功能

### 直接修复
- ✅ Web UI 启动功能
- ✅ 静态文件服务
- ✅ 前端界面访问

### 未受影响（v0.5.0 已正常）
- ✅ 代理服务器功能
- ✅ CLI 命令
- ✅ 配置管理
- ✅ Endpoint 管理
- ✅ 健康监控

## 🚀 快速体验

```bash
# 安装/升级到 v0.5.1
uvx qcc web start

# 或
pip install --upgrade qcc
qcc web start
```

访问: http://127.0.0.1:8080

## 📊 包大小

- **Wheel**: ~4.2 MB（增加了约 400KB 静态文件）
- **Source**: ~20.2 MB

## 🙏 致谢

感谢用户报告此问题！

## 📅 后续计划

### v0.6.0（规划中）
- [ ] Web UI 性能优化
- [ ] 用户认证
- [ ] 高级监控功能
- [ ] 多语言支持

---

**安装命令**:
```bash
uvx qcc
# 或
pip install --upgrade qcc
```

**快速体验 Web UI**:
```bash
uvx qcc web start
```

**完整文档**: [README.md](../../README.md)
