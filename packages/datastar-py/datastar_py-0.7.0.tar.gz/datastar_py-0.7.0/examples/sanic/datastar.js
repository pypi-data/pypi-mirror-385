// Datastar v1.0.0-RC.6
var it=/ðŸ–•JS_DSðŸš€/.source,$e=it.slice(0,5),qe=it.slice(4),G="datastar-fetch",z="datastar-signal-patch";var pe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").toLowerCase();var ot=e=>pe(e).replace(/-/g,"_");var ne=e=>{try{return JSON.parse(e)}catch{return Function(`return (${e})`)()}},at={camel:e=>e.replace(/-[a-z]/g,t=>t[1].toUpperCase()),snake:e=>e.replace(/-/g,"_"),pascal:e=>e[0].toUpperCase()+at.camel(e.slice(1))},w=(e,t,n="camel")=>{for(let r of t.get("case")||[n])e=at[r]?.(e)||e;return e},Q=e=>`data-${e}`;var k=Object.hasOwn??Object.prototype.hasOwnProperty.call;var re=e=>e!==null&&typeof e=="object"&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null),ct=e=>{for(let t in e)if(k(e,t))return!1;return!0},Z=(e,t)=>{for(let n in e){let r=e[n];re(r)||Array.isArray(r)?Z(r,t):e[n]=t(r)}},Re=e=>{let t={};for(let[n,r]of e){let s=n.split("."),i=s.pop(),a=s.reduce((o,c)=>o[c]??={},t);a[i]=r}return t};var we=[],Ge=[],Ce=0,Me=0,je=0,Be,j,xe=0,M=()=>{Ce++},x=()=>{--Ce||(ut(),Y())},$=e=>{Be=j,j=e},q=()=>{j=Be,Be=void 0},ge=e=>Gt.bind(0,{previousValue:e,t:e,e:1}),We=Symbol("computed"),Pe=e=>{let t=jt.bind(0,{e:17,getter:e});return t[We]=1,t},b=e=>{let t={d:e,e:2};j&&Je(t,j),$(t),M();try{t.d()}finally{x(),q()}return gt.bind(0,t)},ut=()=>{for(;Me<je;){let e=Ge[Me];Ge[Me++]=void 0,pt(e,e.e&=-65)}Me=0,je=0},lt=e=>"getter"in e?dt(e):mt(e,e.t),dt=e=>{$(e),ht(e);try{let t=e.t;return t!==(e.t=e.getter(t))}finally{q(),yt(e)}},mt=(e,t)=>(e.e=1,e.previousValue!==(e.previousValue=t)),Ue=e=>{let t=e.e;if(!(t&64)){e.e=t|64;let n=e.r;n?Ue(n.o):Ge[je++]=e}},pt=(e,t)=>{if(t&16||t&32&&bt(e.s,e)){$(e),ht(e),M();try{e.d()}finally{x(),q(),yt(e)}return}t&32&&(e.e=t&-33);let n=e.s;for(;n;){let r=n.c,s=r.e;s&64&&pt(r,r.e=s&-65),n=n.i}},Gt=(e,...t)=>{if(t.length){if(e.t!==(e.t=t[0])){e.e=17;let r=e.r;return r&&(Bt(r),Ce||ut()),!0}return!1}let n=e.t;if(e.e&16&&mt(e,n)){let r=e.r;r&&Ne(r)}return j&&Je(e,j),n},jt=e=>{let t=e.e;if(t&16||t&32&&bt(e.s,e)){if(dt(e)){let n=e.r;n&&Ne(n)}}else t&32&&(e.e=t&-33);return j&&Je(e,j),e.t},gt=e=>{let t=e.s;for(;t;)t=Fe(t,e);let n=e.r;n&&Fe(n),e.e=0},Je=(e,t)=>{let n=t.a;if(n&&n.c===e)return;let r=n?n.i:t.s;if(r&&r.c===e){r.m=xe,t.a=r;return}let s=e.p;if(s&&s.m===xe&&s.o===t)return;let i=t.a=e.p={m:xe,c:e,o:t,l:n,i:r,f:s};r&&(r.l=i),n?n.i=i:t.s=i,s?s.n=i:e.r=i},Fe=(e,t=e.o)=>{let n=e.c,r=e.l,s=e.i,i=e.n,a=e.f;if(s?s.l=r:t.a=r,r?r.i=s:t.s=s,i?i.f=a:n.p=a,a)a.n=i;else if(!(n.r=i))if("getter"in n){let o=n.s;if(o){n.e=17;do o=Fe(o,n);while(o)}}else"previousValue"in n||gt(n);return s},Bt=e=>{let t=e.n,n;e:for(;;){let r=e.o,s=r.e;if(s&60?s&12?s&4?!(s&48)&&Wt(e,r)?(r.e=s|40,s&=1):s=0:r.e=s&-9|32:s=0:r.e=s|32,s&2&&Ue(r),s&1){let i=r.r;if(i){let a=(e=i).n;a&&(n={t,u:n},t=a);continue}}if(e=t){t=e.n;continue}for(;n;)if(e=n.t,n=n.u,e){t=e.n;continue e}break}},ht=e=>{xe++,e.a=void 0,e.e=e.e&-57|4},yt=e=>{let t=e.a,n=t?t.i:e.s;for(;n;)n=Fe(n,e);e.e&=-5},bt=(e,t)=>{let n,r=0,s=!1;e:for(;;){let i=e.c,a=i.e;if(t.e&16)s=!0;else if((a&17)===17){if(lt(i)){let o=i.r;o.n&&Ne(o),s=!0}}else if((a&33)===33){(e.n||e.f)&&(n={t:e,u:n}),e=i.s,t=i,++r;continue}if(!s){let o=e.i;if(o){e=o;continue}}for(;r--;){let o=t.r,c=o.n;if(c?(e=n.t,n=n.u):e=o,s){if(lt(t)){c&&Ne(o),t=e.o;continue}s=!1}else t.e&=-33;if(t=e.o,e.i){e=e.i;continue e}}return s}},Ne=e=>{do{let t=e.o,n=t.e;(n&48)===32&&(t.e=n|16,n&2&&Ue(t))}while(e=e.n)},Wt=(e,t)=>{let n=t.a;for(;n;){if(n===e)return!0;n=n.l}return!1},se=e=>{let t=X,n=e.split(".");for(let r of n){if(t==null||!k(t,r))return;t=t[r]}return t},Le=(e,t="")=>{let n=Array.isArray(e);if(n||re(e)){let r=n?[]:{};for(let i in e)r[i]=ge(Le(e[i],`${t+i}.`));let s=ge(0);return new Proxy(r,{get(i,a){if(!(a==="toJSON"&&!k(r,a)))return n&&a in Array.prototype?(s(),r[a]):typeof a=="symbol"?r[a]:((!k(r,a)||r[a]()==null)&&(r[a]=ge(""),Y(t+a,""),s(s()+1)),r[a]())},set(i,a,o){let c=t+a;if(n&&a==="length"){let l=r[a]-o;if(r[a]=o,l>0){let f={};for(let d=o;d<r[a];d++)f[d]=null;Y(t.slice(0,-1),f),s(s()+1)}}else k(r,a)?o==null?delete r[a]:k(o,We)?(r[a]=o,Y(c,"")):r[a](Le(o,`${c}.`))&&Y(c,o):o!=null&&(k(o,We)?(r[a]=o,Y(c,"")):(r[a]=ge(Le(o,`${c}.`)),Y(c,o)),s(s()+1));return!0},deleteProperty(i,a){return delete r[a],s(s()+1),!0},ownKeys(){return s(),Reflect.ownKeys(r)},has(i,a){return s(),a in r}})}return e},Y=(e,t)=>{if(e!==void 0&&t!==void 0&&we.push([e,t]),!Ce&&we.length){let n=Re(we);we.length=0,document.dispatchEvent(new CustomEvent(z,{detail:n}))}},P=(e,{ifMissing:t}={})=>{M();for(let n in e)e[n]==null?t||delete X[n]:vt(e[n],n,X,"",t);x()},v=(e,t)=>P(Re(e),t),vt=(e,t,n,r,s)=>{if(re(e)){k(n,t)&&(re(n[t])||Array.isArray(n[t]))||(n[t]={});for(let i in e)e[i]==null?s||delete n[t][i]:vt(e[i],i,n[t],`${r+t}.`,s)}else s&&k(n,t)||(n[t]=e)},ft=e=>typeof e=="string"?RegExp(e.replace(/^\/|\/$/g,"")):e,_=({include:e=/.*/,exclude:t=/(?!)/}={},n=X)=>{let r=ft(e),s=ft(t),i=[],a=[[n,""]];for(;a.length;){let[o,c]=a.pop();for(let l in o){let f=c+l;re(o[l])?a.push([o[l],`${f}.`]):r.test(f)&&!s.test(f)&&i.push([f,se(f)])}}return Re(i)},X=Le({});var U=e=>e instanceof HTMLElement||e instanceof SVGElement||e instanceof MathMLElement;var Ut="https://data-star.dev/errors",he=(e,t,n={})=>{Object.assign(n,e);let r=new Error,s=ot(t),i=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),a=JSON.stringify(n,null,2);return r.message=`${t}
More info: ${Ut}/${s}?${i}
Context: ${a}`,r},He=new Map,St=new Map,Tt=new Map,At=new Proxy({},{get:(e,t)=>He.get(t)?.apply,has:(e,t)=>He.has(t),ownKeys:()=>Reflect.ownKeys(He),set:()=>!1,deleteProperty:()=>!1}),ye=new Map,Oe=[],Ke=new Set,p=e=>{Oe.push(e),Oe.length===1&&setTimeout(()=>{for(let t of Oe)Ke.add(t.name),St.set(t.name,t);Oe.length=0,Qt(),Ke.clear()})},O=e=>{He.set(e.name,e)};document.addEventListener(G,e=>{let t=Tt.get(e.detail.type);t&&t.apply({error:he.bind(0,{plugin:{type:"watcher",name:t.name},element:{id:e.target.id,tag:e.target.tagName}})},e.detail.argsRaw)});var be=e=>{Tt.set(e.name,e)},Et=e=>{for(let t of e){let n=ye.get(t);if(ye.delete(t)){for(let r of n.values())r();n.clear()}}},Rt=Q("ignore"),Jt=`[${Rt}]`,wt=e=>e.hasAttribute(`${Rt}__self`)||!!e.closest(Jt),ke=(e,t)=>{for(let n of e)if(!wt(n))for(let r in n.dataset)Mt(n,r.replace(/[A-Z]/g,"-$&").toLowerCase(),n.dataset[r],t)},Kt=e=>{for(let{target:t,type:n,attributeName:r,addedNodes:s,removedNodes:i}of e)if(n==="childList"){for(let a of i)U(a)&&(Et([a]),Et(a.querySelectorAll("*")));for(let a of s)U(a)&&(ke([a]),ke(a.querySelectorAll("*")))}else if(n==="attributes"&&r.startsWith("data-")&&U(t)&&!wt(t)){let a=r.slice(5),o=t.getAttribute(r);if(o===null){let c=ye.get(t);c&&(c.get(a)?.(),c.delete(a))}else Mt(t,a,o)}},zt=new MutationObserver(Kt),Qt=(e=document.documentElement)=>{U(e)&&ke([e],!0),ke(e.querySelectorAll("*"),!0),zt.observe(e,{subtree:!0,childList:!0,attributes:!0})},Mt=(e,t,n,r)=>{{let s=t,[i,...a]=s.split("__"),[o,c]=i.split(/:(.+)/),l=St.get(o);if((!r||Ke.has(o))&&l){let f={el:e,rawKey:s,mods:new Map,error:he.bind(0,{plugin:{type:"attribute",name:l.name},element:{id:e.id,tag:e.tagName},expression:{rawKey:s,key:c,value:n}}),key:c,value:n,rx:void 0},d=l.requirement&&(typeof l.requirement=="string"?l.requirement:l.requirement.key)||"allowed",L=l.requirement&&(typeof l.requirement=="string"?l.requirement:l.requirement.value)||"allowed";if(c){if(d==="denied")throw f.error("KeyNotAllowed")}else if(d==="must")throw f.error("KeyRequired");if(n){if(L==="denied")throw f.error("ValueNotAllowed")}else if(L==="must")throw f.error("ValueRequired");if(d==="exclusive"||L==="exclusive"){if(c&&n)throw f.error("KeyAndValueProvided");if(!c&&!n)throw f.error("KeyOrValueRequired")}if(n){let m;f.rx=(...h)=>(m||(m=Zt(n,{returnsValue:l.returnsValue,argNames:l.argNames})),m(e,...h))}for(let m of a){let[h,...S]=m.split(".");f.mods.set(h,new Set(S))}let u=l.apply(f);if(u){let m=ye.get(e);m?m.get(s)?.():(m=new Map,ye.set(e,m)),m.set(s,u)}}}},Zt=(e,{returnsValue:t=!1,argNames:n=[]}={})=>{let r="";if(t){let o=/(\/(\\\/|[^/])*\/|"(\\"|[^"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;){]*)\s*\)\s*\(\s*\)|[^;])+/gm,c=e.trim().match(o);if(c){let l=c.length-1,f=c[l].trim();f.startsWith("return")||(c[l]=`return (${f});`),r=c.join(`;
`)}}else r=e.trim();let s=new Map,i=RegExp(`(?:${$e})(.*?)(?:${qe})`,"gm"),a=0;for(let o of r.matchAll(i)){let c=o[1],l=`__escaped${a++}`;s.set(l,c),r=r.replace($e+c+qe,l)}r=r.replace(/\$\['([a-zA-Z_$\d][\w$]*)'\]/g,"$$$1").replace(/\$([a-zA-Z_\d]\w*(?:[.-]\w+)*)/g,(o,c)=>c.split(".").reduce((l,f)=>`${l}['${f}']`,"$")).replace(/\[(\$[a-zA-Z_\d]\w*)\]/g,(o,c)=>`[$['${c.slice(1)}']]`),r=r.replaceAll(/@(\w+)\(/g,'__action("$1",evt,');for(let[o,c]of s)r=r.replace(o,c);try{let o=Function("el","$","__action","evt",...n,r);return(c,...l)=>{let f=(d,L,...u)=>{let m=he.bind(0,{plugin:{type:"action",name:d},element:{id:c.id,tag:c.tagName},expression:{fnContent:r,value:e}}),h=At[d];if(h)return h({el:c,evt:L,error:m},...u);throw m("UndefinedAction")};try{return o(c,X,f,void 0,...l)}catch(d){throw console.error(d),he({element:{id:c.id,tag:c.tagName},expression:{fnContent:r,value:e},error:d.message},"ExecuteExpression")}}}catch(o){throw console.error(o),he({expression:{fnContent:r,value:e},error:o.message},"GenerateExpression")}};var H=new Map,oe=new Set,ie=new Map,ve=new Set,ae=document.createElement("div");ae.hidden=!0;var Ee=Q("ignore-morph"),Yt=`[${Ee}]`,Ze=(e,t,n="outer")=>{if(U(e)&&U(t)&&e.hasAttribute(Ee)&&t.hasAttribute(Ee)||e.parentElement?.closest(Yt))return;let r=document.createElement("div");r.append(t),document.body.insertAdjacentElement("afterend",ae);let s=e.querySelectorAll("[id]");for(let{id:o,tagName:c}of s)ie.has(o)?ve.add(o):ie.set(o,c);e instanceof Element&&e.id&&(ie.has(e.id)?ve.add(e.id):ie.set(e.id,e.tagName)),oe.clear();let i=r.querySelectorAll("[id]");for(let{id:o,tagName:c}of i)oe.has(o)?ve.add(o):ie.get(o)===c&&oe.add(o);for(let o of ve)oe.delete(o);ie.clear(),ve.clear(),H.clear();let a=n==="outer"?e.parentElement:e;Lt(a,s),Lt(r,i),Ft(a,r,n==="outer"?e:null,e.nextSibling),ae.remove()},Ft=(e,t,n=null,r=null)=>{e instanceof HTMLTemplateElement&&t instanceof HTMLTemplateElement&&(e=e.content,t=t.content),n??=e.firstChild;for(let s of t.childNodes){if(n&&n!==r){let i=Xt(s,n,r);if(i){if(i!==n){let a=n;for(;a&&a!==i;){let o=a;a=a.nextSibling,Qe(o)}}ze(i,s),n=i.nextSibling;continue}}if(s instanceof Element&&oe.has(s.id)){let i=document.getElementById(s.id),a=i;for(;a=a.parentNode;){let o=H.get(a);o&&(o.delete(s.id),o.size||H.delete(a))}Nt(e,i,n),ze(i,s),n=i.nextSibling;continue}if(H.has(s)){let i=document.createElement(s.tagName);e.insertBefore(i,n),ze(i,s),n=i.nextSibling}else{let i=document.importNode(s,!0);e.insertBefore(i,n),n=i.nextSibling}}for(;n&&n!==r;){let s=n;n=n.nextSibling,Qe(s)}},Xt=(e,t,n)=>{let r=null,s=e.nextSibling,i=0,a=0,o=H.get(e)?.size||0,c=t;for(;c&&c!==n;){if(xt(c,e)){let l=!1,f=H.get(c),d=H.get(e);if(d&&f){for(let L of f)if(d.has(L)){l=!0;break}}if(l)return c;if(!r&&!H.has(c)){if(!o)return c;r=c}}if(a+=H.get(c)?.size||0,a>o)break;r===null&&s&&xt(c,s)&&(i++,s=s.nextSibling,i>=2&&(r=void 0)),c=c.nextSibling}return r||null},xt=(e,t)=>e.nodeType===t.nodeType&&e.tagName===t.tagName&&(!e.id||e.id===t.id),Qe=e=>{H.has(e)?Nt(ae,e,null):e.parentNode?.removeChild(e)},Nt=Qe.call.bind(ae.moveBefore??ae.insertBefore),en=Q("preserve-attr"),ze=(e,t)=>{let n=t.nodeType;if(n===1){let r=e,s=t;if(r.hasAttribute(Ee)&&s.hasAttribute(Ee))return e;r instanceof HTMLInputElement&&s instanceof HTMLInputElement&&s.type!=="file"?s.getAttribute("value")!==r.getAttribute("value")&&(r.value=s.getAttribute("value")??""):r instanceof HTMLTextAreaElement&&s instanceof HTMLTextAreaElement&&(s.value!==r.value&&(r.value=s.value),r.firstChild&&r.firstChild.nodeValue!==s.value&&(r.firstChild.nodeValue=s.value));let i=(t.getAttribute(en)??"").split(" ");for(let{name:a,value:o}of s.attributes)r.getAttribute(a)!==o&&!i.includes(a)&&r.setAttribute(a,o);for(let a=r.attributes.length-1;a>=0;a--){let{name:o}=r.attributes[a];!s.hasAttribute(o)&&!i.includes(o)&&r.removeAttribute(o)}r.isEqualNode(s)||Ft(r,s)}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),e},Lt=(e,t)=>{for(let n of t)if(oe.has(n.id)){let r=n;for(;r&&r!==e;){let s=H.get(r);s||(s=new Set,H.set(r,s)),s.add(n.id),r=r.parentElement}}};O({name:"peek",apply(e,t){$();try{return t()}finally{q()}}});O({name:"setAll",apply(e,t,n){$();let r=_(n);Z(r,()=>t),P(r),q()}});O({name:"toggleAll",apply(e,t){$();let n=_(t);Z(n,r=>!r),P(n),q()}});var _e=new WeakMap,Se=(e,t)=>O({name:e,apply:async({el:n,evt:r,error:s},i,{selector:a,headers:o,contentType:c="json",filterSignals:{include:l=/.*/,exclude:f=/(^|\.)_/}={},openWhenHidden:d=!1,alwaysReconnect:L=!0,retryInterval:u=1e3,retryScaler:m=2,retryMaxWaitMs:h=3e4,retryMaxCount:S=10,requestCancellation:A="auto"}={})=>{let R=A instanceof AbortController?A:new AbortController,D=A==="disabled";if(!D){let N=_e.get(n);N&&(N.abort(),await Promise.resolve())}!D&&!(A instanceof AbortController)&&_e.set(n,R);try{let N=()=>{};try{if(!i?.length)throw s("FetchNoUrlProvided",{action:O});let le={Accept:"text/event-stream, text/html, application/json","Datastar-Request":!0};c==="json"&&(le["Content-Type"]="application/json");let V=Object.assign({},le,o),C={method:t,headers:V,openWhenHidden:d,alwaysReconnect:L,retryInterval:u,retryScaler:m,retryMaxWaitMs:h,retryMaxCount:S,signal:R.signal,onopen:async g=>{g.status>=400&&ee(tn,n,{status:g.status.toString()})},onmessage:g=>{if(!g.event.startsWith("datastar"))return;let B=g.event,F={};for(let E of g.data.split(`
`)){let y=E.indexOf(" "),W=E.slice(0,y),de=E.slice(y+1);(F[W]||=[]).push(de)}let T=Object.fromEntries(Object.entries(F).map(([E,y])=>[E,y.join(`
`)]));ee(B,n,T)},onerror:g=>{if(Ct(g))throw g("FetchExpectedTextEventStream",{url:i});g&&(console.error(g.message),ee(nn,n,{message:g.message}))}},fe=new URL(i,document.baseURI),ue=new URLSearchParams(fe.search);if(c==="json"){let g=JSON.stringify(_({include:l,exclude:f}));t==="GET"?ue.set("datastar",g):C.body=g}else if(c==="form"){let g=a?document.querySelector(a):n.closest("form");if(!g)throw s("FetchFormNotFound",{action:O,selector:a});if(!g.checkValidity()){g.reportValidity(),N();return}let B=new FormData(g),F=n;if(n===g&&r instanceof SubmitEvent)F=r.submitter;else{let y=W=>W.preventDefault();g.addEventListener("submit",y),N=()=>g.removeEventListener("submit",y)}if(F instanceof HTMLButtonElement){let y=F.getAttribute("name");y&&B.append(y,F.value)}let T=g.getAttribute("enctype")==="multipart/form-data";T||(V["Content-Type"]="application/x-www-form-urlencoded");let E=new URLSearchParams(B);if(t==="GET")for(let[y,W]of E)ue.append(y,W);else T?C.body=B:C.body=E}else throw s("FetchInvalidContentType",{action:O,contentType:c});ee(Ye,n,{}),fe.search=ue.toString();try{await ln(fe.toString(),n,C)}catch(g){if(!Ct(g))throw s("FetchFailed",{method:t,url:i,error:g.message})}}finally{ee(Xe,n,{}),N()}}finally{_e.get(n)===R&&_e.delete(n)}}});Se("delete","DELETE");Se("get","GET");Se("patch","PATCH");Se("post","POST");Se("put","PUT");var Ye="started",Xe="finished",tn="error",nn="retrying",rn="retries-failed",ee=(e,t,n)=>document.dispatchEvent(new CustomEvent(G,{detail:{type:e,el:t,argsRaw:n}})),Ct=e=>`${e}`.includes("text/event-stream"),sn=async(e,t)=>{let n=e.getReader(),r=await n.read();for(;!r.done;)t(r.value),r=await n.read()},on=e=>{let t,n,r,s=!1;return i=>{t?t=cn(t,i):(t=i,n=0,r=-1);let a=t.length,o=0;for(;n<a;){s&&(t[n]===10&&(o=++n),s=!1);let c=-1;for(;n<a&&c===-1;++n)switch(t[n]){case 58:r===-1&&(r=n-o);break;case 13:s=!0;case 10:c=n;break}if(c===-1)break;e(t.subarray(o,c),r),o=n,r=-1}o===a?t=void 0:o&&(t=t.subarray(o),n-=o)}},an=(e,t,n)=>{let r=Pt(),s=new TextDecoder;return(i,a)=>{if(!i.length)n?.(r),r=Pt();else if(a>0){let o=s.decode(i.subarray(0,a)),c=a+(i[a+1]===32?2:1),l=s.decode(i.subarray(c));switch(o){case"data":r.data=r.data?`${r.data}
${l}`:l;break;case"event":r.event=l;break;case"id":e(r.id=l);break;case"retry":{let f=+l;Number.isNaN(f)||t(r.retry=f);break}}}}},cn=(e,t)=>{let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},Pt=()=>({data:"",event:"",id:"",retry:void 0}),ln=(e,t,{signal:n,headers:r,onopen:s,onmessage:i,onclose:a,onerror:o,openWhenHidden:c,alwaysReconnect:l=!1,fetch:f,retryInterval:d=1e3,retryScaler:L=2,retryMaxWaitMs:u=3e4,retryMaxCount:m=10,overrides:h,...S})=>new Promise((A,R)=>{let D={...r},N,le=()=>{N.abort(),document.hidden||F()};c||document.addEventListener("visibilitychange",le);let V=0,C=()=>{document.removeEventListener("visibilitychange",le),clearTimeout(V),N.abort()};n?.addEventListener("abort",()=>{C(),A()});let fe=f||window.fetch,ue=s||(()=>{}),g=0,B=d,F=async()=>{N=new AbortController;try{let T=await fe(e,{...S,headers:D,signal:N.signal});await ue(T);let E=async(I,me,De,Te,...qt)=>{let st={[De]:await me.text()};for(let Ve of qt){let Ie=me.headers.get(`datastar-${pe(Ve)}`);if(Te){let Ae=Te[Ve];Ae&&(Ie=typeof Ae=="string"?Ae:JSON.stringify(Ae))}Ie&&(st[Ve]=Ie)}ee(I,t,st),C(),A()},y=T.status,W=y>=300&&y<400;if(y!==200){if(a?.(),y!==204&&!W&&l!==!1){clearTimeout(V),V=setTimeout(F,d);return}C(),A();return}g=0,d=B;let de=T.headers.get("Content-Type");if(de?.includes("text/html"))return await E("datastar-patch-elements",T,"elements",h,"selector","mode","useViewTransition");if(de?.includes("application/json"))return await E("datastar-patch-signals",T,"signals",h,"onlyIfMissing");if(de?.includes("text/javascript")){let I=document.createElement("script"),me=T.headers.get("datastar-script-attributes");if(me)for(let[De,Te]of Object.entries(JSON.parse(me)))I.setAttribute(De,Te);I.textContent=await T.text(),document.head.appendChild(I),C();return}if(await sn(T.body,on(an(I=>{I?D["last-event-id"]=I:delete D["last-event-id"]},I=>{B=d=I},i))),a?.(),l&&!W){clearTimeout(V),V=setTimeout(F,d);return}C(),A()}catch(T){if(!N.signal.aborted)try{let E=o?.(T)||d;clearTimeout(V),V=setTimeout(F,E),d=Math.min(d*L,u),++g>=m?(ee(rn,t,{}),C(),R("Max retries reached.")):console.error(`Datastar failed to reach ${e.toString()} retrying in ${E}ms.`)}catch(E){C(),R(E)}}};F()});p({name:"attr",requirement:{value:"must"},returnsValue:!0,apply({el:e,key:t,rx:n}){let r=(o,c)=>{c===""||c===!0?e.setAttribute(o,""):c===!1||c==null?e.removeAttribute(o):typeof c=="string"?e.setAttribute(o,c):e.setAttribute(o,JSON.stringify(c))},s=t?()=>{i.disconnect();let o=n();r(t,o),i.observe(e,{attributeFilter:[t]})}:()=>{i.disconnect();let o=n(),c=Object.keys(o);for(let l of c)r(l,o[l]);i.observe(e,{attributeFilter:c})},i=new MutationObserver(s),a=b(s);return()=>{i.disconnect(),a()}}});var fn=/^data:(?<mime>[^;]+);base64,(?<contents>.*)$/,Ot=Symbol("empty"),Ht=Q("bind");p({name:"bind",requirement:"exclusive",apply({el:e,key:t,mods:n,value:r,error:s}){let i=t!=null?w(t,n):r,a=(u,m)=>m==="number"?+u.value:u.value,o=u=>{e.value=`${u}`};if(e instanceof HTMLInputElement)switch(e.type){case"range":case"number":a=(u,m)=>m==="string"?u.value:+u.value;break;case"checkbox":a=(u,m)=>u.value!=="on"?m==="boolean"?u.checked:u.checked?u.value:"":m==="string"?u.checked?u.value:"":u.checked,o=u=>{e.checked=typeof u=="string"?u===e.value:u};break;case"radio":e.getAttribute("name")?.length||e.setAttribute("name",i),a=(u,m)=>u.checked?m==="number"?+u.value:u.value:Ot,o=u=>{e.checked=u===(typeof u=="number"?+e.value:e.value)};break;case"file":{let u=()=>{let m=[...e.files||[]],h=[];Promise.all(m.map(S=>new Promise(A=>{let R=new FileReader;R.onload=()=>{if(typeof R.result!="string")throw s("InvalidFileResultType",{resultType:typeof R.result});let D=R.result.match(fn);if(!D?.groups)throw s("InvalidDataUri",{result:R.result});h.push({name:S.name,contents:D.groups.contents,mime:D.groups.mime})},R.onloadend=()=>A(),R.readAsDataURL(S)}))).then(()=>{v([[i,h]])})};return e.addEventListener("change",u),e.addEventListener("input",u),()=>{e.removeEventListener("change",u),e.removeEventListener("input",u)}}}else if(e instanceof HTMLSelectElement){if(e.multiple){let u=new Map;a=m=>[...m.selectedOptions].map(h=>{let S=u.get(h.value);return S==="string"||S==null?h.value:+h.value}),o=m=>{for(let h of e.options)m.includes(h.value)?(u.set(h.value,"string"),h.selected=!0):m.includes(+h.value)?(u.set(h.value,"number"),h.selected=!0):h.selected=!1}}}else e instanceof HTMLTextAreaElement||(a=u=>"value"in u?u.value:u.getAttribute("value"),o=u=>{"value"in e?e.value=u:e.setAttribute("value",u)});let c=se(i),l=typeof c,f=i;if(Array.isArray(c)&&!(e instanceof HTMLSelectElement&&e.multiple)){let u=t||r,m=document.querySelectorAll(`[${Ht}\\:${CSS.escape(u)}],[${Ht}="${CSS.escape(u)}"]`),h=[],S=0;for(let A of m){if(h.push([`${f}.${S}`,a(A,"none")]),e===A)break;S++}v(h,{ifMissing:!0}),f=`${f}.${S}`}else v([[f,a(e,l)]],{ifMissing:!0});let d=()=>{let u=se(f);if(u!=null){let m=a(e,typeof u);m!==Ot&&v([[f,m]])}};e.addEventListener("input",d),e.addEventListener("change",d);let L=b(()=>{o(se(f))});return()=>{L(),e.removeEventListener("input",d),e.removeEventListener("change",d)}}});p({name:"class",requirement:{value:"must"},returnsValue:!0,apply({key:e,el:t,mods:n,rx:r}){e&&(e=w(e,n,"kebab"));let s=()=>{i.disconnect();let o=e?{[e]:r()}:r();for(let c in o){let l=c.split(/\s+/).filter(f=>f.length>0);if(o[c])for(let f of l)t.classList.contains(f)||t.classList.add(f);else for(let f of l)t.classList.contains(f)&&t.classList.remove(f)}i.observe(t,{attributeFilter:["class"]})},i=new MutationObserver(s),a=b(s);return()=>{i.disconnect(),a();let o=e?{[e]:r()}:r();for(let c in o){let l=c.split(/\s+/).filter(f=>f.length>0);for(let f of l)t.classList.remove(f)}}}});p({name:"computed",requirement:{value:"must"},returnsValue:!0,apply({key:e,mods:t,rx:n,error:r}){if(e)v([[w(e,t),Pe(n)]]);else{let s=Object.assign({},n());Z(s,i=>{if(typeof i=="function")return Pe(i);throw r("ComputedExpectedFunction")}),P(s)}}});p({name:"effect",requirement:{key:"denied",value:"must"},apply:({rx:e})=>b(e)});p({name:"indicator",requirement:"exclusive",apply({el:e,key:t,mods:n,value:r}){let s=t!=null?w(t,n):r;v([[s,!1]]);let i=a=>{let{type:o,el:c}=a.detail;if(c===e)switch(o){case Ye:v([[s,!0]]);break;case Xe:v([[s,!1]]);break}};return document.addEventListener(G,i),()=>{v([[s,!1]]),document.removeEventListener(G,i)}}});p({name:"json-signals",requirement:{key:"denied"},apply({el:e,value:t,mods:n}){let r=n.has("terse")?0:2,s={};t&&(s=ne(t));let i=()=>{a.disconnect(),e.textContent=JSON.stringify(_(s),null,r),a.observe(e,{childList:!0,characterData:!0,subtree:!0})},a=new MutationObserver(i),o=b(i);return()=>{a.disconnect(),o()}}});var J=e=>{if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return+t.replace("ms","");if(t.endsWith("s"))return+t.replace("s","")*1e3;try{return Number.parseFloat(t)}catch{}}return 0},te=(e,t,n=!1)=>e?e.has(t.toLowerCase()):n;var et=(e,t)=>(...n)=>{setTimeout(()=>{e(...n)},t)},un=(e,t,n=!1,r=!0)=>{let s=0;return(...i)=>{s&&clearTimeout(s),n&&!s&&e(...i),s=setTimeout(()=>{r&&e(...i),s&&clearTimeout(s),s=0},t)}},dn=(e,t,n=!0,r=!1)=>{let s=!1;return(...i)=>{s||(n&&e(...i),s=!0,setTimeout(()=>{r&&e(...i),s=!1},t))}},ce=(e,t)=>{let n=t.get("delay");if(n){let i=J(n);e=et(e,i)}let r=t.get("debounce");if(r){let i=J(r),a=te(r,"leading",!1),o=!te(r,"notrailing",!1);e=un(e,i,a,o)}let s=t.get("throttle");if(s){let i=J(s),a=!te(s,"noleading",!1),o=te(s,"trailing",!1);e=dn(e,i,a,o)}return e};var tt=!!document.startViewTransition,K=(e,t)=>{if(t.has("viewtransition")&&tt){let n=e;e=(...r)=>document.startViewTransition(()=>n(...r))}return e};p({name:"on",requirement:"must",argNames:["evt"],apply({el:e,key:t,mods:n,rx:r}){let s=e;n.has("window")&&(s=window);let i=c=>{c&&(n.has("prevent")&&c.preventDefault(),n.has("stop")&&c.stopPropagation()),M(),r(c),x()};i=K(i,n),i=ce(i,n);let a={capture:n.has("capture"),passive:n.has("passive"),once:n.has("once")};if(n.has("outside")){s=document;let c=i;i=l=>{e.contains(l?.target)||c(l)}}let o=w(t,n,"kebab");if((o===G||o===z)&&(s=document),e instanceof HTMLFormElement&&o==="submit"){let c=i;i=l=>{l?.preventDefault(),c(l)}}return s.addEventListener(o,i,a),()=>{s.removeEventListener(o,i)}}});var nt=new WeakSet;p({name:"on-intersect",requirement:{key:"denied",value:"must"},apply({el:e,mods:t,rx:n}){let r=()=>{M(),n(),x()};r=K(r,t),r=ce(r,t);let s={threshold:0};t.has("full")?s.threshold=1:t.has("half")&&(s.threshold=.5);let i=new IntersectionObserver(a=>{for(let o of a)o.isIntersecting&&(r(),i&&nt.has(e)&&i.disconnect())},s);return i.observe(e),t.has("once")&&nt.add(e),()=>{t.has("once")||nt.delete(e),i&&(i.disconnect(),i=null)}}});p({name:"on-interval",requirement:{key:"denied",value:"must"},apply({mods:e,rx:t}){let n=()=>{M(),t(),x()};n=K(n,e);let r=1e3,s=e.get("duration");s&&(r=J(s),te(s,"leading",!1)&&n());let i=setInterval(n,r);return()=>{clearInterval(i)}}});p({name:"init",requirement:{key:"denied",value:"must"},apply({rx:e,mods:t}){let n=()=>{M(),e(),x()};n=K(n,t);let r=0,s=t.get("delay");s&&(r=J(s),r>0&&(n=et(n,r))),n()}});p({name:"on-signal-patch",requirement:{value:"must"},argNames:["patch"],returnsValue:!0,apply({el:e,key:t,mods:n,rx:r,error:s}){if(t&&t!=="filter")throw s("KeyNotAllowed");let i=e.getAttribute("data-on-signal-patch-filter"),a={};i&&(a=ne(i));let o=ce(c=>{let l=_(a,c.detail);ct(l)||(M(),r(l),x())},n);return document.addEventListener(z,o),()=>{document.removeEventListener(z,o)}}});p({name:"ref",requirement:"exclusive",apply({el:e,key:t,mods:n,value:r}){let s=t!=null?w(t,n):r;v([[s,e]])}});var kt="none",_t="display";p({name:"show",requirement:{key:"denied",value:"must"},returnsValue:!0,apply({el:e,rx:t}){let n=()=>{r.disconnect(),t()?e.style.display===kt&&e.style.removeProperty(_t):e.style.setProperty(_t,kt),r.observe(e,{attributeFilter:["style"]})},r=new MutationObserver(n),s=b(n);return()=>{r.disconnect(),s()}}});p({name:"signals",returnsValue:!0,apply({key:e,mods:t,rx:n}){let r=t.has("ifmissing");if(e)e=w(e,t),v([[e,n?.()]],{ifMissing:r});else{let s=Object.assign({},n?.());P(s,{ifMissing:r})}}});p({name:"style",requirement:{value:"must"},returnsValue:!0,apply({key:e,el:t,rx:n}){let{style:r}=t,s=new Map,i=(l,f)=>{let d=s.get(l);!f&&f!==0?d!==void 0&&(d?r.setProperty(l,d):r.removeProperty(l)):(d===void 0&&s.set(l,r.getPropertyValue(l)),r.setProperty(l,String(f)))},a=()=>{if(o.disconnect(),e)i(e,n());else{let l=n();for(let[f,d]of s)f in l||(d?r.setProperty(f,d):r.removeProperty(f));for(let f in l)i(pe(f),l[f])}o.observe(t,{attributeFilter:["style"]})},o=new MutationObserver(a),c=b(a);return()=>{o.disconnect(),c();for(let[l,f]of s)f?r.setProperty(l,f):r.removeProperty(l)}}});p({name:"text",requirement:{key:"denied",value:"must"},returnsValue:!0,apply({el:e,rx:t}){let n=()=>{r.disconnect(),e.textContent=`${t()}`,r.observe(e,{childList:!0,characterData:!0,subtree:!0})},r=new MutationObserver(n),s=b(n);return()=>{r.disconnect(),s()}}});be({name:"datastar-patch-elements",apply(e,{elements:t="",selector:n="",mode:r="outer",useViewTransition:s}){switch(r){case"remove":case"outer":case"inner":case"replace":case"prepend":case"append":case"before":case"after":break;default:throw e.error("PatchElementsInvalidMode",{mode:r})}if(!n&&r!=="outer"&&r!=="replace")throw e.error("PatchElementsExpectedSelector");let i={mode:r,selector:n,elements:t,useViewTransition:s?.trim()==="true"};tt&&s?document.startViewTransition(()=>Dt(e,i)):Dt(e,i)}});var Dt=({error:e},{elements:t,selector:n,mode:r})=>{let s=t.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,""),i=/<\/html>/.test(s),a=/<\/head>/.test(s),o=/<\/body>/.test(s),c=new DOMParser().parseFromString(i||a||o?t:`<body><template>${t}</template></body>`,"text/html"),l=document.createDocumentFragment();if(i?l.appendChild(c.documentElement):a&&o?(l.appendChild(c.head),l.appendChild(c.body)):a?l.appendChild(c.head):o?l.appendChild(c.body):l=c.querySelector("template").content,!n&&(r==="outer"||r==="replace"))for(let f of l.children){let d;if(f instanceof HTMLHtmlElement)d=document.documentElement;else if(f instanceof HTMLBodyElement)d=document.body;else if(f instanceof HTMLHeadElement)d=document.head;else if(d=document.getElementById(f.id),!d){console.warn(e("PatchElementsNoTargetsFound"),{element:{id:f.id}});continue}It(r,f,[d])}else{let f=document.querySelectorAll(n);if(!f.length){console.warn(e("PatchElementsNoTargetsFound"),{selector:n});return}It(r,l,f)}},rt=new WeakSet;for(let e of document.querySelectorAll("script"))rt.add(e);var $t=e=>{let t=e instanceof HTMLScriptElement?[e]:e.querySelectorAll("script");for(let n of t)if(!rt.has(n)){let r=document.createElement("script");for(let{name:s,value:i}of n.attributes)r.setAttribute(s,i);r.text=n.text,n.replaceWith(r),rt.add(r)}},Vt=(e,t,n)=>{for(let r of e){let s=t.cloneNode(!0);$t(s),r[n](s)}},It=(e,t,n)=>{switch(e){case"remove":for(let r of n)r.remove();break;case"outer":case"inner":for(let r of n)Ze(r,t.cloneNode(!0),e),$t(r);break;case"replace":Vt(n,t,"replaceWith");break;case"prepend":case"append":case"before":case"after":Vt(n,t,e)}};be({name:"datastar-patch-signals",apply({error:e},{signals:t,onlyIfMissing:n}){if(t){let r=n?.trim()==="true";P(ne(t),{ifMissing:r})}else throw e("PatchSignalsExpectedSignals")}});export{O as action,At as actions,p as attribute,M as beginBatch,Pe as computed,b as effect,x as endBatch,_ as filtered,se as getPath,P as mergePatch,v as mergePaths,Ze as morph,X as root,ge as signal,$ as startPeeking,q as stopPeeking,be as watcher};
//# sourceMappingURL=datastar.js.map
