name: simplified_admin_db
resources:

  - name: dag
    schema:
      fields:
        - {name: id, type: int}
        - {name: parent, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [parent]
          reference: 
            fields: [id]

  - name: repo
    schema:
      fields:
        - {name: id, type: str}
        - {name: url, type: str}
      primaryKeys: [id] 
            
  - name: db_version
    schema:
      fields:
        - {name: id, type: str}
        - {name: parent, type: str}
        - {name: dag, type: str}
        - {name: release_type, type: str}
        - {name: exec_status, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [parent]
          reference: 
            fields: [id]
        - fields: [dag]
          reference: 
            fields: [id]
            resource: dag

  - name: repo_version
    schema:
      fields:
        - {name: id, type: str}
        - {name: parent, type: str}
        - {name: repo, type: str}
        - {name: url_suffix, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [parent]
          reference: 
            fields: [id]
        - fields: [repo]
          reference: 
            fields: [id]
            resource: repo

  - name: task
    schema:
      fields:
        - {name: id, type: str}
        - {name: repo, type: str}
        - {name: path, type: str}
        - {name: stage, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [repo]
          reference: 
            fields: [id]
            resource: repo

  - name: task_version
    schema:
      fields:
        - {name: id, type: str}
        - {name: parent, type: str}
        - {name: task, type: str}
        - {name: repo_version, type: str}
        - {name: api_info, type: str}
        - {name: path_suffix, type: str}
        - {name: db_version, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [parent]
          reference: 
            fields: [id]
        - fields: [task]
          reference: 
            fields: [id]
            resource: task
        - fields: [repo_version]
          reference: 
            fields: [id]
            resource: repo_version
        - fields: [db_version]
          reference: 
            fields: [id]
            resource: db_version

  - name: edge
    schema:
      fields:
        - {name: id, type: str}
        - {name: source, type: str}
        - {name: target, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [source]
          reference:
            fields: [id]
            resource: task
        - fields: [target]
          reference:
            fields: [id]
            resource: task

  - name: dag_task
    schema:
      fields:
        - {name: id, type: str}
        - {name: dag, type: str}
        - {name: task, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [dag]
          reference:
            fields: [id]
            resource: dag
        - fields: [task]
          reference:
            fields: [id]
            resource: task

  - name: dag_edge
    schema:
      fields:
        - {name: id, type: str}
        - {name: dag, type: str}
        - {name: edge, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [dag]
          reference:
            fields: [id]
            resource: dag
        - fields: [edge]
          reference:
            fields: [id]
            resource: edge

  - name: db_task_version
    schema:
      fields:
        - {name: id, type: str}
        - {name: dag_task, type: str}
        - {name: task_version, type: str}
        - {name: db_version, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [db_version]
          reference: 
            fields: [id]
            resource: db_version
        - fields: [dag_task]
          reference:
            fields: [id]
            resource: dag_task
        - fields: [task_version]
          reference:
            fields: [id]
            resource: task_version

  - name: edge_version
    schema:
      fields:
        - {name: id, type: str}
        - {name: parent, type: str}
        - {name: edge, type: str}
        - {name: source_version, type: str}
        - {name: target_version, type: str}
        - {name: db_version, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [parent]
          reference: 
            fields: [id]
        - fields: [edge]
          reference:
            fields: [id]
            resource: edge
        - fields: [source_version]
          reference:
            fields: [id]
            resource: task_version
        - fields: [target_version]
          reference:
            fields: [id]
            resource: task_version
        - fields: [db_version]
          reference: 
            fields: [id]
            resource: db_version

  - name: db_edge_version
    schema:
      fields:
        - {name: id, type: str}
        - {name: dag_edge, type: str}
        - {name: edge_version, type: str}
        - {name: db_version, type: str}
      primaryKeys: [id] 
      foreignKeys: 
        - fields: [db_version]
          reference: 
            fields: [id]
            resource: db_version
        - fields: [dag_edge]
          reference:
            fields: [id]
            resource: dag_edge
        - fields: [edge_version]
          reference:
            fields: [id]
            resource: edge_version

