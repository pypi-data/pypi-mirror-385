- name: Using Storage Virtualize collection to create a volume group
  hosts: localhost
  vars:
    clustername: 'clustername'
    username: 'username'
    password: 'password'
  gather_facts: false
  connection: local
  tasks:
    - name: Fetch cluster auth token
      register: auth
      no_log: true
      ibm.storage_virtualize.ibm_svc_auth:
        clustername: "{{ clustername }}"
        username: "{{ username }}"
        password: "{{ password }}"

    - name: Create a new volume group
      ibm.storage_virtualize.ibm_svc_manage_volumegroup:
        clustername: "{{ clustername }}"
        token: "{{ auth.token }}"
        name: vg1
        state: present
    - name: Create volumegroup with existing snapshotpolicy
      ibm.storage_virtualize.ibm_svc_manage_volumegroup:
        clustername: "{{ clustername }}"
        token: "{{ auth.token }}"
        name: vg2
        state: present
        snapshotpolicy: snapshotpolicy2
