- name: Using Storage Virtualize collection to change security settings
  hosts: localhost
  vars:
    clustername: 'clustername'
    username: 'username'
    password: 'password'
  gather_facts: false
  connection: local
  tasks:
    - name: Fetch cluster auth token
      register: auth
      no_log: true
      ibm.storage_virtualize.ibm_svc_auth:
        clustername: "{{ clustername }}"
        username: "{{ username }}"
        password: "{{ password }}"

    - name: Change max failed login limit
      ibm.storage_virtualize.ibm_sv_manage_security:
        clustername: "{{ clustername }}"
        token: "{{ auth.token }}"
        log_path: "/tmp/playbook.debug"
        maxfailedlogins: 5

    - name: Change SSH protocol level
      ibm.storage_virtualize.ibm_sv_manage_security:
        clustername: "{{ clustername }}"
        token: "{{ auth.token }}"
        log_path: "/tmp/playbook.debug"
        sshprotocol: 2
