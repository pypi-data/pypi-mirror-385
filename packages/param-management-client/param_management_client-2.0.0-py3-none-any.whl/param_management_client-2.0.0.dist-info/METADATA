Metadata-Version: 2.1
Name: param-management-client
Version: 2.0.0
Summary: å‚æ•°ç®¡ç†ç³»ç»Ÿ Python å®¢æˆ·ç«¯ï¼Œæ”¯æŒç±»ä¼¼pandas DataFrameçš„ç‚¹å·è®¿é—®æ–¹å¼ï¼Œå†…ç½®å®Œæ•´åç«¯æœåŠ¡
Home-page: https://github.com/yourusername/param-management-client
Author: Your Name
Author-email: Your Name <your.email@example.com>
License: MIT
Project-URL: Homepage, https://github.com/yourusername/param-management-client
Project-URL: Documentation, https://github.com/yourusername/param-management-client#readme
Project-URL: Repository, https://github.com/yourusername/param-management-client
Project-URL: Bug Tracker, https://github.com/yourusername/param-management-client/issues
Keywords: parameter,management,optimization,pyomo,pandas-like,dot notation,fastapi,backend,embedded server,database
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Scientific/Engineering
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.7
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: requests >=2.25.0
Requires-Dist: fastapi >=0.104.0
Requires-Dist: uvicorn[standard] >=0.24.0
Requires-Dist: sqlalchemy >=2.0.0
Requires-Dist: pydantic >=2.5.0
Requires-Dist: python-multipart >=0.0.6
Requires-Dist: openpyxl >=3.1.0
Requires-Dist: pandas >=2.1.0
Requires-Dist: reportlab >=4.0.0
Requires-Dist: python-jose[cryptography] >=3.3.0
Requires-Dist: passlib[bcrypt] >=1.7.4
Requires-Dist: python-dotenv >=1.0.0
Provides-Extra: dev
Requires-Dist: pytest >=6.0.0 ; extra == 'dev'
Requires-Dist: pytest-cov >=2.0.0 ; extra == 'dev'
Requires-Dist: black >=21.0.0 ; extra == 'dev'
Requires-Dist: flake8 >=3.8.0 ; extra == 'dev'
Requires-Dist: mypy >=0.800 ; extra == 'dev'
Provides-Extra: pyomo
Requires-Dist: pyomo >=6.0.0 ; extra == 'pyomo'

# å‚æ•°ç®¡ç†ç³»ç»Ÿ Python å®¢æˆ·ç«¯

ä¸€ä¸ªæ”¯æŒç±»ä¼¼pandas DataFrameç‚¹å·è®¿é—®æ–¹å¼çš„Pythonå®¢æˆ·ç«¯ï¼Œä¸“é—¨ä¸ºå‚æ•°ç®¡ç†ç³»ç»Ÿè®¾è®¡ã€‚**v2.0.0ç‰ˆæœ¬æ–°å¢å†…ç½®å®Œæ•´åç«¯æœåŠ¡åŠŸèƒ½ï¼**

## ä¸»è¦ç‰¹æ€§

ğŸ¯ **ç‚¹å·è®¿é—®**: æ”¯æŒ `project.category_name.parameter_name` çš„ç›´è§‚è®¿é—®æ–¹å¼
ğŸ“Š **å±æ€§ä¸°å¯Œ**: æ¯ä¸ªå‚æ•°éƒ½åŒ…å«å€¼ã€å•ä½ã€æè¿°ã€ç±»å‹ç­‰å®Œæ•´ä¿¡æ¯
ğŸ”„ **ç±»å‹å®‰å…¨**: è‡ªåŠ¨å¤„ç†å„ç§å‚æ•°ç±»å‹ï¼ˆæ•°å€¼ã€åˆ—è¡¨ã€å¸ƒå°”å€¼ç­‰ï¼‰
ğŸ“ **å…ƒæ•°æ®å®Œæ•´**: æ”¯æŒè®¿é—®å‚æ•°å’Œåˆ†ç±»çš„æ‰€æœ‰å…ƒæ•°æ®ä¿¡æ¯
ğŸ **Pythonic**: å®Œå…¨ç¬¦åˆPythonç¼–ç¨‹ä¹ æƒ¯ï¼Œæ”¯æŒè¿­ä»£ã€ç´¢å¼•ç­‰æ“ä½œ
ğŸ”§ **Pyomoé›†æˆ**: å®Œç¾æ”¯æŒåœ¨Pyomoä¼˜åŒ–å»ºæ¨¡ä¸­ä½¿ç”¨
ğŸš€ **å†…ç½®åç«¯**: æ–°ç‰ˆæœ¬å†…ç½®å®Œæ•´çš„FastAPIåç«¯æœåŠ¡ï¼Œæ— éœ€å•ç‹¬éƒ¨ç½²
ğŸ’¾ **æ•°æ®åº“æ”¯æŒ**: å†…ç½®SQLiteæ•°æ®åº“ï¼Œæ”¯æŒå®Œæ•´çš„CRUDæ“ä½œ
ğŸ“¤ **å¯¼å…¥å¯¼å‡º**: æ”¯æŒExcelã€JSONã€æ–‡æœ¬ç­‰å¤šç§æ ¼å¼çš„å‚æ•°å¯¼å…¥å¯¼å‡º
ğŸ” **ç”¨æˆ·è®¤è¯**: æ”¯æŒJWTç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†

## å®‰è£…

```bash
pip install param-management-client
```

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼1: ä½¿ç”¨å†…ç½®åç«¯æœåŠ¡ï¼ˆæ¨èï¼‰

```python
from param_management_client import ParameterClient, run_embedded_server
import threading
import time

# å¯åŠ¨å†…ç½®åç«¯æœåŠ¡
def start_server():
    run_embedded_server(host="127.0.0.1", port=8000)

# åœ¨åå°çº¿ç¨‹å¯åŠ¨æœåŠ¡å™¨
server_thread = threading.Thread(target=start_server, daemon=True)
server_thread.start()
time.sleep(2)  # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨

# åˆ›å»ºå®¢æˆ·ç«¯å¹¶åŠ è½½é¡¹ç›®
client = ParameterClient(
    host="127.0.0.1",
    port=8000,
    project_name="energy_optimization_params"
)

# è·å–é¡¹ç›®å¯¹è±¡
project = client.get_project()
```

### æ–¹å¼2: è¿æ¥è¿œç¨‹æœåŠ¡å™¨

```python
from param_management_client import ParameterClient

# åˆ›å»ºå®¢æˆ·ç«¯å¹¶åŠ è½½é¡¹ç›®
client = ParameterClient(
    host="localhost",
    port=8000,
    project_name="energy_optimization_params"
)

# è·å–é¡¹ç›®å¯¹è±¡
project = client.get_project()

# è®¿é—®é¡¹ç›®åŸºæœ¬ä¿¡æ¯
print(f"é¡¹ç›®åç§°: {project.name}")
print(f"é¡¹ç›®è‹±æ–‡å: {project.name_en}")
print(f"æ—¶é—´èŒƒå›´: {project.time_horizon} å¹´")
print(f"å‚æ•°åˆ†ç±»: {project.categories}")
```

### åˆ†ç±»è®¿é—®

```python
# é€šè¿‡ç‚¹å·è®¿é—®åˆ†ç±»
wind_params = project.wind_params
print(f"åˆ†ç±»åç§°: {wind_params.name}")
print(f"åˆ†ç±»æè¿°: {wind_params.description}")
print(f"å‚æ•°åˆ—è¡¨: {wind_params.list_parameters()}")
```

### å‚æ•°è®¿é—®

```python
# è®¿é—®å•ä¸ªå‚æ•°
capital_ratio = project.wind_params.capital_ratio
print(f"å‚æ•°å€¼: {capital_ratio.value}")
print(f"å‚æ•°å•ä½: {capital_ratio.unit}")
print(f"å‚æ•°æè¿°: {capital_ratio.description}")
print(f"å‚æ•°ç±»å‹: {capital_ratio.param_type}")

# è®¿é—®åˆ—è¡¨å‚æ•°
electricity_price = project.wind_params.electricity_price
print(f"åˆ—è¡¨é•¿åº¦: {len(electricity_price)}")
print(f"ç¬¬ä¸€å¹´ç”µä»·: {electricity_price[0]}")
print(f"æœ€åä¸€å¹´ç”µä»·: {electricity_price[-1]}")

# éå†åˆ—è¡¨å‚æ•°
for i, price in enumerate(electricity_price):
    year = project.start_year + i * project.year_step
    print(f"{year}å¹´ç”µä»·: {price}")
```

### åœ¨Pyomoä¸­ä½¿ç”¨

```python
import pyomo.environ as pyo

# åˆ›å»ºPyomoæ¨¡å‹
model = pyo.ConcreteModel()
model.T = pyo.Set(initialize=range(project.time_horizon))

# ä»å‚æ•°ç³»ç»Ÿè·å–æ•°æ®ï¼ˆè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼‰
wind_capital_ratio = project.wind_params.capital_ratio.value
wind_unit_cost = project.wind_params.unit_investment_cost.value
wind_electricity_price = project.wind_params.electricity_price.value

# å®šä¹‰Pyomoå‚æ•°
model.wind_capital_ratio = pyo.Param(initialize=wind_capital_ratio)
model.wind_unit_cost = pyo.Param(initialize=wind_unit_cost)
model.electricity_price = pyo.Param(
    model.T, 
    initialize=lambda m, t: wind_electricity_price[t] if t < len(wind_electricity_price) else 0
)

# å®šä¹‰å†³ç­–å˜é‡å’Œç›®æ ‡å‡½æ•°
model.wind_capacity = pyo.Var(model.T, domain=pyo.NonNegativeReals)
model.objective = pyo.Objective(
    expr=sum(model.wind_unit_cost * model.wind_capacity[t] * model.wind_capital_ratio for t in model.T),
    sense=pyo.minimize
)
```

## API å‚è€ƒ

### ParameterClient ç±»

#### æ„é€ å‡½æ•°

```python
ParameterClient(host="localhost", port=8000, project_name=None)
```

**å‚æ•°:**
- `host` (str): æœåŠ¡å™¨åœ°å€
- `port` (int): æœåŠ¡å™¨ç«¯å£ï¼Œé»˜è®¤8000
- `project_name` (str, å¯é€‰): é¡¹ç›®è‹±æ–‡åç§°

#### ä¸»è¦æ–¹æ³•

##### `load_project(project_name=None)`
åŠ è½½é¡¹ç›®æ•°æ®

**å‚æ•°:**
- `project_name` (str, å¯é€‰): é¡¹ç›®è‹±æ–‡åç§°

**è¿”å›:**
- `Project`: é¡¹ç›®å¯¹è±¡

##### `get_project()`
è·å–é¡¹ç›®å¯¹è±¡

**è¿”å›:**
- `Project`: é¡¹ç›®å¯¹è±¡

##### `refresh_project()`
åˆ·æ–°é¡¹ç›®æ•°æ®

**è¿”å›:**
- `Project`: æ›´æ–°åçš„é¡¹ç›®å¯¹è±¡

### Project ç±»

#### å±æ€§

- `name`: é¡¹ç›®ä¸­æ–‡åç§°
- `name_en`: é¡¹ç›®è‹±æ–‡åç§°
- `description`: é¡¹ç›®æè¿°
- `time_horizon`: æ—¶é—´é•¿åº¦
- `start_year`: èµ·å§‹å¹´ä»½
- `year_step`: å¹´ä»½æ­¥é•¿
- `end_year`: ç»“æŸå¹´ä»½
- `categories`: å‚æ•°åˆ†ç±»åˆ—è¡¨

#### æ–¹æ³•

##### `get_category(name)`
è·å–æŒ‡å®šåˆ†ç±»

**å‚æ•°:**
- `name` (str): åˆ†ç±»è‹±æ–‡åç§°

**è¿”å›:**
- `ParameterCategory`: åˆ†ç±»å¯¹è±¡

##### `list_categories()`
åˆ—å‡ºæ‰€æœ‰åˆ†ç±»åç§°

**è¿”å›:**
- `list`: åˆ†ç±»åç§°åˆ—è¡¨

### ParameterCategory ç±»

#### å±æ€§

- `name`: åˆ†ç±»ä¸­æ–‡åç§°
- `name_en`: åˆ†ç±»è‹±æ–‡åç§°
- `description`: åˆ†ç±»æè¿°
- `id`: åˆ†ç±»ID

#### æ–¹æ³•

##### `get_parameter(name)`
è·å–æŒ‡å®šå‚æ•°

**å‚æ•°:**
- `name` (str): å‚æ•°è‹±æ–‡åç§°

**è¿”å›:**
- `ParameterValue`: å‚æ•°å€¼å¯¹è±¡

##### `list_parameters()`
åˆ—å‡ºæ‰€æœ‰å‚æ•°åç§°

**è¿”å›:**
- `list`: å‚æ•°åç§°åˆ—è¡¨

### ParameterValue ç±»

#### å±æ€§

- `value`: å‚æ•°å€¼
- `unit`: å‚æ•°å•ä½
- `description`: å‚æ•°æè¿°
- `name`: å‚æ•°ä¸­æ–‡åç§°
- `name_en`: å‚æ•°è‹±æ–‡åç§°
- `param_type`: å‚æ•°ç±»å‹
- `is_list`: æ˜¯å¦ä¸ºåˆ—è¡¨å‚æ•°
- `is_year_related`: æ˜¯å¦å…³è”å¹´ä»½
- `list_length`: åˆ—è¡¨é•¿åº¦

#### æ–¹æ³•

##### `__getitem__(index)`
æ”¯æŒåˆ—è¡¨ç´¢å¼•è®¿é—®

##### `__len__()`
æ”¯æŒlen()å‡½æ•°

##### `__iter__()`
æ”¯æŒè¿­ä»£

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºæœ¬å‚æ•°è®¿é—®

```python
from param_management_client import ParameterClient

# åˆ›å»ºå®¢æˆ·ç«¯
client = ParameterClient(
    host="localhost",
    port=8000,
    project_name="energy_optimization_params"
)

project = client.get_project()

# è®¿é—®é¡¹ç›®ä¿¡æ¯
print(f"é¡¹ç›®: {project.name} ({project.name_en})")
print(f"æ—¶é—´èŒƒå›´: {project.time_horizon} å¹´")
print(f"åˆ†ç±»: {project.categories}")

# è®¿é—®é£èƒ½å‚æ•°
wind_params = project.wind_params
print(f"é£èƒ½å‚æ•°: {wind_params.name}")
print(f"å‚æ•°åˆ—è¡¨: {wind_params.list_parameters()}")

# è®¿é—®å…·ä½“å‚æ•°
capital_ratio = wind_params.capital_ratio
print(f"èµ„æœ¬æ¯”ä¾‹: {capital_ratio.value} {capital_ratio.unit}")
print(f"æè¿°: {capital_ratio.description}")
```

### ç¤ºä¾‹2: åˆ—è¡¨å‚æ•°æ“ä½œ

```python
# è·å–ç”µä»·åˆ—è¡¨
electricity_price = project.wind_params.electricity_price

# åŸºæœ¬æ“ä½œ
print(f"ç”µä»·åˆ—è¡¨é•¿åº¦: {len(electricity_price)}")
print(f"ç¬¬ä¸€å¹´ç”µä»·: {electricity_price[0]}")
print(f"æœ€åä¸€å¹´ç”µä»·: {electricity_price[-1]}")

# éå†åˆ—è¡¨
for i, price in enumerate(electricity_price):
    year = project.start_year + i * project.year_step
    print(f"{year}å¹´ç”µä»·: {price}")

# åˆ‡ç‰‡æ“ä½œ
first_5_years = [electricity_price[i] for i in range(5)]
print(f"å‰5å¹´ç”µä»·: {first_5_years}")
```

### ç¤ºä¾‹3: å‚æ•°éªŒè¯

```python
def validate_parameters(project):
    """éªŒè¯å‚æ•°å®Œæ•´æ€§"""
    
    # æ£€æŸ¥å¿…éœ€åˆ†ç±»
    required_categories = ["wind_params", "pv_params", "storage_params"]
    missing = [cat for cat in required_categories if cat not in project.categories]
    
    if missing:
        print(f"âŒ ç¼ºå°‘å¿…éœ€åˆ†ç±»: {missing}")
        return False
    
    # æ£€æŸ¥å‚æ•°ç±»å‹
    for category_name in project.categories:
        category = getattr(project, category_name)
        print(f"\nåˆ†ç±»: {category.name_en}")
        
        for param_name in category.list_parameters():
            param = getattr(category, param_name)
            print(f"  {param.name_en}: {param.param_type} {'(åˆ—è¡¨)' if param.is_list else ''}")
    
    return True

# ä½¿ç”¨éªŒè¯å‡½æ•°
validate_parameters(project)
```

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç±»å‹

1. **AttributeError**: è®¿é—®ä¸å­˜åœ¨çš„åˆ†ç±»æˆ–å‚æ•°
2. **TypeError**: å¯¹éåˆ—è¡¨å‚æ•°ä½¿ç”¨ç´¢å¼•è®¿é—®
3. **KeyError**: ä½¿ç”¨get_category()æˆ–get_parameter()è®¿é—®ä¸å­˜åœ¨çš„é¡¹ç›®
4. **ValueError**: é¡¹ç›®æœªåŠ è½½æ—¶è°ƒç”¨get_project()

### é”™è¯¯å¤„ç†ç¤ºä¾‹

```python
try:
    client = ParameterClient(
        host="localhost",
        port=8000,
        project_name="energy_optimization_params"
    )
    project = client.get_project()
    
    # å°è¯•è®¿é—®ä¸å­˜åœ¨çš„åˆ†ç±»
    try:
        nonexistent_category = project.nonexistent_category
    except AttributeError as e:
        print(f"åˆ†ç±»ä¸å­˜åœ¨: {e}")
    
    # å°è¯•è®¿é—®ä¸å­˜åœ¨çš„å‚æ•°
    try:
        nonexistent_param = project.wind_params.nonexistent_param
    except AttributeError as e:
        print(f"å‚æ•°ä¸å­˜åœ¨: {e}")
    
    # å°è¯•å¯¹éåˆ—è¡¨å‚æ•°ä½¿ç”¨ç´¢å¼•
    try:
        capital_ratio = project.wind_params.capital_ratio
        value = capital_ratio[0]  # è¿™åº”è¯¥ä¼šå¤±è´¥
    except TypeError as e:
        print(f"éåˆ—è¡¨å‚æ•°ä¸èƒ½ä½¿ç”¨ç´¢å¼•: {e}")
        
except Exception as e:
    print(f"å®¢æˆ·ç«¯é”™è¯¯: {e}")
```

## å¼€å‘

### å®‰è£…å¼€å‘ä¾èµ–

```bash
pip install -e ".[dev]"
```

### è¿è¡Œæµ‹è¯•

```bash
pytest
```

### ä»£ç æ ¼å¼åŒ–

```bash
black param_management_client/
```

### ç±»å‹æ£€æŸ¥

```bash
mypy param_management_client/
```

## è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ã€‚

## æ›´æ–°æ—¥å¿—

- **v2.0.0**: é‡å¤§æ›´æ–°ï¼Œæ–°å¢å†…ç½®åç«¯æœåŠ¡åŠŸèƒ½
  - ğŸš€ å†…ç½®å®Œæ•´çš„FastAPIåç«¯æœåŠ¡ï¼Œæ— éœ€å•ç‹¬éƒ¨ç½²
  - ğŸ’¾ å†…ç½®SQLiteæ•°æ®åº“æ”¯æŒ
  - ğŸ“¤ æ”¯æŒExcelã€JSONã€æ–‡æœ¬ç­‰å¤šç§æ ¼å¼çš„å‚æ•°å¯¼å…¥å¯¼å‡º
  - ğŸ” æ”¯æŒJWTç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
  - ğŸ› ï¸ å®Œæ•´çš„CRUD APIæ¥å£
  - ğŸ“Š æ”¯æŒå‚æ•°ä¸€è‡´æ€§éªŒè¯
  - ğŸ”„ æ”¯æŒé¡¹ç›®å¤‡ä»½å’Œæ¢å¤åŠŸèƒ½
- **v1.0.0**: åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒç‚¹å·è®¿é—®åŠŸèƒ½
  - æ”¯æŒå®Œæ•´çš„å‚æ•°å…ƒæ•°æ®è®¿é—®
  - æ”¯æŒåˆ—è¡¨å‚æ•°æ“ä½œ
  - å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶
  - æ”¯æŒPyomoé›†æˆ
