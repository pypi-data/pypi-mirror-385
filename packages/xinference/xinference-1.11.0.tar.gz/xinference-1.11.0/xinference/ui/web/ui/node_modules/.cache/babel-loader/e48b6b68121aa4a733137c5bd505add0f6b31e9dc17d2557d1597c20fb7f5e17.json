{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/inference/inference/xinference/ui/web/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{CssBaseline}from'@mui/material';import Snackbar from'@mui/material/Snackbar';import React,{useEffect,useState}from'react';import{useCookies}from'react-cookie';import{HashRouter}from'react-router-dom';import{Alert}from'./components/alertComponent';import{ApiContextProvider}from'./components/apiContext';import AuthAlertDialog from'./components/authAlertDialog';import{ThemeProvider}from'./components/themeContext';import{getEndpoint}from'./components/utils';import WraperRoutes from'./router/index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useCookies=useCookies(['token']),_useCookies2=_slicedToArray(_useCookies,3),cookie=_useCookies2[0],setCookie=_useCookies2[1],removeCookie=_useCookies2[2];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),msg=_useState2[0],setMsg=_useState2[1];var endPoint=getEndpoint();useEffect(function(){// token possible value: no_auth / need_auth / <real bearer token>\nfetch(endPoint+'/v1/cluster/auth',{method:'GET',headers:{'Content-Type':'application/json'}}).then(function(res){if(!res.ok){res.json().then(function(errorData){setMsg(\"Server error: \".concat(res.status,\" - \").concat(errorData.detail||'Unknown error'));});}else{res.json().then(function(data){if(!data.auth){setCookie('token','no_auth',{path:'/'});sessionStorage.setItem('token','no_auth');}else if(data.auth&&sessionStorage.getItem('token')==='no_auth'){removeCookie('token',{path:'/'});sessionStorage.removeItem('token');}sessionStorage.setItem('auth',String(data.auth));// sessionStorage only can set string value\n});}});},[cookie]);var handleClose=function handleClose(event,reason){if(reason==='clickaway'){return;}setMsg('');};return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:/*#__PURE__*/_jsxs(ThemeProvider,{children:[/*#__PURE__*/_jsx(Snackbar,{open:msg!=='',autoHideDuration:10000,anchorOrigin:{vertical:'top',horizontal:'center'},onClose:handleClose,children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",onClose:handleClose,sx:{width:'100%'},children:msg})}),/*#__PURE__*/_jsx(HashRouter,{children:/*#__PURE__*/_jsxs(ApiContextProvider,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(AuthAlertDialog,{}),/*#__PURE__*/_jsx(WraperRoutes,{})]})})]})});}export default App;","map":{"version":3,"names":["CssBaseline","Snackbar","React","useEffect","useState","useCookies","HashRouter","Alert","ApiContextProvider","AuthAlertDialog","ThemeProvider","getEndpoint","WraperRoutes","jsx","_jsx","jsxs","_jsxs","App","_useCookies","_useCookies2","_slicedToArray","cookie","setCookie","removeCookie","_useState","_useState2","msg","setMsg","endPoint","fetch","method","headers","then","res","ok","json","errorData","concat","status","detail","data","auth","path","sessionStorage","setItem","getItem","removeItem","String","handleClose","event","reason","className","children","open","autoHideDuration","anchorOrigin","vertical","horizontal","onClose","severity","sx","width"],"sources":["/home/runner/work/inference/inference/xinference/ui/web/ui/src/App.js"],"sourcesContent":["import { CssBaseline } from '@mui/material'\nimport Snackbar from '@mui/material/Snackbar'\nimport React, { useEffect, useState } from 'react'\nimport { useCookies } from 'react-cookie'\nimport { HashRouter } from 'react-router-dom'\n\nimport { Alert } from './components/alertComponent'\nimport { ApiContextProvider } from './components/apiContext'\nimport AuthAlertDialog from './components/authAlertDialog'\nimport { ThemeProvider } from './components/themeContext'\nimport { getEndpoint } from './components/utils'\nimport WraperRoutes from './router/index'\n\nfunction App() {\n  const [cookie, setCookie, removeCookie] = useCookies(['token'])\n  const [msg, setMsg] = useState('')\n\n  const endPoint = getEndpoint()\n\n  useEffect(() => {\n    // token possible value: no_auth / need_auth / <real bearer token>\n    fetch(endPoint + '/v1/cluster/auth', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    }).then((res) => {\n      if (!res.ok) {\n        res.json().then((errorData) => {\n          setMsg(\n            `Server error: ${res.status} - ${\n              errorData.detail || 'Unknown error'\n            }`\n          )\n        })\n      } else {\n        res.json().then((data) => {\n          if (!data.auth) {\n            setCookie('token', 'no_auth', { path: '/' })\n            sessionStorage.setItem('token', 'no_auth')\n          } else if (\n            data.auth &&\n            sessionStorage.getItem('token') === 'no_auth'\n          ) {\n            removeCookie('token', { path: '/' })\n            sessionStorage.removeItem('token')\n          }\n          sessionStorage.setItem('auth', String(data.auth)) // sessionStorage only can set string value\n        })\n      }\n    })\n  }, [cookie])\n\n  const handleClose = (event, reason) => {\n    if (reason === 'clickaway') {\n      return\n    }\n    setMsg('')\n  }\n\n  return (\n    <div className=\"app\">\n      <ThemeProvider>\n        <Snackbar\n          open={msg !== ''}\n          autoHideDuration={10000}\n          anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n          onClose={handleClose}\n        >\n          <Alert severity=\"error\" onClose={handleClose} sx={{ width: '100%' }}>\n            {msg}\n          </Alert>\n        </Snackbar>\n        <HashRouter>\n          <ApiContextProvider>\n            <CssBaseline />\n            <AuthAlertDialog />\n            <WraperRoutes />\n          </ApiContextProvider>\n        </HashRouter>\n      </ThemeProvider>\n    </div>\n  )\n}\n\nexport default App\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}