{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/inference/inference/xinference/ui/web/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Button,Dialog,DialogActions,DialogContent,DialogContentText,DialogTitle}from'@mui/material';import*as React from'react';import{useEffect,useState}from'react';import{useCookies}from'react-cookie';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function AuthAlertDialog(){var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),authStatus=_useState2[0],setAuthStatus=_useState2[1];var _useCookies=useCookies(['token']),_useCookies2=_slicedToArray(_useCookies,3),removeCookie=_useCookies2[2];var handleAuthStatus=function handleAuthStatus(){var status=localStorage.getItem('authStatus');if(status==='401'){removeCookie('token',{path:'/'});localStorage.removeItem('authStatus');sessionStorage.removeItem('token');navigate('/login',{replace:true});return;}if(status){setAuthStatus(status);}else{setAuthStatus('');}};useEffect(function(){localStorage.removeItem('authStatus');window.addEventListener('auth-status',handleAuthStatus);return function(){window.removeEventListener('auth-status',handleAuthStatus);};},[]);var handleClose=function handleClose(){// trigger first\nvar code=localStorage.getItem('authStatus');localStorage.removeItem('authStatus');setAuthStatus('');if(code==='401'){removeCookie('token',{path:'/'});sessionStorage.removeItem('token');navigate('/login',{replace:true});}};var handleDialogClose=function handleDialogClose(event,reason){if(reason&&reason==='backdropClick'){return;}localStorage.removeItem('authStatus');setAuthStatus('');};return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(Dialog,{fullWidth:true,maxWidth:\"md\",open:authStatus==='401'||authStatus==='403',onClose:handleDialogClose,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[authStatus==='403'&&/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:'Permission Error'}),authStatus==='401'&&/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:'Authentication Error'}),/*#__PURE__*/_jsxs(DialogContent,{children:[authStatus==='403'&&/*#__PURE__*/_jsx(DialogContentText,{id:\"alert-dialog-description\",children:'You do not have permissions to do this!'}),authStatus==='401'&&/*#__PURE__*/_jsx(DialogContentText,{id:\"alert-dialog-description\",children:'Invalid credentials! Please login.'})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:\"CONFIRMED\"})})]})});}","map":{"version":3,"names":["Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","React","useEffect","useState","useCookies","useNavigate","jsx","_jsx","jsxs","_jsxs","AuthAlertDialog","navigate","_useState","_useState2","_slicedToArray","authStatus","setAuthStatus","_useCookies","_useCookies2","removeCookie","handleAuthStatus","status","localStorage","getItem","path","removeItem","sessionStorage","replace","window","addEventListener","removeEventListener","handleClose","code","handleDialogClose","event","reason","Fragment","children","fullWidth","maxWidth","open","onClose","id","onClick"],"sources":["/home/runner/work/inference/inference/xinference/ui/web/ui/src/components/authAlertDialog.js"],"sourcesContent":["import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n} from '@mui/material'\nimport * as React from 'react'\nimport { useEffect, useState } from 'react'\nimport { useCookies } from 'react-cookie'\nimport { useNavigate } from 'react-router-dom'\n\nexport default function AuthAlertDialog() {\n  const navigate = useNavigate()\n  const [authStatus, setAuthStatus] = useState('')\n  const [, , removeCookie] = useCookies(['token'])\n\n  const handleAuthStatus = () => {\n    const status = localStorage.getItem('authStatus')\n    if (status === '401') {\n      removeCookie('token', { path: '/' })\n      localStorage.removeItem('authStatus')\n      sessionStorage.removeItem('token')\n      navigate('/login', { replace: true })\n      return\n    }\n    if (status) {\n      setAuthStatus(status)\n    } else {\n      setAuthStatus('')\n    }\n  }\n\n  useEffect(() => {\n    localStorage.removeItem('authStatus')\n    window.addEventListener('auth-status', handleAuthStatus)\n\n    return () => {\n      window.removeEventListener('auth-status', handleAuthStatus)\n    }\n  }, [])\n\n  const handleClose = () => {\n    // trigger first\n    const code = localStorage.getItem('authStatus')\n    localStorage.removeItem('authStatus')\n    setAuthStatus('')\n    if (code === '401') {\n      removeCookie('token', { path: '/' })\n      sessionStorage.removeItem('token')\n      navigate('/login', { replace: true })\n    }\n  }\n\n  const handleDialogClose = (event, reason) => {\n    if (reason && reason === 'backdropClick') {\n      return\n    }\n    localStorage.removeItem('authStatus')\n    setAuthStatus('')\n  }\n\n  return (\n    <React.Fragment>\n      <Dialog\n        fullWidth\n        maxWidth=\"md\"\n        open={authStatus === '401' || authStatus === '403'}\n        onClose={handleDialogClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        {authStatus === '403' && (\n          <DialogTitle id=\"alert-dialog-title\">\n            {'Permission Error'}\n          </DialogTitle>\n        )}\n        {authStatus === '401' && (\n          <DialogTitle id=\"alert-dialog-title\">\n            {'Authentication Error'}\n          </DialogTitle>\n        )}\n        <DialogContent>\n          {authStatus === '403' && (\n            <DialogContentText id=\"alert-dialog-description\">\n              {'You do not have permissions to do this!'}\n            </DialogContentText>\n          )}\n          {authStatus === '401' && (\n            <DialogContentText id=\"alert-dialog-description\">\n              {'Invalid credentials! Please login.'}\n            </DialogContentText>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose}>CONFIRMED</Button>\n        </DialogActions>\n      </Dialog>\n    </React.Fragment>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}