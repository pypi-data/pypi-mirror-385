# Override configuration for example Excel files
# Use with: mcp-excel --path examples --overrides examples_overrides.yaml

# Example 1: clean_data.xlsx
# No overrides needed - will load in RAW mode
# clean_data.xlsx:
#   (no overrides - demonstrates RAW mode)

# Example 2: messy_report.xlsx
# Demonstrates: skip_rows, skip_footer, drop_regex
messy_report.xlsx:
  sheet_overrides:
    Summary:
      skip_rows: 3              # Skip title, date, and empty row
      header_rows: 1            # Row 4 is the header
      skip_footer: 3            # Skip empty row, notes, and contact
      drop_regex: "^Total:"     # Remove total row from data

# Example 3: multirow_header.xlsx
# Demonstrates: Multi-row header auto-merging
multirow_header.xlsx:
  sheet_overrides:
    Quarterly:
      header_rows: 2            # First two rows form the header
                                # Will auto-merge to: Region, Q1__Sales, Q1__Units, Q2__Sales, Q2__Units

# Example 4: wide_format.xlsx
# Demonstrates: Unpivot transformation (wide â†’ long format)
wide_format.xlsx:
  sheet_overrides:
    MonthlySales:
      header_rows: 1
      unpivot:
        id_vars: ["Region", "Product"]
        value_vars: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"]
        var_name: "Month"
        value_name: "Sales"
      # Result: Each Region+Product will have 6 rows (one per month)

# Example 5: mixed_types.xlsx
# Demonstrates: Type hints for proper column casting
mixed_types.xlsx:
  sheet_overrides:
    Employees:
      header_rows: 1
      type_hints:
        salary: "DECIMAL(10,2)"     # Cast string to decimal
        hire_date: "DATE"           # Cast string to date
        is_active: "BOOL"           # Cast string to boolean
        years_experience: "INT"     # Cast string to integer

# Example 6: financial_report.xlsx
# Demonstrates: Multiple sheets with different overrides
financial_report.xlsx:
  sheet_overrides:
    Income:
      skip_rows: 4              # Skip company name, title, date, empty row
      header_rows: 1            # Row 5 is the header
      skip_footer: 2            # Skip notes and prepared by
      drop_regex: "^(Subtotal|Total):"  # Remove calculation rows
      column_renames:
        Account: "account_name"
        Amount: "amount"

    Balance:
      header_rows: 1
      type_hints:
        Amount: "DECIMAL(10,2)"
      # Balance sheet is already clean, just needs type casting

# Example 7: inventory_report.xlsx
# Demonstrates: Complex filtering and column renaming
inventory_report.xlsx:
  sheet_overrides:
    Current:
      skip_rows: 3              # Skip title, date, empty row
      header_rows: 1            # Row 4 is the header
      skip_footer: 3            # Skip empty row and summary
      drop_regex: "^(VOID|CANCELLED)"  # Remove void/cancelled items
      column_renames:
        "SKU#": "sku"
        "Item Name": "item_name"
        "Qty": "quantity"
        "Unit $": "unit_price"
        "Total $": "total_value"
        "Status": "status"
      type_hints:
        quantity: "INT"
        unit_price: "DECIMAL(10,2)"
        total_value: "DECIMAL(10,2)"

# Usage Examples:
#
# Load all examples:
#   mcp-excel --path examples --alias demo --overrides examples_overrides.yaml
#
# Then query:
#   tool_query(sql="SELECT * FROM demo__clean_data__orders LIMIT 5")
#   tool_query(sql="SELECT * FROM demo__messy_report__summary")
#   tool_query(sql="SELECT * FROM demo__multirow_header__quarterly")
#   tool_query(sql="SELECT * FROM demo__wide_format__monthlysales WHERE Month = 'Jan'")
#   tool_query(sql="SELECT name, salary FROM demo__mixed_types__employees WHERE is_active = true")
#   tool_query(sql="SELECT * FROM demo__financial_report__income")
#   tool_query(sql="SELECT * FROM demo__inventory_report__current WHERE quantity > 0")
#
# Discover loaded tables:
#   tool_list_tables(alias="demo")
#   tool_query(sql="SELECT * FROM demo____files")
#   tool_query(sql="SELECT * FROM demo____tables WHERE mode = 'ASSISTED'")
