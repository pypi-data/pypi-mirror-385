THIS IS NOT THREAD-SAFE. GLOBAL VARIABLES ARE USED FOR SIMPLICITY. DO NOT USE IN WEB SERVERS. ONLY USE IN NORMAL PC.