{#- Compatibility wrapper for basic BAR controller template -#}
{% set cfg_ns = namespace(value={}) %}
{% if bar_config is defined and bar_config is not none and bar_config.items is defined %}
    {% for key, value in bar_config.items() %}
        {% set _ = cfg_ns.value.update({key: value}) %}
    {% endfor %}
{% elif bar_config is defined and bar_config is mapping %}
    {% for key, value in bar_config.items() %}
        {% set _ = cfg_ns.value.update({key: value}) %}
    {% endfor %}
{% else %}
    {% set cfg_ns.value = {} %}
{% endif %}
{% if 'controller_variant' not in cfg_ns.value %}
    {% set _ = cfg_ns.value.update({'controller_variant': 'basic'}) %}
{% else %}
    {% set _ = cfg_ns.value.update({'controller_variant': 'basic'}) %}
{% endif %}
{% with bar_config = cfg_ns.value %}
{% include "sv/pcileech_tlps128_bar_controller.sv.j2" %}
{% endwith %}