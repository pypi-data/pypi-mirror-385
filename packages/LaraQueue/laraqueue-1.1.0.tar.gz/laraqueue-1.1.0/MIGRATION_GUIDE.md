# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ AsyncQueue (v1.0.0)

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

LaraQueue v1.0.0 –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É asyncio –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫, —Å–æ—Ö—Ä–∞–Ω—è—è –ø–æ–ª–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º API.

## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ

### ‚úÖ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **AsyncQueue** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ—á–µ—Ä–µ–¥–∏
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –¥–æ 50+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –¥–æ 10x+ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ throughput
- **AsyncIOEventEmitter** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
- **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å asyncio —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π

### ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π**
- **–û–±–∞ API –¥–æ—Å—Ç—É–ø–Ω—ã** - sync –∏ async
- **–ü–ª–∞–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è** - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å Sync –Ω–∞ Async

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install --upgrade LaraQueue
```

–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- `aioredis>=2.0.0` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è)

### 2. –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏

#### –î–æ (Sync):
```python
from lara_queue import Queue
from redis import Redis

r = Redis(host='localhost', port=6379, db=0)
queue = Queue(r, queue='python')

@queue.handler
def handle(data):
    print('Processing: ' + data['data']['message'])

queue.listen()
```

#### –ü–æ—Å–ª–µ (Async):
```python
import asyncio
import aioredis
from lara_queue import AsyncQueue

async def main():
    redis_client = await aioredis.from_url("redis://localhost:6379")
    queue = AsyncQueue(redis_client, queue='python')

    @queue.handler
    async def handle(data):
        print('Processing: ' + data['data']['message'])

    await queue.listen()

asyncio.run(main())
```

### 3. –ú–∏–≥—Ä–∞—Ü–∏—è —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

#### –î–æ (Sync):
```python
queue = Queue(r, queue='worker')
```

#### –ü–æ—Å–ª–µ (Async):
```python
queue = AsyncQueue(
    client=redis_client,
    queue='worker',
    max_concurrent_jobs=20,  # 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
    enable_metrics=True
)
```

### 4. –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

#### –î–æ (Sync):
```python
@queue.handler
def process_email(data):
    # –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    send_email(data['data']['to'])
```

#### –ü–æ—Å–ª–µ (Async):
```python
@queue.handler
async def process_email(data):
    # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    await send_email_async(data['data']['to'])
```

### 5. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á

#### –î–æ (Sync):
```python
queue.push('App\\Jobs\\EmailJob', {
    'to': 'user@example.com',
    'subject': 'Hello'
})
```

#### –ü–æ—Å–ª–µ (Async):
```python
await queue.push('App\\Jobs\\EmailJob', {
    'to': 'user@example.com',
    'subject': 'Hello'
})
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á

#### I/O-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (API, DB)
```python
queue = AsyncQueue(
    client=redis_client,
    queue='io_worker',
    max_concurrent_jobs=50,  # –í—ã—Å–æ–∫–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å
    enable_metrics=True
)
```

#### CPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
```python
queue = AsyncQueue(
    client=redis_client,
    queue='cpu_worker',
    max_concurrent_jobs=4,  # –ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —è–¥–µ—Ä CPU
    enable_metrics=True
)
```

#### –°–º–µ—à–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
```python
queue = AsyncQueue(
    client=redis_client,
    queue='mixed_worker',
    max_concurrent_jobs=20,  # –ë–∞–ª–∞–Ω—Å
    enable_metrics=True
)
```

## –ü–æ—ç—Ç–∞–ø–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
1. –û–±–Ω–æ–≤–∏—Ç–µ LaraQueue –¥–æ v1.0.0
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ aioredis
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ async –≤–µ—Ä—Å–∏–∏
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π async worker
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å sync –≤–µ—Ä—Å–∏–µ–π
3. –°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –≠—Ç–∞–ø 3: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
1. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç–µ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ async
2. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –≠—Ç–∞–ø 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ max_concurrent_jobs
2. –í–∫–ª—é—á–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Laravel

### Sync (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
```python
# Laravel –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å 'python'
queue = Queue(r, queue='python')
```

### Async (–Ω–æ–≤—ã–π)
```python
# Laravel –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å 'python_async'
queue = AsyncQueue(redis_client, queue='python_async')
```

**–í–∞–∂–Ω–æ**: Laravel –Ω–µ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å! –ü—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏.

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ú–µ—Ç—Ä–∏–∫–∏
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
metrics = queue.get_metrics()
print(f"Throughput: {metrics['performance']['throughput_per_second']:.2f} jobs/sec")
print(f"Concurrent jobs: {queue._processing_jobs}")
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger('lara_queue')
```

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ù—É–∂–Ω–æ –ª–∏ –º–µ–Ω—è—Ç—å Laravel –∫–æ–¥?
**A**: –ù–µ—Ç! Laravel –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π. –ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∏–º–µ–Ω–∞ –æ—á–µ—Ä–µ–¥–µ–π.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ API –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?
**A**: –î–∞! –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å sync –∏ async workers –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

### Q: –ö–∞–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É async –≤–µ—Ä—Å–∏–∏?
**A**: –î–æ 10x+ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ throughput, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è I/O-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á.

### Q: –ï—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –ø–∞–º—è—Ç–∏?
**A**: Async –≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ~20% –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –ø–æ CPU.

### Q: –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á?
**A**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `max_concurrent_jobs`. –ù–∞—á–Ω–∏—Ç–µ —Å 10-20, –∑–∞—Ç–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ `examples/async_example.py`
2. –ò–∑—É—á–∏—Ç–µ —Ç–µ—Å—Ç—ã –≤ `tests/test_async_queue.py`
3. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ AsyncQueue –¥–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∫–æ–¥–∞. –ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç–µ –≤—Å–µ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ async API.
