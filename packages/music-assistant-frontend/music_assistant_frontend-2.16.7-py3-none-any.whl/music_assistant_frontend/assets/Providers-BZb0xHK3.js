import{d as F,r as b,v as n,a$ as Y,q as G,ae as q,c as T,a as M,b as a,w as s,u as r,f as O,t as m,$ as o,F as V,o as c,b5 as u,g as X,h as v,x as j,b4 as J,bJ as Q,n as H,e as z,j as f,bt as K,b1 as W,z as Z,cf as d,cg as ee,P as te,p as ie}from"./index-Bn2Tzsay.js";import{C as ne}from"./Container-CEbFgC5b.js";import{P as se}from"./ProviderFilters-jQ88EZ2W.js";import{z as E}from"./index-CBho6rsP.js";import{V as p}from"./VBtn-BQk37KYJ.js";import{V as ae,a as re}from"./VRow-CNVApy9v.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VContainer-CRIwFZfO.js";/* empty css              */import"./VTextField-fPA0WAHx.js";import"./VInput-C_1AW61Q.js";const le={class:"providers-header w-100"},de={class:"pl-5 font-weight-medium"},ce=F({__name:"Providers",setup(ue){const y=O(),g=b([]),h=b(""),C=b([]),P=b([]),I=n.subscribe(Y.PROVIDERS_UPDATED,()=>{x()});G(I);const x=async function(){g.value=await n.getProviderConfigs()},$=function(t){n.removeProviderConfig(t),g.value=g.value.filter(e=>e.instance_id!=t)},k=function(t){y.push(`/settings/editprovider/${t}`)},N=function(t){t.enabled=!t.enabled,n.saveProviderConfig(t.domain,{enabled:t.enabled},t.instance_id)},U=function(t){n.sendCommand("config/providers/reload",{instance_id:t}).catch(e=>alert(e))},L=function(t,e){const i=n.providerManifests[e.domain],l=n.getProvider(e.instance_id),A=[{label:"settings.configure",labelArgs:[],action:()=>{k(e.instance_id)},icon:"mdi-cog"},{label:e.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{N(e)},icon:"mdi-cancel",disabled:!i.allow_disable},{label:"settings.documentation",labelArgs:[],action:()=>{ee(i.documentation)},icon:"mdi-bookshelf",disabled:!i.documentation},{label:"settings.sync",labelArgs:[],action:()=>{n.startSync(void 0,[e.instance_id])},icon:"mdi-sync",hide:!l?.available||e.type!=d.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{$(e.instance_id)},icon:"mdi-delete",hide:i.builtin},{label:"settings.reload",labelArgs:[],action:()=>{U(e.instance_id)},icon:"mdi-refresh"}];l?.available&&l.supported_features.includes(te.CREATE_GROUP_PLAYER)&&A.push({label:"settings.add_group_player",labelArgs:[],action:()=>{y.push(`/settings/addgroup/${l.lookup_key}`)},icon:"mdi-speaker-multiple"}),ie.emit("contextmenu",{items:A,posX:t.clientX,posY:t.clientY})};q(()=>n.providers,t=>{t&&x()},{immediate:!0});const _=function(t){const e=n.providerManifests[t.domain].name;if(t.name)return`${e} [${t.name}]`;const i=n.getProvider(t.instance_id);return i&&i.instance_name_postfix?`${e} [${i.instance_name_postfix}]`:e},R=function(t){return t&&t.length>150},S=function(t){return E(t).with("stable",()=>"green").with("beta",()=>"blue").with("alpha",()=>"purple").with("experimental",()=>"orange").with("unmaintained",()=>"grey").with("deprecated",()=>"red").otherwise(()=>"green")},B=function(t){return E(t).with(d.MUSIC,()=>o("settings.music")).with(d.PLAYER,()=>o("settings.player")).with(d.METADATA,()=>o("settings.metadata")).with(d.PLUGIN,()=>o("settings.plugin")).otherwise(()=>o("settings.player"))},D=function(t){return{[d.MUSIC]:"mdi-music",[d.PLAYER]:"mdi-speaker",[d.METADATA]:"mdi-file-code",[d.PLUGIN]:"mdi-puzzle"}[t]||"mdi-help-circle"},w=function(){let t=[...g.value];if(h.value){const e=h.value.toLowerCase();t=t.filter(i=>_(i).toLowerCase().includes(e))}return C.value.length>0&&(t=t.filter(e=>C.value.includes(e.type))),P.value.length>0&&(t=t.filter(e=>{const i=n.providerManifests[e.domain];return i&&P.value.includes(i.stage)})),t.sort((e,i)=>_(e).localeCompare(_(i)))};return(t,e)=>(c(),T(V,null,[M("div",le,[a(se,{"show-stage-filter":"","onUpdate:search":e[0]||(e[0]=i=>h.value=i),"onUpdate:types":e[1]||(e[1]=i=>C.value=i),"onUpdate:stages":e[2]||(e[2]=i=>P.value=i)}),a(p,{color:"primary",variant:"outlined",height:"40",class:"add-provider-btn",onClick:e[3]||(e[3]=i=>r(y).push("/settings/addprovider"))},{default:s(()=>[u(m(r(o)("settings.add_provider")),1)]),_:1})]),M("div",de,m(r(o)("settings.providers_total",[w().length,w().length>1?"s":""])),1),a(ne,{variant:"comfortable",class:"mt-4"},{default:s(()=>[a(ae,null,{default:s(()=>[(c(!0),T(V,null,X(w(),i=>(c(),v(re,{key:i.instance_id,cols:"12",md:"6",lg:"4",class:"d-flex"},{default:s(()=>[a(j,{class:"flex-fill rounded-lg","min-height":"200px",onClick:l=>k(i.instance_id)},{prepend:s(()=>[a(Z,{domain:i.domain,size:50,class:"listitem-media-thumb",style:{"margin-top":"5px","margin-bottom":"5px"}},null,8,["domain"])]),append:s(()=>[r(n).syncTasks.value.filter(l=>l.provider_instance==i.instance_id).length>0?(c(),v(p,{key:0,variant:"text",size:"small",icon:"",title:r(o)("settings.sync_running")},{default:s(()=>[a(f,{color:"grey"},{default:s(()=>[...e[4]||(e[4]=[u(" mdi-sync ",-1)])]),_:1})]),_:1},8,["title"])):z("",!0),i.enabled?i.last_error?(c(),v(p,{key:2,variant:"text",size:"small",icon:"",title:i.last_error},{default:s(()=>[a(f,{color:"red"},{default:s(()=>[...e[6]||(e[6]=[u(" mdi-alert-circle ",-1)])]),_:1})]),_:1},8,["title"])):r(n).providers[i.instance_id]?.available?z("",!0):(c(),v(p,{key:3,variant:"text",size:"small",icon:"",title:r(o)("settings.not_loaded")},{default:s(()=>[a(f,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(c(),v(p,{key:1,variant:"text",size:"small",icon:"",title:r(o)("settings.provider_disabled")},{default:s(()=>[a(f,{color:"grey"},{default:s(()=>[...e[5]||(e[5]=[u(" mdi-cancel ",-1)])]),_:1})]),_:1},8,["title"])),a(p,{variant:"text",size:"small",icon:"",title:B(i.type)},{default:s(()=>[a(f,{icon:D(i.type)},null,8,["icon"])]),_:2},1032,["title"]),a(K,{size:"x-small",variant:"flat",class:"mx-1 text-uppercase",color:S(r(n).providerManifests[i.domain]?.stage)},{default:s(()=>[u(m(r(o)(String(r(n).providerManifests[i.domain]?.stage||"").toLowerCase())),1)]),_:2},1032,["color"]),a(p,{icon:"mdi-dots-vertical",size:"small",variant:"text",onClick:W(l=>L(l,i),["stop"])},null,8,["onClick"])]),default:s(()=>[a(J,null,{default:s(()=>[u(m(_(i)),1)]),_:2},1024),a(Q,{class:H(["provider-description",{"truncated-text":R(r(n).providerManifests[i.domain].description)}])},{default:s(()=>[u(m(r(n).providerManifests[i.domain].description),1)]),_:2},1032,["class"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})],64))}}),we=oe(ce,[["__scopeId","data-v-0f69e320"]]);export{we as default};
