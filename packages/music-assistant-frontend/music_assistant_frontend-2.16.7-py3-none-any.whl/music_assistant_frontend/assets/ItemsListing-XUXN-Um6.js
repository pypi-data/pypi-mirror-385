import{C as _e}from"./Container-CEbFgC5b.js";import{T as et}from"./Toolbar-Ba4dAxS1.js";import{B as Ae,C as tt,Q as at,a3 as it,b,H as $e,n as D,S as lt,I as st,a6 as ot,K as nt,ao as ut,aj as rt,d as W,h as m,o as n,aB as ue,u as v,b1 as M,v as se,bx as Ce,r as $,O as j,bO as K,w as c,e as f,c as p,aX as X,aG as ct,bN as Te,bH as oe,b5 as I,t as y,z as mt,M as C,j as O,a as R,aY as dt,be as U,bP as ft,bf as vt,bQ as Fe,bI as xe,bR as re,bS as Ve,bK as Pe,af as yt,x as ht,bm as bt,V as pt,k as kt,bz as Y,s as S,bD as wt,bA as gt,as as It,q as ie,ae as H,m as St,ap as be,bT as Bt,p as pe,a$ as z,y as At,aR as $t,bu as Ct,F as ke,g as we,bv as ge,bw as le,aV as Tt,f as Ft}from"./index-Bn2Tzsay.js";import{B as De}from"./Button-r9Wpw3CQ.js";import{L as xt}from"./ListItem-BNbxxrdg.js";import{_ as ne,V as Oe}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-DCLVCnPO.js";import{M as Le}from"./MediaItemThumb-B7hfZSf2.js";import{V as Q}from"./VBtn-BQk37KYJ.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Vt,P as Pt}from"./PanelviewItemCompact-By5cXXTW.js";import{V as Dt}from"./VSpacer-ygjaGObn.js";import{V as Ot}from"./VTextField-fPA0WAHx.js";import{a as Lt,V as Et}from"./VInfiniteScroll-DvbiA0kw.js";import{V as Ie,a as Se}from"./VRow-CNVApy9v.js";import{V as Mt}from"./VVirtualScroll-B56qZ1Y0.js";import{V as Be}from"./VAlert-Bj5fXNhB.js";const Ee=Symbol.for("vuetify:v-item-group"),Rt=tt({...nt(),...ot({selectedClass:"v-item--selected"}),...st(),...lt()},"VItemGroup"),Me=Ae()({name:"VItemGroup",props:Rt(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:w}=i;const{themeClasses:g}=at(e),{isSelected:l,select:k,next:B,prev:T,selected:u}=it(e,Ee);return()=>b(e.tag,{class:D(["v-item-group",g.value,e.class]),style:$e(e.style)},{default:()=>[w.default?.({isSelected:l,select:k,next:B,prev:T,selected:u.value})]})}}),L=Ae()({name:"VItem",props:ut(),emits:{"group:selected":e=>!0},setup(e,i){let{slots:w}=i;const{isSelected:g,select:l,toggle:k,selectedClass:B,value:T,disabled:u}=rt(e,Ee);return()=>w.default?.({isSelected:g.value,selectedClass:B.value,select:l,toggle:k,value:T.value,disabled:u.value})}}),Re=W({__name:"FavoriteButton",props:{item:{}},setup(e){const i=e;return(w,g)=>(n(),m(De,ue(i,{variant:"icon",icon:e.item?.favorite?"mdi-heart":"mdi-heart-outline",title:w.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=l=>v(se).toggleFavorite(e.item)),g[1]||(g[1]=M(()=>{},["prevent"])),g[2]||(g[2]=M(()=>{},["stop"]))]}),null,16,["icon","title"]))}}),Kt={key:0,class:"media-thumb listitem-media-thumb"},Nt={key:1,class:"media-thumb listitem-media-thumb"},Yt={key:0},zt={key:0},Gt={key:0,class:"line-clamp-1"},Ht={key:1},Xt={key:0},jt={key:1},Ut={key:2},Qt={key:3},Wt={key:4},qt={key:5},Jt={key:6},Zt={key:7},_t={key:5},ea={key:6},ta={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},aa=W({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(e,{emit:i}){const{t:w}=Ce(),g=$(!1),l=e,k=j(()=>{if(!("provider_mappings"in l.item))return"";for(const d of l.item.provider_mappings)if(d.audio_format&&d.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(d.audio_format.content_type)&&(d.audio_format.sample_rate>48e3||d.audio_format.bit_depth>16))return`${d.audio_format.sample_rate/1e3}kHz ${d.audio_format.bit_depth} bits`;return""}),B=i,T=function(d){const h=d;re(l.item,h.clientX,h.clientY,l.parentItem)},u=function(d){if(l.showCheckboxes)return;const h=d;Ve(l.item,h.clientX,h.clientY,l.parentItem)},F=function(d){l.showCheckboxes||Pe(l.item,d.clientX,d.clientY,l.parentItem)};return(d,h)=>(n(),m(xt,{link:"","show-menu-btn":e.showMenu,class:D({unavailable:!e.isAvailable}),onClick:M(u,["stop"]),onMenu:M(T,["stop"])},{prepend:c(()=>[e.showCheckboxes?(n(),p("div",Kt,[b(Oe,{"model-value":e.isSelected,onClick:h[0]||(h[0]=M(()=>{},["stop"])),"onUpdate:modelValue":h[1]||(h[1]=A=>{A!=null&&B("select",e.item,A)})},null,8,["model-value"])])):(n(),p("div",Nt,[b(Le,{size:"50",item:e.isAvailable?e.item:void 0,class:D({dimmed:g.value})},null,8,["item","class"])])),!e.showCheckboxes&&e.item.is_playable?(n(),m(Q,{key:2,class:D({hidden:!g.value}),icon:"mdi-play",variant:"text",size:"small",style:{position:"absolute",left:"14px",bottom:"12px",color:"white","font-size":"18px"},onClick:M(F,["stop"]),onMouseenter:h[2]||(h[2]=A=>g.value=!0),onMouseleave:h[3]||(h[3]=A=>g.value=!1)},null,8,["class"])):f("",!0)]),title:c(()=>[e.item.media_type==v(C).FOLDER?(n(),p("span",Yt,[R("span",null,y(v(Fe)(e.item,v(w))),1)])):(n(),p("span",{key:1,class:D({"is-playing":e.isPlaying})},[I(y(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),p("span",zt,"("+y(e.item.version)+")",1)):f("",!0)],2)),e.item&&e.item.metadata?(n(),m(v(oe),{key:2,location:"bottom"},{activator:c(({props:A})=>[v(xe)(e.item.metadata.explicit||!1)?(n(),m(O,ue({key:0},A,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):f("",!0)]),default:c(()=>[R("span",null,y(d.$t("tooltip.explicit")),1)]),_:1})):f("",!0)]),subtitle:c(()=>[e.item.media_type==v(C).TRACK&&"provider_mappings"in e.item?(n(),p("div",Gt,[b(Me,null,{default:c(()=>["artists"in e.item?(n(),m(L,{key:0},{default:c(()=>[I(y(v(U)(e.item.artists,2)),1)]),_:1})):f("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),m(L,{key:1},{default:c(()=>[I(" • "+y(e.item.album.name),1)]),_:1})):f("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),m(L,{key:2},{default:c(()=>[b(O,{style:{"margin-left":"5px"},icon:"md:album"}),I(" "+y(e.item.disc_number),1)]),_:1})):f("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),m(L,{key:3},{default:c(()=>[b(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),I(" "+y(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),m(L,{key:4},{default:c(()=>[b(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),I(" "+y(e.item.position),1)]),_:1})):f("",!0)]),_:1})])):e.item.media_type==v(C).ALBUM&&"year"in e.item?(n(),p("div",Ht,[e.item.album_type!=v(ft).UNKNOWN?(n(),p("span",Xt,y(d.$t("album_type."+e.item.album_type))+" • ",1)):f("",!0),R("span",null,y(v(U)(e.item.artists)),1),e.item.year?(n(),p("span",jt," • "+y(e.item.year),1)):f("",!0)])):"artists"in e.item&&e.item.artists?(n(),p("div",Ut,y(v(U)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),p("div",Qt,y(e.item.owner),1)):"authors"in e.item&&e.item.authors?(n(),p("div",Wt,y(e.item.authors.join(" / ")),1)):"publisher"in e.item&&e.item.publisher?(n(),p("div",qt,y(e.item.publisher),1)):"metadata"in e.item&&e.item.metadata?.description&&[v(C).RADIO,v(C).PLAYLIST,v(C).FOLDER].includes(e.item.media_type)?(n(),p("div",Jt,y(v(vt)(e.item.metadata.description,150)),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),p("div",Zt,y(d.$t(e.item.media_type)),1)):f("",!0)]),append:c(()=>[e.isPlaying?(n(),m(ne,{key:0,"show-badge":v(X)("bp7")},null,8,["show-badge"])):f("",!0),k.value?(n(),m(ct,{key:1,src:v(Te),width:"30",class:D(d.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:c(()=>[b(v(oe),{activator:"parent",location:"bottom"},{default:c(()=>[I(y(k.value),1)]),_:1})]),_:1},8,["src","class"])):f("",!0),v(X)("bp2")&&e.showProvider?(n(),m(mt,{key:2,domain:e.item.media_type==v(C).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):f("",!0),"fully_played"in e.item&&e.item.fully_played?(n(),m(O,{key:3,title:d.$t("item_fully_played")},{default:c(()=>[...h[4]||(h[4]=[I("mdi-check",-1)])]),_:1},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(n(),m(O,{key:4,title:d.$t("item_in_progress")},{default:c(()=>[...h[5]||(h[5]=[I("mdi-clock-fast",-1)])]),_:1},8,["title"])):f("",!0),v(X)("bp3")&&"favorite"in e.item&&e.showFavorite&&!d.$vuetify.display.mobile?(n(),p("div",_t,[b(Re,{item:e.item},null,8,["item"])])):f("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&v(X)("bp0")?(n(),p("div",ea,[R("div",null,[R("span",ta,y(v(dt)(e.item.duration)),1)])])):f("",!0)]),_:1},8,["show-menu-btn","class"]))}}),ia=ce(aa,[["__scopeId","data-v-cf65a966"]]),la={key:0},sa=["src"],oa={key:0},na=W({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showTrackNumber:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(e,{emit:i}){const w=e,g=j(()=>{for(const u of w.item.provider_mappings)if(u.audio_format&&u.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(u.audio_format.content_type)&&(u.audio_format.sample_rate>48e3||u.audio_format.bit_depth>16))return`${u.audio_format.sample_rate/1e3}kHz ${u.audio_format.bit_depth} bits`;return""}),l=i,k=function(u){if(w.showCheckboxes)return;const F="clientX"in u?u.clientX:u.touches[0].clientX,d="clientY"in u?u.clientY:u.touches[0].clientY;re(w.item,F,d,w.parentItem)},B=function(u){if(w.showCheckboxes){l("select",w.item,!w.isSelected);return}Ve(w.item,u.clientX,u.clientY,w.parentItem)},T=function(u){w.showCheckboxes||Pe(w.item,u.clientX,u.clientY,w.parentItem)};return(u,F)=>{const d=gt("hold");return n(),m(Vt,null,{default:c(({isHovering:h,props:A})=>[yt((n(),m(ht,ue(A,{tile:"",hover:"",class:["panel-item",{unavailable:!e.isAvailable}],onClick:B,onContextmenu:M(k,["right","prevent"])}),{default:c(()=>[e.showCheckboxes?(n(),m(bt,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?u.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:c(()=>[b(Oe,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):f("",!0),b(Le,{item:e.isAvailable?e.item:void 0,style:{height:"auto"}},null,8,["item"]),b(pt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:c(()=>[b(kt,null,{default:c(()=>[e.item.media_type==v(C).FOLDER?(n(),p("span",la,[R("span",null,y(v(Fe)(e.item,u.$t)),1)])):(n(),p("span",{key:1,class:D({"is-playing":e.isPlaying})},y(e.item.name),3)),"version"in e.item&&e.item.version?(n(),p("span",{key:2,class:D({"is-playing":e.isPlaying})}," - "+y(e.item.version),3)):f("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),m(Y,{key:0,class:"line-clamp-1"},{default:c(()=>[I(y(v(U)(e.item.artists,1)),1)]),_:1})):f("",!0),"authors"in e.item&&e.item.authors?(n(),m(Y,{key:1,class:"line-clamp-1"},{default:c(()=>[I(y(e.item.authors.join(" / ")),1)]),_:1})):"publisher"in e.item&&e.item.publisher?(n(),m(Y,{key:2,class:"line-clamp-1"},{default:c(()=>[I(y(e.item.publisher),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),m(Y,{key:3,class:"line-clamp-1"},{default:c(()=>[I(y(e.item.owner),1)]),_:1})):e.showMediaType?(n(),m(Y,{key:4,class:"line-clamp-1"},{default:c(()=>[I(y(u.$t(e.item.media_type)),1)]),_:1})):(n(),m(Y,{key:5,class:"line-clamp-1"}))]),_:1}),e.isPlaying&&!e.showActions?(n(),m(ne,{key:1,"icon-style":"position: absolute; right: 5px; bottom: 5px","show-badge":!1})):f("",!0),(h||v(S).isTouchscreen)&&e.isAvailable&&e.item.is_playable?(n(),m(Q,{key:2,icon:"mdi-play",color:"primary",fab:"",style:$e(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:M(T,["stop"])},null,8,["style"])):f("",!0),e.showActions?(n(),m(wt,{key:3,class:"panel-item-actions"},{default:c(()=>[b(Me,{style:{padding:"0"}},{default:c(()=>[v(xe)(e.item.metadata.explicit||!1)?(n(),m(L,{key:0},{default:c(()=>[b(O,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):f("",!0),g.value?(n(),m(L,{key:1},{default:c(()=>[b(O,{class:D(u.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:c(()=>[R("img",{src:v(Te),width:"30"},null,8,sa),b(oe,{activator:"parent",location:"bottom"},{default:c(()=>[I(y(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):f("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),m(L,{key:2},{default:c(()=>[b(O,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),p("span",oa,y(e.item.disc_number)+"/",1)):f("",!0),I(y(e.item.track_number),1)]),_:1})):"position"in e.item&&e.item.position?(n(),m(L,{key:3},{default:c(()=>[b(O,{size:"small",icon:"mdi-music-circle-outline"}),I(" "+y(e.item.position),1)]),_:1})):f("",!0),v(X)("bp3")?(n(),m(L,{key:4},{default:c(()=>[b(Re,{item:e.item},null,8,["item"])]),_:1})):f("",!0)]),_:1}),e.isPlaying?(n(),m(ne,{key:0,"show-badge":!1})):f("",!0),b(Dt),h||u.$vuetify.display.mobile?(n(),m(De,{key:1,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:M(k,["stop"])})):f("",!0)]),_:2},1024)):f("",!0)]),_:2},1040,["class"])),[[d,k]])]),_:1})}}}),ua=ce(na,[["__scopeId","data-v-bb3ba95c"]]),ra={key:0},ca={key:2},ma=W({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(se.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},onTitleClick:{type:Function,default:void 0}},setup(e){const i=e,w=Ft(),{t:g}=Ce(),l=$({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),k=$("list"),B=$(!1),T=$(!1),u=$([]),F=$([]),d=$(!1),h=$([]),A=$(!1),V=$(!1),N=$(!0),E=$(!1),G=$(!1),q=$(!1),me=function(){l.value.search="",B.value=!1},J=function(){be(()=>{document.getElementById("searchInput")?.focus()})},Ke=function(){B.value?me():(B.value=!0,J())},Z=function(){if(i.onTitleClick){i.onTitleClick();return}N.value=!N.value;const t=`${i.path}.${i.itemtype}`;localStorage.setItem(`expand.${t}`,N.value.toString())},_=function(t){k.value=t;const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`viewMode.${s}`,t)},Ne=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const t=l.value.favoritesOnly?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`favoriteFilter.${s}`,t),P(void 0,void 0,!0)},Ye=function(){l.value.libraryOnly=!l.value.libraryOnly;const t=l.value.libraryOnly?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`libraryFilter.${s}`,t),P(!0,void 0,!0)},ze=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const t=l.value.albumArtistsFilter?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`albumArtistsFilter.${s}`,t),P(void 0,void 0,!0)},ee=function(t){return h.value.includes(t)},te=function(t,s){if(S.activePlayer?.playback_state!=Tt.PLAYING)return!1;const a=S.curQueueItem?.media_item;if(!a)return!1;switch(s){case"tracks":return t.item_id===a.item_id;case"albums":return"album"in a?t.item_id===a.album.item_id:!1;case"artists":return"artists"in a?Array.isArray(a.artists)&&a.artists.some(o=>o.item_id===t.item_id):!1;case"radios":return t.item_id===a.item_id;case"podcasts":return"podcast"in a?t.item_id===a.podcast.item_id:!1;case"podcastepisodes":return t.item_id===a.item_id;default:return!1}},ae=function(t,s){if(s)h.value.includes(t)||h.value.push(t);else for(let a=0;a<h.value.length;a++)h.value[a]===t&&h.value.splice(a,1)},Ge=function(){V.value&&(h.value=[]),V.value=!V.value},He=function(){P(!0,!0)},Xe=function(){l.value.search="",B.value=!1,P(void 0,void 0,!0)},je=function(t){t!==void 0&&(l.value.sortBy=t);const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`sortBy.${s}`,l.value.sortBy),P(void 0,void 0,!0)},Ue=function(t){l.value.albumType?.includes(t)?l.value.albumType=l.value.albumType?.filter(a=>a!==t):(l.value.albumType=l.value.albumType||[],l.value.albumType.push(t));const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`albumType.${s}`,l.value.albumType.join(",")),P(void 0,void 0,!0)},Qe=function(){S.globalSearchTerm=l.value.search,i.itemtype=="artists"?S.globalSearchType=C.ARTIST:i.itemtype=="albums"?S.globalSearchType=C.ALBUM:i.itemtype=="tracks"?S.globalSearchType=C.TRACK:i.itemtype=="playlists"?S.globalSearchType=C.PLAYLIST:i.itemtype=="audiobooks"?S.globalSearchType=C.AUDIOBOOK:i.itemtype=="podcasts"?S.globalSearchType=C.PODCAST:i.itemtype=="radios"&&(S.globalSearchType=C.RADIO),w.push({name:"search"})},de=async function({done:t}){if(E.value){t("empty");return}await P(void 0,void 0,void 0,l.value.offset+i.limit),t("ok")},We=async function(){for(;!E.value;)await de({done:function(){}})},fe=j(()=>{var t=!1;return l.value.search&&l.value.search.length!==0&&(t=!0),t}),ve=j(()=>B.value&&N.value);It(()=>{ve.value||(T.value=!1)});const qe=j(()=>{if(i.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:Z,overflowAllowed:!1}];const t=[];return i.showSelectButton!==!1&&(V.value&&t.push({label:"tooltip.select_all",icon:"mdi-select-all",action:he}),t.push({label:"tooltip.select_items",icon:V.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Ge,active:V.value})),i.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Ye,active:l.value.libraryOnly}),i.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ne,active:l.value.favoritesOnly}),i.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:ze,active:l.value.albumArtistsFilter}),i.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:d.value,subItems:["album","single","ep","compilation","live","soundtrack","unknown"].map(s=>({label:`album_type.${s}`,selected:l.value.albumType?.includes(s),action:()=>{Ue(s)}}))}),(i.showRefreshButton!==!1||A.value)&&t.push({label:A.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:He,active:A.value,disabled:d.value}),i.sortKeys?.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:i.sortKeys.length<=1||d.value,subItems:i.sortKeys.map(s=>({label:`sort.${s}`,selected:l.value.sortBy==s,action:()=>{je(s)}}))}),i.showSearchButton!==!1&&t.push({label:fe.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Ke,active:fe.value,disabled:d.value}),t.push({label:"tooltip.toggle_view_mode",icon:k.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:k.value=="list",action:()=>{_("list")}},{label:"view.panel",icon:"mdi-grid",selected:k.value=="panel",action:()=>{_("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:k.value=="panel_compact",action:()=>{_("panel_compact")}}]}),i.extraMenuItems?.length&&t.push(...i.extraMenuItems),i.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:Z}),t}),P=async function(t=!1,s=!1,a=!1,o=0){if(!d.value){if(d.value=!0,a&&i.loadPagedData!=null&&(t=!0),(t||s)&&(o=0,E.value&&(q.value=!0),E.value=!1,G.value=!1,A.value=!1),l.value.offset=o,l.value.limit=i.limit,l.value.refresh=s,i.loadPagedData!=null){const r=await i.loadPagedData(l.value);l.value.offset?u.value.push(...r):u.value=r,Math.abs(r.length-i.limit)>10&&(E.value=!0)}else if(i.loadItems!=null){(!G.value||s)&&(F.value=await i.loadItems(l.value),G.value=!0);const r=Ze(F.value,l.value);l.value.offset?u.value.push(...r):u.value=r,E.value=r.length<i.limit}l.value.refresh=!1,d.value=!1,q.value=!1}},Je=async function(){const t=`${i.path}.${i.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?k.value=s:i.itemtype=="artists"||i.itemtype=="albums"?k.value="panel":k.value="list";const a=localStorage.getItem(`sortBy.${t}`);if(a&&a!=="null"&&i.sortKeys.includes(a)?l.value.sortBy=a:l.value.sortBy=i.sortKeys[0],i.showFavoritesOnlyFilter!==!1){const o=localStorage.getItem(`favoriteFilter.${t}`);o&&o=="true"&&(l.value.favoritesOnly=!0)}if(i.showLibraryOnlyFilter!==!1){const o=localStorage.getItem(`libraryFilter.${t}`);o&&o=="true"&&(l.value.libraryOnly=!0)}if(i.showAlbumArtistsOnlyFilter!==!1){const o=localStorage.getItem(`albumArtistsFilter.${t}`);o&&(l.value.albumArtistsFilter=o=="true")}if(i.allowCollapse!==!1){const o=localStorage.getItem(`expand.${t}`);o&&(N.value=o=="true")}if(i.showAlbumTypeFilter===!0){const o=localStorage.getItem(`albumType.${t}`);o&&(l.value.albumType=o.split(","))}if(i.restoreState){let o=`search.${t}`;i.parentItem&&(o+=i.parentItem.item_id);const r=localStorage.getItem(o);r&&r!=="null"&&(l.value.search=r)}},ye=function(t){S.dialogActive||d.value||(t.key==="Escape"&&me(),!T.value&&(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),he()):!T.value&&t.key=="Backspace"?J():!T.value&&t.key.length==1&&(B.value=!0,J())))};i.allowKeyHooks&&(document.addEventListener("keydown",ye),ie(()=>{document.removeEventListener("keydown",ye)})),i.restoreState&&ie(()=>{const t=i.path||i.itemtype,s=document.querySelector("#cont");S.prevState={path:t,scrollPos:s?.scrollTop||0,pagedItems:u.value,allItems:F.value,allItemsReceived:E.value,initialDataReceived:G.value,params:l.value}}),H(()=>l.value.search,t=>{t&&(B.value=!0),P(void 0,void 0,!0);let s=`search.${i.path}.${i.itemtype}`;i.parentItem&&(s+=i.parentItem.item_id),localStorage.setItem(s,l.value.search)}),H(()=>i.path,t=>{d.value!=!0&&(u.value=[],F.value=[],P(!0))}),H(()=>i.parentItem,()=>{d.value!=!0&&(F.value=[],A.value=!0)},{deep:!0}),H(()=>i.limit,t=>{l.value.limit=t}),H(()=>i.updateAvailable,t=>{d.value||(A.value=t)},{immediate:!0}),St(async()=>{Je();const t=i.path||i.itemtype;i.restoreState&&S.prevState?.path==t?(l.value=S.prevState.params,u.value=S.prevState.pagedItems,F.value=S.prevState.allItems,E.value=S.prevState.allItemsReceived,G.value=S.prevState.initialDataReceived,be(()=>{const a=document.getElementById("cont");a&&Bt(a,S.prevState.scrollPos,50)}),d.value=!1):P(!0),pe.on("clearSelection",()=>{h.value=[],V.value=!1});const s=se.subscribe_multi([z.MEDIA_ITEM_UPDATED,z.MEDIA_ITEM_DELETED,z.MEDIA_ITEM_PLAYED],a=>{if(a.event==z.MEDIA_ITEM_DELETED)u.value=u.value.filter(o=>o.uri!=a.object_id);else if(a.event==z.MEDIA_ITEM_UPDATED){const o=u.value.findIndex(r=>r.uri==a.object_id);o>=0&&(u.value[o]=a.data)}else if(a.event==z.MEDIA_ITEM_PLAYED){const o=u.value.findIndex(r=>r.uri==a.object_id);o>=0&&("fully_played"in u.value[o]&&(u.value[o].fully_played=a.data.fully_played),"resume_position_ms"in u.value[o]&&(u.value[o].resume_position_ms=a.data.seconds_played*1e3))}});ie(()=>{pe.off("clearSelection"),s()})});const x=function(t,s=!1){return t?"translation_key"in t&&t.translation_key&&t.name?g(t.translation_key,[t.name]):"translation_key"in t&&t.translation_key?g(t.translation_key):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},Ze=function(t,s){let a=[];if(s.search){const o=s.search.toLowerCase();for(const r of t)(r.name.toLowerCase().includes(o)||"album"in r&&r.album?.name.toLowerCase().includes(o)||"artists"in r&&r.artists&&r.artists.length&&r.artists[0].name.toLowerCase().includes(o))&&a.push(r)}else a=[...t];return s.sortBy=="name"&&a.sort((o,r)=>x(o).localeCompare(x(r),void 0,{numeric:!0})),s.sortBy=="sort_name"&&a.sort((o,r)=>x(o,!0).localeCompare(x(r,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&a.sort((o,r)=>x(r).localeCompare(x(o),void 0,{numeric:!0})),s.sortBy=="sort_name_desc"&&a.sort((o,r)=>x(r,!0).localeCompare(x(o,!0),void 0,{numeric:!0})),s.sortBy=="album"&&a.sort((o,r)=>x(o.album).localeCompare(x(r.album),void 0,{numeric:!0})),s.sortBy=="artist"&&a.sort((o,r)=>x(o.artists[0]).localeCompare(x(r.artists[0]))),s.sortBy=="track_number"&&(a.sort((o,r)=>(o.track_number||0)-(r.track_number||0)),a.sort((o,r)=>(o.disc_number||0)-(r.disc_number||0))),s.sortBy=="position"&&a.sort((o,r)=>(o.position||0)-(r.position||0)),s.sortBy=="position_desc"&&a.sort((o,r)=>(r.position||0)-(o.position||0)),s.sortBy=="year"&&a.sort((o,r)=>(o.year||0)-(r.year||0)),s.sortBy=="year_desc"&&a.sort((o,r)=>(r.year||0)-(o.year||0)),s.sortBy=="recent"&&a.sort((o,r)=>(r.timestamp_added||0)-(o.timestamp_added||0)),s.sortBy=="duration"&&a.sort((o,r)=>(o.duration||0)-(r.duration||0)),s.sortBy=="duration_desc"&&a.sort((o,r)=>(r.duration||0)-(o.duration||0)),s.sortBy=="provider"&&a.sort((o,r)=>o.provider.localeCompare(r.provider)),s.favoritesOnly&&(a=a.filter(o=>o.favorite)),s.albumType&&s.albumType.length>0&&(a=a.filter(o=>s.albumType?.includes(o.album_type))),a.slice(s.offset,s.offset+s.limit)},he=async function(){let t=!0;(i.total||F.value.length)>250&&(t=await new Promise(a=>{confirm(g("select_all_confirmation"))?a(!0):a(!1)})),t&&(await We(),h.value=u.value,V.value=!0)};return(t,s)=>e.hideOnEmpty&&u.value.length==0?f("",!0):(n(),p("section",ra,[b(et,{icon:e.icon,title:e.title,count:l.value.search?u.value.length:e.total||F.value.length,color:"transparent","menu-items":qe.value,onTitleClicked:Z},{title:c(()=>[$t(t.$slots,"title",{},()=>[I(y(e.title),1)],!0)]),_:3},8,["icon","title","count","menu-items"]),b(At),ve.value?(n(),m(Ot,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":s[0]||(s[0]=a=>l.value.search=a),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=a=>T.value=!0),onBlur:s[2]||(s[2]=a=>T.value=!1),"onClick:clear":Xe},null,8,["modelValue","label"])):f("",!0),N.value?(n(),m(_e,{key:1,variant:k.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:c(()=>[d.value?(n(),m(Ct,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):f("",!0),!q.value&&!(u.value.length==0&&E.value)?(n(),m(Lt,{key:1,onLoad:de,mode:e.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:c(()=>[k.value=="panel"?(n(),m(Ie,{key:0},{default:c(()=>[(n(!0),p(ke,null,we(u.value,a=>(n(),m(Se,{key:a.uri,cols:"12",class:D(`col-${v(ge)(t.$vuetify.display.width)}`)},{default:c(()=>[b(ua,{item:a,"is-selected":ee(a),"show-checkboxes":V.value,"show-actions":["tracks","albums","albumtracks"].includes(e.itemtype),"show-track-number":e.showTrackNumber,"is-available":v(le)(a),"is-playing":te(a,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","show-actions","show-track-number","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),k.value=="panel_compact"?(n(),m(Ie,{key:1},{default:c(()=>[(n(!0),p(ke,null,we(u.value,a=>(n(),m(Se,{key:a.uri,cols:"12",class:D(`col-${v(ge)(t.$vuetify.display.width)}`)},{default:c(()=>[b(Pt,{item:a,"is-selected":ee(a),"show-checkboxes":V.value,"is-available":v(le)(a),"is-playing":te(a,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),k.value=="list"?(n(),m(Mt,{key:2,"item-height":70,height:"100%",items:u.value,style:{height:"100%",overflow:"hidden"}},{default:c(({item:a})=>[b(ia,{item:a,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":a.is_playable,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":V.value,"is-selected":ee(a),"is-available":v(le)(a),"is-playing":te(a,e.itemtype),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:ae},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","is-playing","show-details","parent-item"])]),_:1},8,["items"])):f("",!0)]),_:1},8,["mode","load-more-text"])):f("",!0),!d.value&&u.value.length==0?(n(),p("div",ca,[!d.value&&u.value.length==0&&(l.value.search||l.value.favoritesOnly)?(n(),m(Be,{key:0,title:t.$t("no_content_filter")},{default:c(()=>[l.value.search?(n(),m(Q,{key:0,style:{"margin-top":"15px"},onClick:Qe},{default:c(()=>[I(y(t.$t("try_global_search")),1)]),_:1})):f("",!0)]),_:1},8,["title"])):!d.value&&u.value.length==0?(n(),m(Be,{key:1},{default:c(()=>[I(y(t.$t("no_content")),1)]),_:1})):f("",!0)])):f("",!0),b(Et,{"model-value":h.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:c(()=>[b(Q,{color:"primary",variant:"text",onClick:s[3]||(s[3]=a=>v(re)(h.value,a.clientX,a.clientY,e.parentItem))},{default:c(()=>[I(y(t.$t("actions")),1)]),_:1})]),default:c(()=>[R("span",null,y(t.$t("items_selected",[h.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):f("",!0)]))}}),Ta=ce(ma,[["__scopeId","data-v-058c19ad"]]);export{Ta as I};
