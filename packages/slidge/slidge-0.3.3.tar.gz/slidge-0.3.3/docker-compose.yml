services:
  superduper:
    build:
      context: .
      target: dev
    network_mode: service:prosody
    volumes:
      - ./slidge:/io/slidge
      - ./superduper:/io/superduper
      - ./dev/assets:/io/superduper/assets
      - ./persistent:/var/lib/slidge/slidge.localhost
      - ./dev/confs/slidge-dev.ini:/etc/slidge/slidge.ini
    depends_on:
      - prosody

  prosody:
    image: codeberg.org/slidge/prosody-slidge-dev:latest
    ports:
      - "127.0.0.1:5281:5281"  # prosody's https://...
      - "127.0.0.1:5222:5222"  # XMPP
