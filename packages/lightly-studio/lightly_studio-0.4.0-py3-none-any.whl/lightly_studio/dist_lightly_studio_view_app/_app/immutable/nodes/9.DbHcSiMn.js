import"../chunks/CWj6FrbW.js";import{p as Se,al as I,ab as ze,u as xe,g as e,b as d,Z as h,c as v,s as V,f as R,r as f,t as le,a as ye,w as He,m as _e,am as Ne}from"../chunks/C3xJX0nD.js";import{f as T,c as D,a as l}from"../chunks/CAPx0Bfm.js";import{i as W,a as Te,s as ve}from"../chunks/DmGM9V9Q.js";import{a as We,S as qe,e as Fe,s as oe,u as Oe,k as je,b as Ke}from"../chunks/DthpwYR_.js";import{p as P,r as Qe,b as ke}from"../chunks/xQhUoIl9.js";import{r as Re,u as Ve}from"../chunks/DyIcJj6J.js";import{h as Ae,i as te,s as Be,j as Ge,k as Ee,l as Ye,n as Ie,L as Ze}from"../chunks/CWuDkrMZ.js";import{S as De}from"../chunks/BiGQqqJP.js";import{u as Je}from"../chunks/BOmrKuMn.js";import"../chunks/ClzkJBWk.js";import"../chunks/BaFFwDFr.js";import"../chunks/DUtlYNuP.js";import"../chunks/69_IOA4Y.js";import"../chunks/D8ZGoCPm.js";import"../chunks/gBp1tBnA.js";import{I as Ue}from"../chunks/CP9M7pei.js";import{s as Z}from"../chunks/DoEId1MK.js";import{s as Xe}from"../chunks/CpbA3HU7.js";const $e=Be(),et=Ge();var tt=T("<div><!></div>"),it=T("<div><!></div>"),at=T("<div><!></div>"),rt=T("<div><!></div>"),st=T("<div><!></div>"),ot=T("<div><!> <div><!> <!></div> <!></div>");function lt(q,i){Se(i,!0);let m=P(i,"height",3,"100%"),k=P(i,"width",3,"100%"),p=P(i,"stickyIndices",19,()=>[]),M=P(i,"overScan",3,1),b=P(i,"marginLeft",3,0),o=P(i,"marginTop",3,0),O=P(i,"layout",3,"vertical"),w=P(i,"scrollPosition",15,0),ie=P(i,"scrollAlignment",3,"auto"),z=P(i,"scrollBehavior",3,"auto"),fe=P(i,"getKey",3,t=>t),ae=Qe(i,["$$slots","$$events","$$legacy","itemCount","itemSize","height","width","stickyIndices","overScan","marginLeft","marginTop","layout","scrollPosition","scrollAlignment","scrollBehavior","getKey","onscroll","header","item","placeholder","footer"]),_=I(void 0),j=I(ze(w())),re=I(0),A=I(0),ne=I(0),de=I(0),J=I(0),U=I(0),B=I(ze([])),K=!1,X=!1,G=I(!1);function me(t,r=ie(),g=z()){u(ue(t,r),g)}function he(t,r=z()){u(t,r)}const ue=(t,r)=>{const g=e(c)?o()+e(re):b()+e(A),S=t*i.itemSize+g,N=S-e(L)+i.itemSize+g;let a;switch(r){case"start":a=S;break;case"center":a=S-(e(L)-i.itemSize)/2;break;case"end":a=N;break;default:a=Math.max(N,Math.min(S,w()));break}return Math.max(0,Math.min(e(ce)-e(L),a))},u=(t,r=z())=>{e(_)&&(K=!0,e(_).scrollTo({[e(c)?"top":"left"]:t,behavior:r}),K=!1)},Q=t=>{e(_)&&!K&&!X&&(K=!0,e(_).scrollTo({top:t,behavior:z()}),K=!1)},se=t=>{const r=t*i.itemSize;return`position: absolute; transform: translate3d(${e(c)?`${b()}px, ${r+o()}px`:`${e(A)+r+b()}px, ${o()}px`}, 0px); ${e(pe)} will-change: transform;`},ge=t=>{X=!0,K||(e(c)?(h(j,Math.max(0,t.currentTarget.scrollTop-e(re)),!0),w(t.currentTarget.scrollTop)):(h(j,Math.max(0,t.currentTarget.scrollLeft-e(A)),!0),w(t.currentTarget.scrollLeft)),e(C)(e(j))),$e(()=>{X=!1})};let c=d(()=>O()==="vertical"),ce=d(()=>i.itemCount*i.itemSize),pe=d(()=>e(c)?`height: ${i.itemSize}px; width: ${b()>0?`${e(U)-b()}px`:"100%"};`:`height: ${o()>0?`${e(de)-o()}px`:"100%"}; width: ${i.itemSize}px;`),L=d(()=>e(c)?e(ne):e(J));xe(()=>{e(L)&&h(B,Ae(i.itemCount,i.itemSize,e(L),M(),e(j)),!0)}),xe(()=>{e(_)&&Q(w())});let C=d(()=>et(e(L),{fast:()=>{h(G,!0)},slow:()=>{h(G,!1)}}));var $={scrollToIndex:me,scrollToPosition:he},x=ot(),F=t=>{var r;ge(t),(r=i.onscroll)==null||r.call(i,t)};We(x,t=>({onscroll:F,...ae,[qe]:t}),[()=>({position:"relative",overflow:"auto",height:typeof m()=="number"?`${m()}px`:m(),width:typeof k()!="number"?k():`${k()}px`})]);var H=v(x);{var E=t=>{var r=D(),g=R(r);{var S=a=>{var s=tt(),n=v(s);Z(n,()=>i.header),f(s),te(s,"offsetHeight",y=>h(re,y)),l(a,s)},N=a=>{var s=it();oe(s,"",{},{position:"absolute"});var n=v(s);Z(n,()=>i.header),f(s),te(s,"offsetWidth",y=>h(A,y)),l(a,s)};W(g,a=>{e(c)?a(S):a(N,!1)})}l(t,r)};W(H,t=>{i.header&&t(E)})}var ee=V(H,2);let be;var we=v(ee);{var Ce=t=>{const r=d(()=>Math.max(...p().filter(a=>a<e(B)[0])));var g=D(),S=R(g);{var N=a=>{var s=at();let n;var y=v(s);Z(y,()=>i.item,()=>({index:e(r),style:""})),f(s),le(Y=>n=oe(s,"",n,Y),[()=>({position:"sticky",top:e(c)?`${o()}px`:"0px",left:e(c)?"0px":`${b()}px`,"z-index":"1"})]),l(a,s)};W(S,a=>{e(r)>=0&&a(N)})}l(t,g)};W(we,t=>{p().length&&e(B).length&&t(Ce)})}var Pe=V(we,2);Fe(Pe,17,()=>e(B),t=>fe()(t),(t,r)=>{const g=d(()=>se(e(r)));var S=D(),N=R(S);{var a=n=>{var y=D(),Y=R(y);Z(Y,()=>i.item,()=>({index:e(r),style:e(g)})),l(n,y)},s=n=>{var y=D(),Y=R(y);Z(Y,()=>i.placeholder,()=>({index:e(r),style:e(g)})),l(n,y)};W(N,n=>{!e(G)||!i.placeholder?n(a):n(s,!1)})}l(t,S)}),f(ee);var Me=V(ee,2);{var Le=t=>{var r=D(),g=R(r);{var S=a=>{var s=rt(),n=v(s);Z(n,()=>i.footer),f(s),l(a,s)},N=a=>{var s=st();let n;var y=v(s);Z(y,()=>i.footer),f(s),le(Y=>n=oe(s,"",n,Y),[()=>({position:"absolute",top:"0px",left:`${e(A)+i.itemCount*i.itemSize+b()}px`})]),l(a,s)};W(g,a=>{e(c)?a(S):a(N,!1)})}l(t,r)};W(Me,t=>{i.footer&&t(Le)})}return f(x),ke(x,t=>h(_,t),()=>e(_)),le(t=>be=oe(ee,"",be,t),[()=>({height:e(c)?`${e(ce)}px`:"100%",width:e(c)?"100%":`${e(ce)}px`})]),te(x,"offsetHeight",t=>h(ne,t)),te(x,"clientHeight",t=>h(de,t)),te(x,"offsetWidth",t=>h(J,t)),te(x,"clientWidth",t=>h(U,t)),l(q,x),ye($)}const nt=(...q)=>{const i=Re(...q),m=Ee({...i,getNextPageParam:o=>o.nextCursor||void 0}),k=Ve(),p=()=>{k.invalidateQueries({queryKey:i.queryKey})},M=He([]);return m.subscribe(o=>{if(o.isSuccess){const O=o.data.pages.flatMap(w=>w.data);M.set(O)}}),{data:M,loadMore:()=>{_e(m).hasNextPage&&!_e(m).isFetchingNextPage&&_e(m).fetchNextPage()},query:m,refresh:p}};var dt=T('<div class="flex flex-row items-center gap-10"><!> <div class="flex-1 text-sm text-foreground"> </div></div>');function ct(q,i){Se(i,!0);const m=()=>ve(M,"$gridViewSampleRenderingStore",k),[k,p]=Te(),{gridViewSampleRenderingStore:M}=Oe();let b=d(m);var o=dt(),O=v(o);Ye(O,{get sample(){return i.item.sample},get objectFit(){return e(b)}});var w=V(O,2),ie=v(w,!0);f(w),f(o),le(()=>Xe(ie,i.item.text)),l(q,o),ye(),p()}var vt=T('<div class="flex h-full w-full items-center justify-center"><!> <div>Loading samples...</div></div>'),ft=T("<div><!></div>"),mt=T('<div class="flex justify-center p-4"><!></div>'),ht=T("<!> <!>",1),ut=T('<div class="flex flex-1 flex-col space-y-4"><div class="my-2 flex items-center space-x-4"><div class="flex-1"><div class="text-2xl font-semibold">Captions</div></div> <div class="w-4/12"><!></div></div> <!> <div class="h-full w-full flex-1 overflow-hidden"><!></div></div>');function gt(q,i){Se(i,!0);const m=()=>ve(e(O),"$data",M),k=()=>ve(fe,"$sampleSize",M),p=()=>ve(e(w),"$query",M),[M,b]=Te(),o=d(()=>nt({path:{dataset_id:i.datasetId}})),O=d(()=>e(o).data),w=d(()=>e(o).query),ie=d(()=>e(o).loadMore);let z=I(null);const{sampleSize:fe}=Je();let ae=I(0);xe(()=>{if(!e(z))return;h(ae,e(z).clientHeight,!0);const u=new ResizeObserver(()=>{e(z)&&h(ae,e(z).clientHeight,!0)});return u.observe(e(z)),()=>{u.disconnect()}});let _=d(m);const j=16,re=d(()=>k().height+j),A=d(()=>k().width),ne=d(()=>k().height),de=d(()=>e(ae)+j);var J=ut(),U=v(J),B=V(v(U),2),K=v(B);Ue(K,{}),f(B),f(U);var X=V(U,2);De(X,{class:"mb-4 bg-border-hard"});var G=V(X,2),me=v(G);{var he=u=>{var Q=vt(),se=v(Q);Ie(se,{}),Ne(2),f(Q),l(u,Q)},ue=u=>{var Q=D(),se=R(Q);{var ge=c=>{lt(c,{get itemCount(){return e(_).length},get itemSize(){return e(re)},get height(){return e(de)},class:"dark:[color-scheme:dark]",get style(){return`--sample-width: ${e(A)??""}px; --sample-height: ${e(ne)??""}px;`},item:(L,C)=>{let $=()=>C==null?void 0:C().index,x=()=>C==null?void 0:C().style;var F=ft();Ke(F,1,`pb-[${j}]`);var H=v(F);ct(H,{get item(){return e(_)[$()]}}),f(F),le(()=>oe(F,x())),l(L,F)},footer:L=>{var C=ht(),$=R(C);je($,()=>e(_).length,H=>{{let E=d(()=>!p().hasNextPage||p().isFetchingNextPage);Ze(H,{get onIntersect(){return e(ie)},get disabled(){return e(E)}})}});var x=V($,2);{var F=H=>{var E=mt(),ee=v(E);Ie(ee,{}),f(E),l(H,E)};W(x,H=>{p().isFetchingNextPage&&H(F)})}l(L,C)},$$slots:{item:!0,footer:!0}})};W(se,c=>{p().isSuccess&&e(_).length>0&&c(ge)},!0)}l(u,Q)};W(me,u=>{p().isPending&&e(_).length===0?u(he):u(ue,!1)})}f(G),ke(G,u=>h(z,u),()=>e(z)),f(J),l(q,J),ye(),b()}function Ft(q,i){const{datasetId:m}=i.data;gt(q,{get datasetId(){return m}})}export{Ft as component};
