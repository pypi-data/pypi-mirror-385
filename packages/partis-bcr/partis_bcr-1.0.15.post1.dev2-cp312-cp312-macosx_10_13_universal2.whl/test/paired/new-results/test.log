[92mcache-parameters-simu[0m            partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/ref-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/ref-results/test/simu/igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 56 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 56 / 56 v annotations (0 failed) with 9 v genes in 0.1 sec
    keeping 6 / 198 v genes
    [91mmissing[0m 17 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m11[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
    running 10 procs for 56 seqs
      info for 56 / 56 = 1.000   (removed: 0 failed)
      kept 25 (0.446) unproductive
    water time: 0.2  (ig-sw 0.1  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
    running 10 procs for 56 seqs
      info for 56 / 56 = 1.000   (removed: 0 failed)
      kept 25 (0.446) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igh/sw (0.8 sec)
    water time: 1.1  (ig-sw 1.0  processing 0.2)
  writing hmms     removed 16 genes from glfo (leaving v 6  d 18  j 4)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.7 sec)
hmm
    reading output
        read 56 hmm output lines with 56 sequences in 56 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/hmm (0.7 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/true (0.6 sec)
         infra time: 1.5
      hmm step time: 2.4
  writing hmms     removed 3  genes from glfo (leaving v 6  d 15  j 4)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.6 sec)
      total time: 5.5
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/ref-results/test/simu/igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 36 / 36 v annotations (0 failed) with 6 v genes in 0.0 sec
    keeping 5 / 64 v genes
    [91mmissing[0m 11 simulation genes (counts): [95mk[0m[91mv[0m[95m1[0m[95m-12[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-27[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-5[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-8[0m[93m03[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-9[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1D[0m[95m-39[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2[0m[95m-24[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2D[0m[95m-28[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m4[0m[95m-1[0m[93m02[0m 0  [95mk[0m[91mv[0m[95m6[0m[95m-21[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.2 sec
    running 10 procs for 36 seqs
    running 11 procs for 2 seqs
      info for 36 / 36 = 1.000   (removed: 0 failed)
      kept 14 (0.389) unproductive
    water time: 0.4  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
    running 10 procs for 36 seqs
    running 11 procs for 2 seqs
      info for 36 / 36 = 1.000   (removed: 0 failed)
      kept 14 (0.389) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igk/sw (0.7 sec)
    water time: 1.1  (ig-sw 0.8  processing 0.2)
  writing hmms     removed 2  genes from glfo (leaving v 5  d 1  j 5)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.4 sec)
hmm
    reading output
        read 36 hmm output lines with 36 sequences in 36 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/hmm (0.7 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/true (0.6 sec)
         infra time: 1.4
      hmm step time: 1.9
  writing hmms     removed 0  genes from glfo (leaving v 5  d 1  j 5)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.4 sec)
      total time: 4.6
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/ref-results/test/simu/igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
    keeping 3 / 80 v genes
    [91mmissing[0m 7 simulation genes (counts): [95ml[0m[91mv[0m[95m1[0m[95m-51[0m[93m02[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-1[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-19[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-27[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m4[0m[95m-60[0m[93m03[0m 0  [95ml[0m[91mv[0m[95m7[0m[95m-46[0m[93m04[0m 0  [95ml[0m[91mv[0m[95m8[0m[95m-61[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.2 sec
    running 10 procs for 21 seqs
      info for 21 / 21 = 1.000   (removed: 0 failed)
      kept 14 (0.667) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.2 sec
    running 10 procs for 21 seqs
      info for 21 / 21 = 1.000   (removed: 0 failed)
      kept 14 (0.667) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igl/sw (0.4 sec)
    water time: 0.6  (ig-sw 0.5  processing 0.1)
  writing hmms     removed 7  genes from glfo (leaving v 3  d 1  j 2)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.2 sec)
hmm
    reading output
        read 21 hmm output lines with 21 sequences in 21 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/hmm (0.3 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/true (0.4 sec)
         infra time: 0.8
      hmm step time: 1.2
  writing hmms     removed 0  genes from glfo (leaving v 3  d 1  j 2)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.2 sec)
      total time: 2.8
      total time: 18.5
[92mpartition-new-simu[0m               partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/ref-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/ref-results/test/simu/igh.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 56 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.2 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 56 / 56 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 25 (0.446) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 1 queries with different true and inferred net shm indel lengths: db63559ea9-igh
(0.0 sec)
        water time: 0.1
hmm
  caching all 56 naive sequences (1.1s)
    collapsed 56 queries into 50 clusters with identical naive seqs (0.0 sec)
  50 clusters with 10 procs (0.7s)
   44 clusters with 7 procs (0.7s)
   36 clusters with 5 procs (0.6s)
   31 clusters with 3 procs (0.5s)
   29 clusters with 2 procs (0.7s)
   23 clusters with 1 proc (0.8s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 4.1
getting annotations for final partition
  subcluster annotating 20 clusters with steps:  (0.7s) (0.3s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 1 queries with different true and inferred net shm indel lengths: db63559ea9-igh
(0.0 sec)

    subcluster annotation time 1.1
      total time: 6.7
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/ref-results/test/simu/igk.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.2 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.389) unproductive
  plotting performance (0.0 sec)
        water time: 0.1
hmm
  caching all 36 naive sequences (0.5s)
    collapsed 36 queries into 7 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 7
  7 clusters with 7 procs (0.3s)
   7 clusters with 5 procs (0.2s)
   7 clusters with 3 procs (0.3s)
   7 clusters with 2 procs (0.3s)
   6 clusters with 1 proc (0.4s)
       partition loop time: 1.5
getting annotations for final partition
  subcluster annotating 6 clusters with steps:  (0.3s) (0.3s) (0.2s)   plotting performance (0.0 sec)

    subcluster annotation time 0.8
      total time: 3.2
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/ref-results/test/simu/igl.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.667) unproductive
  plotting performance (0.0 sec)
        water time: 0.1
hmm
  caching all 21 naive sequences (0.4s)
    collapsed 21 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 3
  3 clusters with 3 procs (0.2s)
   3 clusters with 2 procs (0.2s)
   3 clusters with 1 proc (0.2s)
       partition loop time: 0.6
getting annotations for final partition
  subcluster annotating 3 clusters with steps:  (0.3s) (0.2s) (0.2s)   plotting performance (0.0 sec)

    subcluster annotation time 0.7
      total time: 2.0
[44mcombining[0m chains
cleaning pair info for 113 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 13 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 8 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 4  [95mk[0m 4
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 3 total unpaired (in families with no (well-)paired seqs): [94mh[0m 3  [95mk[0m 0
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   14 --> 15   [91m+1[0m
        [95mk[0m    6 --> 15   [91m+9[0m
    re-added unpaired seqs ([94mh[0m 4, [95mk[0m 4) to give total seqs in joint partitions: [94mh[0m 36  [95mk[0m 36
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           4
       [95mk[0m            0           0           4
    [93mwarning[0m removed 3/34 uids (leaving 31) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 5 / 36 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.964  0.663
       joint   0.907  0.740
  [95mk[0m ccfs:     purity  completeness
      single   0.949  1.000
       joint   0.963  0.594
  merge time 0.0
  need to get annotations for 7/15 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 36 sequences in 15 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.2 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 13 (0.361) unproductive
        water time: 0.0
hmm
  subcluster annotating 15 clusters with steps:  (0.5s) (0.2s) 
    subcluster annotation time 0.8
      total time: 1.0
  need to get annotations for 13/15 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 36 sequences in 15 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.389) unproductive
        water time: 0.0
hmm
  subcluster annotating 15 clusters with steps:  (0.5s) (0.2s) 
    subcluster annotation time 0.7
      total time: 0.8
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 7 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 3  [92ml[0m 4
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 4 total unpaired (in families with no (well-)paired seqs): [94mh[0m 4  [92ml[0m 0
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    7 --> 8    [91m+1[0m
        [92ml[0m    3 --> 8    [91m+5[0m
    re-added unpaired seqs ([94mh[0m 3, [92ml[0m 4) to give total seqs in joint partitions: [94mh[0m 20  [92ml[0m 21
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           3
       [92ml[0m            0           0           4
    [93mwarning[0m removed 5/22 uids (leaving 17) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 1 / 20 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 2 / 20 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.964  0.663
       joint   0.950  0.625
  [92ml[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  0.611
  merge time 0.0
  need to get annotations for 5/8 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 20 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 20 sequences in 8 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 20 / 20 v annotations (0 failed) with 4 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 20 / 20 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 12 (0.600) unproductive
        water time: 0.0
hmm
  subcluster annotating 8 clusters with steps:  (0.5s) (0.2s) 
    subcluster annotation time 0.7
      total time: 0.9
  need to get annotations for 8/8 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml: loci paired-uids
  --input-partition-fname: read best partition with 21 sequences in 8 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.2 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.667) unproductive
        water time: 0.0
hmm
  subcluster annotating 8 clusters with steps:  (0.3s) (0.2s) 
    subcluster annotation time 0.5
      total time: 0.7
  concatenating heavy chain loci:
      [94mh[0m starting with 15 annotations (36 seqs)
      [95mk[0m starting with 15 annotations (36 seqs)
      [94mh[0m adding 8 annotations (20 seqs) for total 15 (36)
      [92ml[0m starting with 8 annotations (21 seqs)
    finished with:
     [94mh[0m: 23 annotations (55 seqs)
    [93mwarning[0m added 1 / 56 missing ids as singletons to inferred partition, to match ids in true partition
   N clusters with all seqs:
        [94mh[0m   20 --> 23   [91m+3[0m
        [95mk[0m    6 --> 15   [91m+9[0m
        [92ml[0m    3 --> 8    [91m+5[0m
      total time: 30.0
[92msubset-partition-new-simu[0m        partis subset-partition --dont-write-git-info --paired-loci --paired-indir test/paired/ref-results/test/simu --max-ccf-fail-frac 0.15 --is-simu --n-subsets 2 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/subset-partition-new-simu
  note: --input-metafnames not specified, so setting to default location test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 113 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
[44mrunning subset-partition[0m 113 seqs with 2 subsets from test/paired/ref-results/test/simu/all-seqs.fa
  grouped 113 input seqs into 52 droplet groups using existing pair info (first few droplet ids: 3542bd38d8 bc11af4843 e6fa048856)
     7/113 (0.06) had no pair info
  splitting 52 droplets into 2 groups with sizes: 26 26
    isub 0: chose 26 / 52 droplets in order (after random shuffling) which had 52 / 113 seqs
    isub 1: chose 26 / 52 droplets in order (after random shuffling) which had 61 / 113 seqs
  [94misub 0:[0m [91mrun[0m partis partition --dont-write-git-info --paired-loci --max-ccf-fail-frac 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/subset-partition-new-simu/isub-0 --input-metafnames test/paired/new-results/subset-partition-new-simu/isub-0/meta.yaml --infname test/paired/new-results/subset-partition-new-simu/isub-0/input-seqs.fa
          [94misub 0:[0m log: test/paired/new-results/subset-partition-new-simu/isub-0/partition.log
  [94misub 1:[0m [91mrun[0m partis partition --dont-write-git-info --paired-loci --max-ccf-fail-frac 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/subset-partition-new-simu/isub-1 --input-metafnames test/paired/new-results/subset-partition-new-simu/isub-1/meta.yaml --infname test/paired/new-results/subset-partition-new-simu/isub-1/input-seqs.fa
          [94misub 1:[0m log: test/paired/new-results/subset-partition-new-simu/isub-1/partition.log
  concatenating heavy chain loci:
      [94mh[0m starting with 19 annotations (35 seqs)
      [95mk[0m starting with 19 annotations (36 seqs)
      [94mh[0m adding 8 annotations (19 seqs) for total 19 (35)
      [92ml[0m starting with 8 annotations (18 seqs)
    deduplicating 1 partition
      ipart 0 with 27 clusters: 53 unique vs 54 total uids (expect to remove 1)
          successfully removed 1/2 seqs from corresponding annotation
      1 uids appeared more than once (and 1 total were removed):  7d4166ae48-igh
           removed uids/from clusters with size: 1/2 (+0 singletons)
    finished with:
     [94mh[0m: 27 annotations (53 seqs)
   writing merged outputs from 2 subsets to test/paired/new-results/subset-partition-new-simu/merged-subsets
    writing combined h/l info to fasta and meta files in test/paired/new-results/subset-partition-new-simu/merged-subsets
    merging parameters from 2 subdirs (e.g. test/paired/new-results/subset-partition-new-simu/isub-0) to test/paired/new-results/subset-partition-new-simu/merged-subsets
[91mrun[0m partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/ref-results/test/simu --max-ccf-fail-frac 0.15 --is-simu --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/subset-partition-new-simu --input-metafnames test/paired/new-results/subset-partition-new-simu/merged-subsets/meta.yaml --input-partition-fname test/paired/new-results/subset-partition-new-simu/merged-subsets --continue-from-input-partition --parameter-dir test/paired/new-results/subset-partition-new-simu/merged-subsets/parameters --ignore-sw-pair-info --refuse-to-cache-parameters --ignore-default-input-metafile
        log: test/paired/new-results/subset-partition-new-simu/merged-partition.log
      total time: 112.9
[92mseed-partition-new-simu[0m          partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/ref-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m       56       32        18     0        5      11   0.196    [91m2[0m
             [95mk[0m       36       12        18     0        5      11   0.306    [91m2[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m      11       6     17    0.304
             [95mk[0m      11       1     12    0.333
             [92ml[0m       0       4      4    0.190
      taken 22, paired with taken 11 (total 33)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 17 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 17 / 17 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 17 / 17 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 8 (0.471) unproductive
        water time: 0.0
hmm
  caching all 17 naive sequences (0.4s)
    collapsed 17 queries into 17 clusters with identical naive seqs (0.0 sec)
  17 clusters with 10 procs (0.4s)
   17 clusters with 7 procs (0.4s)
   17 clusters with 5 procs (0.4s)
   17 clusters with 3 procs (0.4s)
   14 clusters with 2 procs (0.4s)
   14 clusters with 1 proc (0.6s)
       partition loop time: 2.5
getting annotations for final partition
    reading output
        read 12 hmm output lines with 17 sequences in 12 events  (0 failures)
      hmm step time: 0.4
      total time: 3.5
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 12 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 12 / 12 v annotations (0 failed) with 2 v genes in 0.2 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 12 / 12 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 7 (0.583) unproductive
        water time: 0.0
hmm
  caching all 12 naive sequences (0.3s)
    collapsed 12 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 3
  3 clusters with 3 procs (0.2s)
   3 clusters with 2 procs (0.2s)
   3 clusters with 1 proc (0.2s)
       partition loop time: 0.7
getting annotations for final partition
  subcluster annotating 2 clusters with steps:  (0.2s) (0.2s) (0.2s) 
    subcluster annotation time 0.6
      total time: 1.8
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igl.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/ref-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 4 sequences from test/paired/ref-results/test/simu/meta.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 4
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 4 / 4 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
        water time: 0.0
hmm
  caching all 4 naive sequences (0.1s)
    collapsed 4 queries into 2 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 4 --> 2
  2 clusters with 2 procs (0.2s)
   2 clusters with 1 proc (0.2s)
       partition loop time: 0.3
getting annotations for final partition
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.2
      total time: 0.8
[44mcombining[0m chains
cleaning pair info for 33 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
WARNING using errors instead of sumw2 with weight != 1.0 in Hist::fill_ibin()
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 1 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 1  [95mk[0m 0
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 4 total unpaired (in families with no (well-)paired seqs): [94mh[0m 3  [95mk[0m 1
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    8 --> 8   
        [95mk[0m    1 --> 8    [91m+7[0m
    re-added unpaired seqs ([94mh[0m 1, [95mk[0m 0) to give total seqs in joint partitions: [94mh[0m 12  [95mk[0m 11
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           1
       [95mk[0m            0           0           0
    [93mwarning[0m removed 39/56 uids (leaving 17) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 26/34 uids (leaving 8) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 1 / 12 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 3 / 12 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   1.000  0.100
       joint   1.000  0.125
    [93mwarning[0m removed 24/36 uids (leaving 12) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 25/36 uids (leaving 11) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.909  1.000
       joint   1.000  0.100
  merge time 0.0
     removed 7 unseeded clusters (of 8 total, leaving 1) from igh joint partition
  seed cluster size in best joint partition: 1, excluding seed seq: 0
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igh.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 1 sequences from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igh.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 1
  --input-partition-fname: read best partition with 1 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 1 / 1 v annotations (0 failed) with 1 v gene in 0.2 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 1 / 1 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
        water time: 0.0
hmm
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.2
      total time: 0.4
     removed 7 unseeded clusters (of 8 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 1, excluding seed seq: 0
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk
  note: adding input metafname from default location (test/paired/ref-results/test/simu/meta.yaml)
[91mrun[0m partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igk.yaml --ignore-sw-pair-info --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 1 sequences from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igk.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 1
  --input-partition-fname: read best partition with 1 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 1 / 1 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 1 / 1 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 1 (1.000) unproductive
        water time: 0.0
hmm
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.1
      total time: 0.2
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly + unpaired seqs:  kept 1 total unpaired (i.e. setting aside in order to reintegrate after paired clustering): [94mh[0m 1  [92ml[0m 0
            note: discarding unpaired seqs in families with no (well-)paired seqs (i.e. families that are all either unpaired or paired to the other/wrong light chain), rather than keeping track of them to re-add later
        discarded 5 total unpaired (in families with no (well-)paired seqs): [94mh[0m 3  [92ml[0m 2
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    2 --> 2   
        [92ml[0m    1 --> 2    [91m+1[0m
    re-added unpaired seqs ([94mh[0m 1, [92ml[0m 0) to give total seqs in joint partitions: [94mh[0m 3  [92ml[0m 2
                             new        existing
            singleton      cluster       cluster
       [94mh[0m            0           0           1
       [92ml[0m            0           0           0
  merge time 0.0
     removed 2 unseeded clusters (of 2 total, leaving 0) from igh joint partition
     removed 2 unseeded clusters (of 2 total, leaving 0) from igl joint partition
  concatenating heavy chain loci:
      [94mh[0m starting with 1 annotations (1 seqs)
      [95mk[0m starting with 1 annotations (1 seqs)
      [94mh[0m empty files
      [92ml[0m empty files
    finished with:
     [94mh[0m: 1 annotations (1 seqs)
   N clusters with all seqs:
        [94mh[0m   12 --> 1    [91m-11[0m
        [95mk[0m    2 --> 1    [91m-1[0m
      total time: 16.2
[92mget-selection-metrics-new-simu[0m   partis get-selection-metrics --dont-write-git-info --paired-loci --existing-output-run-cfg paired --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 7 6 3 3 3
      skipped 10 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 2 clusters with sizes: 7 6
      starting 2 jobs
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-0/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-1/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igh/fasttree/iclust-1/input-seqs.fa
      made 2 fasttree trees (0.2s)
    tree origins: 2 ran fasttree
    skipped 3/5 clusters smaller than 4
      setting default tau to 1 / 385 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bnw bop dkn ikm psx
      setting default tau to 1 / 385 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 9/11 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov flx ily npq
    skipped 3/5 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.3
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m partis get-selection-metrics --locus igk --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 4 clusters with sizes 7 7 3 3
      skipped 11 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 2 clusters with sizes: 7 7
      starting 2 jobs
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-0/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-1/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igk/partition-igk/fasttree/iclust-1/input-seqs.fa
      made 2 fasttree trees (0.3s)
    tree origins: 2 ran fasttree
    skipped 2/4 clusters smaller than 4
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 3/9 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bnw
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 2/9 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov
    skipped 2/4 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.4
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 2 clusters with sizes 8 3
      skipped 6 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 1 cluster with size: 8
      starting 1 jobs
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-0/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igh/fasttree/iclust-0/input-seqs.fa
      made 1 fasttree trees (0.2s)
    tree origins: 1 ran fasttree
    skipped 1/2 clusters smaller than 4
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bev bnw bop dkn ikm
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
    skipped 1/2 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m partis get-selection-metrics --locus igl --dont-write-git-info --min-selection-metric-cluster-size 3 --min-paired-cluster-size-to-read 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: By default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set).
        If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters (or, if set during partitioning, --n-final-clusters or --min-largest-cluster-size).
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 2 clusters with sizes 8 6
      skipped 6 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 2 clusters with sizes: 8 6
      starting 2 jobs
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-0/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-1/fasttree.out /Users/runner/work/partis/partis/test/paired/new-results/partition-new-simu/igh+igl/partition-igl/fasttree/iclust-1/input-seqs.fa
      made 2 fasttree trees (0.2s)
    tree origins: 2 ran fasttree
      setting default tau to 1 / 334 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 10/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bev bop dkn
      setting default tau to 1 / 334 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.3
[44mgetting combined h/l selection metrics[0m
    igh+igk: 13 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 13 annotations with N h or l ids < 3 (controlled by --min-paired-cluster-size-to-read) (keeping 2 annotation pairs)
    igh+igl: 6 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 6 annotations with N h or l ids < 3 (controlled by --min-paired-cluster-size-to-read) (keeping 2 annotation pairs)
           cons seq not observed
           less than 0.75 (3 / 8 = 0.38) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: a2238f4e9a-igh b02ee7754a-igh b1e56e40a1-igh
           cons seq not observed
           less than 0.75 (1 / 7 = 0.14) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
           less than 0.75 (2 / 7 = 0.29) of [91ml[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 1 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 665985d2d1-igk
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 4 clusters with sizes 7 7 5 3
      skipped 0 smaller than 3 (controlled by --min-selection-metric-cluster-size)
    getting trees for 3 clusters with sizes: 7 7 5
      starting 3 jobs
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out test/paired/new-results/partition-new-simu/fasttree/iclust-0/fasttree.out test/paired/new-results/partition-new-simu/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out test/paired/new-results/partition-new-simu/fasttree/iclust-1/fasttree.out test/paired/new-results/partition-new-simu/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /Users/runner/work/partis/partis/bin/FastTree-macos -gtr -nt -out test/paired/new-results/partition-new-simu/fasttree/iclust-2/fasttree.out test/paired/new-results/partition-new-simu/fasttree/iclust-2/input-seqs.fa
      made 3 fasttree trees (0.3s)
    tree origins: 3 ran fasttree
    skipped 1/4 clusters smaller than 4
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0014
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bnw bop dkn ikm psx
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0014
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: doq dst eov flx ily npq
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 9/10 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dhq eyz fnv uvx
    skipped 1/4 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/selection-metrics.yaml
      writing 10 chosen abs to test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 8.8
[92mcache-parameters-data[0m            partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results/test/parameters/data --n-max-queries 100 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/runner/hmms/996550/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after random shuffling) which had 100 / 100 seqs
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAAGATGCACGGACAA-1_contig_2' --> droplet id 'AAAGATGCACGGACAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/runner/hmms/996550 --input-metafname /tmp/runner/hmms/996550/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after random shuffling) which had 100 / 100 seqs
  --input-metafnames: added meta info for 100 sequences from /tmp/runner/hmms/996550/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   49 / 100 v annotations (51 failed) with 28 v genes in 0.2 sec
    igk:   40 / 100 v annotations (60 failed) with 18 v genes in 0.2 sec
    igl:   15 / 100 v annotations (85 failed) with 12 v genes in 0.2 sec
totals: igh 48 igk 37 igl 15
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [95mk[0m [92ml[0m
               1   0.02   [92ml[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
writing to /tmp/runner/hmms/996550/
  igh: 48 to 996550/igh.fa
  igk: 37 to 996550/igk.fa
  igl: 15 to 996550/igl.fa
writing to paired subdirs
    igh+igk:
      igh: 36 / 48 to igh+igk/igh.fa
      igk: 35 / 37 to igh+igk/igk.fa
    igh+igl:
      igh: 15 / 48 to igh+igl/igh.fa
      igl: 15 / 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/runner/hmms/996550/igh.fa --parameter-dir test/paired/new-results/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/runner/hmms/996550/meta.yaml
  --input-metafnames: added meta info for 48 sequences from /tmp/runner/hmms/996550/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 27 v genes in 0.1 sec
    keeping 23 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.2 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igh/sw (2.7 sec)
    water time: 3.1  (ig-sw 2.9  processing 0.2)
  writing hmms     removed 13 genes from glfo (leaving v 23  d 19  j 6)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(1.9 sec)
hmm
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igh/hmm (2.7 sec)
         infra time: 2.8
      hmm step time: 3.7
  writing hmms     removed 1  genes from glfo (leaving v 23  d 18  j 6)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(1.9 sec)
      total time: 11.5
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/runner/hmms/996550/igk.fa --parameter-dir test/paired/new-results/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/runner/hmms/996550/meta.yaml
  --input-metafnames: added meta info for 37 sequences from /tmp/runner/hmms/996550/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.2 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igk/sw (1.8 sec)
    water time: 2.1  (ig-sw 1.9  processing 0.2)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(1.2 sec)
hmm
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igk/hmm (1.8 sec)
         infra time: 1.9
      hmm step time: 2.4
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(1.1 sec)
      total time: 7.6
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/runner/hmms/996550/igl.fa --parameter-dir test/paired/new-results/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/runner/hmms/996550/meta.yaml
  --input-metafnames: added meta info for 15 sequences from /tmp/runner/hmms/996550/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 12 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.2  (ig-sw 0.0  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igl/sw (1.2 sec)
    water time: 1.4  (ig-sw 1.3  processing 0.2)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.7 sec)
hmm
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igl/hmm (1.1 sec)
         infra time: 1.2
      hmm step time: 1.5
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)

  note: utils.memory_usage_fraction() needs testing on platform 'Darwin' to make sure unit conversions don't need changing
(0.7 sec)
      total time: 5.0
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/runner/hmms/996550/: failed.fa
      total time: 32.1
