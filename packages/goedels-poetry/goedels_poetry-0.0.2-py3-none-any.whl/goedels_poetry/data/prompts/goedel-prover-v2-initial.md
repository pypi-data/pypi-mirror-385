Complete the following Lean 4 code:

```lean4
{{ formal_statement }}```

Before producing the Lean 4 code to formally prove the given theorem, provide a detailed proof plan outlining the main proof steps and strategies.
The plan should highlight key ideas, intermediate lemmas, and proof structures that will guide the construction of the final formal proof.

IMPORTANT: When you've completed your planning you should output your proof of the Lean 4 code within a ```lean4...``` code block.

IMPORTANT: Your proof should actually prove the theorem or lemma using Lean 4 code. It should not contain sorry, admit, or any other Lean 4 tactics that indicate an incomplete proof.

IMPORTANT: Your completion should contain ONLY the theorem/def and its proof. Do NOT include any import statements or preamble (like `import Mathlib`, `open`, `set_option`, `noncomputable section`, etc.) as these are already provided in the code above. Start directly with your theorem/definition/lemma declaration.
