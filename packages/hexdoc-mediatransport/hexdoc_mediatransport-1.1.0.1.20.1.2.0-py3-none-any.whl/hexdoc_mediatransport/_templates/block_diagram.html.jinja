{# This template's name is referred to in diagrams.py; use caution. #}
<div class="block-diagram">
  {% for blk in blocks %}
    {% set kind = blk[1] %}
    {% if kind == "sym" %}
      {% set name = d.sym_name(blk[2]) %}
    {% elif kind == "literal" %}
      {% set name = blk[2] %}
    {% endif %}
    {% set width = blk[0] %}
    {% if width is integer %}
      <div class="block -sized -{{kind}}" style="--width: {{ width }}">
        <span class="-name">{{- name -}}</span>
        <span class="-size">{{- d.plural("byte", width) -}}</span>
      </div>
    {% elif width is sequence %}
      {% set ref = width[0] %}
      {% set mod = width[1] %}
      <div class="block -flexible -{{kind}}">
        <span class="-name">{{- name -}}</span>
        <span class="-size">{{ d.plural_var("byte", "=" ~ d.sym_name(ref) ~ mod) -}}</span>
      </div>
    {% else %}
      <div class="block -indefinite -{{kind}}">
        <span class="-name">{{- name -}}</span>
        <span class="-size"> ... </span>
      </div>
    {% endif %}
  {% endfor %}
</div>