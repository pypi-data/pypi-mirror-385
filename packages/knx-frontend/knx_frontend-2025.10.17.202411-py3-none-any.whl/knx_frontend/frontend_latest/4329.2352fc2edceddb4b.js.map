{"version":3,"file":"4329.2352fc2edceddb4b.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/common/entity/compute_device_name.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/string/get_duplicates.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/entity/compute_state_name.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/entity/context/get_device_context.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/device/ha-device-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/device/ha-devices-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-device.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/util/time-cache-function-promise.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/entity_sources.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/integration.ts","webpack://knx-frontend/./homeassistant-frontend/src/util/brands-url.ts"],"sourcesContent":["import memoizeOne from \"memoize-one\";\nimport type { DeviceRegistryEntry } from \"../../data/device_registry\";\nimport type {\n  EntityRegistryDisplayEntry,\n  EntityRegistryEntry,\n} from \"../../data/entity_registry\";\nimport type { HomeAssistant } from \"../../types\";\nimport { computeStateName } from \"./compute_state_name\";\nimport { getDuplicates } from \"../string/get_duplicates\";\n\nexport const computeDeviceName = (\n  device: DeviceRegistryEntry\n): string | undefined => (device.name_by_user || device.name)?.trim();\n\nexport const computeDeviceNameDisplay = (\n  device: DeviceRegistryEntry,\n  hass: HomeAssistant,\n  entities?: EntityRegistryEntry[] | EntityRegistryDisplayEntry[] | string[]\n) =>\n  computeDeviceName(device) ||\n  (entities && fallbackDeviceName(hass, entities)) ||\n  hass.localize(\"ui.panel.config.devices.unnamed_device\", {\n    type: hass.localize(\n      `ui.panel.config.devices.type.${device.entry_type || \"device\"}`\n    ),\n  });\n\nexport const fallbackDeviceName = (\n  hass: HomeAssistant,\n  entities: EntityRegistryEntry[] | EntityRegistryDisplayEntry[] | string[]\n) => {\n  for (const entity of entities || []) {\n    const entityId = typeof entity === \"string\" ? entity : entity.entity_id;\n    const stateObj = hass.states[entityId];\n    if (stateObj) {\n      return computeStateName(stateObj);\n    }\n  }\n  return undefined;\n};\n\nexport const getDuplicatedDeviceNames = memoizeOne(\n  (devices: HomeAssistant[\"devices\"]): Set<string> => {\n    const names = Object.values(devices)\n      .map((device) => computeDeviceName(device))\n      .filter((name): name is string => name !== undefined);\n\n    return getDuplicates(names);\n  }\n);\n","export function getDuplicates(array: string[]): Set<string> {\n  const duplicates = new Set<string>();\n  const seen = new Set<string>();\n\n  for (const item of array) {\n    if (seen.has(item)) {\n      duplicates.add(item);\n    } else {\n      seen.add(item);\n    }\n  }\n\n  return duplicates;\n}\n","import type { HassEntity } from \"home-assistant-js-websocket\";\nimport { computeObjectId } from \"./compute_object_id\";\n\nexport const computeStateNameFromEntityAttributes = (\n  entityId: string,\n  attributes: Record<string, any>\n): string =>\n  attributes.friendly_name === undefined\n    ? computeObjectId(entityId).replace(/_/g, \" \")\n    : (attributes.friendly_name ?? \"\").toString();\n\nexport const computeStateName = (stateObj: HassEntity): string =>\n  computeStateNameFromEntityAttributes(stateObj.entity_id, stateObj.attributes);\n","import type { AreaRegistryEntry } from \"../../../data/area_registry\";\nimport type { DeviceRegistryEntry } from \"../../../data/device_registry\";\nimport type { FloorRegistryEntry } from \"../../../data/floor_registry\";\nimport type { HomeAssistant } from \"../../../types\";\n\ninterface DeviceContext {\n  device: DeviceRegistryEntry;\n  area: AreaRegistryEntry | null;\n  floor: FloorRegistryEntry | null;\n}\n\nexport const getDeviceContext = (\n  device: DeviceRegistryEntry,\n  hass: HomeAssistant\n): DeviceContext => {\n  const areaId = device.area_id;\n  const area = areaId ? hass.areas[areaId] : undefined;\n  const floorId = area?.floor_id;\n  const floor = floorId ? hass.floors[floorId] : undefined;\n\n  return {\n    device: device,\n    area: area || null,\n    floor: floor || null,\n  };\n};\n","import type { ComboBoxLitRenderer } from \"@vaadin/combo-box/lit\";\nimport type { HassEntity } from \"home-assistant-js-websocket\";\nimport { html, LitElement, nothing, type PropertyValues } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeAreaName } from \"../../common/entity/compute_area_name\";\nimport {\n  computeDeviceName,\n  computeDeviceNameDisplay,\n} from \"../../common/entity/compute_device_name\";\nimport { computeDomain } from \"../../common/entity/compute_domain\";\nimport { getDeviceContext } from \"../../common/entity/context/get_device_context\";\nimport { getConfigEntries, type ConfigEntry } from \"../../data/config_entries\";\nimport {\n  getDeviceEntityDisplayLookup,\n  type DeviceEntityDisplayLookup,\n  type DeviceRegistryEntry,\n} from \"../../data/device_registry\";\nimport { domainToName } from \"../../data/integration\";\nimport type { HomeAssistant } from \"../../types\";\nimport { brandsUrl } from \"../../util/brands-url\";\nimport \"../ha-generic-picker\";\nimport type { HaGenericPicker } from \"../ha-generic-picker\";\nimport type { PickerComboBoxItem } from \"../ha-picker-combo-box\";\n\nexport type HaDevicePickerDeviceFilterFunc = (\n  device: DeviceRegistryEntry\n) => boolean;\n\nexport type HaDevicePickerEntityFilterFunc = (entity: HassEntity) => boolean;\n\ninterface DevicePickerItem extends PickerComboBoxItem {\n  domain?: string;\n  domain_name?: string;\n}\n\n@customElement(\"ha-device-picker\")\nexport class HaDevicePicker extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  // eslint-disable-next-line lit/no-native-attributes\n  @property({ type: Boolean }) public autofocus = false;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property() public label?: string;\n\n  @property() public value?: string;\n\n  @property() public helper?: string;\n\n  @property() public placeholder?: string;\n\n  @property({ type: String, attribute: \"search-label\" })\n  public searchLabel?: string;\n\n  @property({ attribute: false, type: Array }) public createDomains?: string[];\n\n  /**\n   * Show only devices with entities from specific domains.\n   * @type {Array}\n   * @attr include-domains\n   */\n  @property({ type: Array, attribute: \"include-domains\" })\n  public includeDomains?: string[];\n\n  /**\n   * Show no devices with entities of these domains.\n   * @type {Array}\n   * @attr exclude-domains\n   */\n  @property({ type: Array, attribute: \"exclude-domains\" })\n  public excludeDomains?: string[];\n\n  /**\n   * Show only devices with entities of these device classes.\n   * @type {Array}\n   * @attr include-device-classes\n   */\n  @property({ type: Array, attribute: \"include-device-classes\" })\n  public includeDeviceClasses?: string[];\n\n  /**\n   * List of devices to be excluded.\n   * @type {Array}\n   * @attr exclude-devices\n   */\n  @property({ type: Array, attribute: \"exclude-devices\" })\n  public excludeDevices?: string[];\n\n  @property({ attribute: false })\n  public deviceFilter?: HaDevicePickerDeviceFilterFunc;\n\n  @property({ attribute: false })\n  public entityFilter?: HaDevicePickerEntityFilterFunc;\n\n  @property({ attribute: \"hide-clear-icon\", type: Boolean })\n  public hideClearIcon = false;\n\n  @query(\"ha-generic-picker\") private _picker?: HaGenericPicker;\n\n  @state() private _configEntryLookup: Record<string, ConfigEntry> = {};\n\n  protected firstUpdated(_changedProperties: PropertyValues): void {\n    super.firstUpdated(_changedProperties);\n    this._loadConfigEntries();\n  }\n\n  private async _loadConfigEntries() {\n    const configEntries = await getConfigEntries(this.hass);\n    this._configEntryLookup = Object.fromEntries(\n      configEntries.map((entry) => [entry.entry_id, entry])\n    );\n  }\n\n  private _getItems = () =>\n    this._getDevices(\n      this.hass.devices,\n      this.hass.entities,\n      this._configEntryLookup,\n      this.includeDomains,\n      this.excludeDomains,\n      this.includeDeviceClasses,\n      this.deviceFilter,\n      this.entityFilter,\n      this.excludeDevices\n    );\n\n  private _getDevices = memoizeOne(\n    (\n      haDevices: HomeAssistant[\"devices\"],\n      haEntities: HomeAssistant[\"entities\"],\n      configEntryLookup: Record<string, ConfigEntry>,\n      includeDomains: this[\"includeDomains\"],\n      excludeDomains: this[\"excludeDomains\"],\n      includeDeviceClasses: this[\"includeDeviceClasses\"],\n      deviceFilter: this[\"deviceFilter\"],\n      entityFilter: this[\"entityFilter\"],\n      excludeDevices: this[\"excludeDevices\"]\n    ): DevicePickerItem[] => {\n      const devices = Object.values(haDevices);\n      const entities = Object.values(haEntities);\n\n      let deviceEntityLookup: DeviceEntityDisplayLookup = {};\n\n      if (\n        includeDomains ||\n        excludeDomains ||\n        includeDeviceClasses ||\n        entityFilter\n      ) {\n        deviceEntityLookup = getDeviceEntityDisplayLookup(entities);\n      }\n\n      let inputDevices = devices.filter(\n        (device) => device.id === this.value || !device.disabled_by\n      );\n\n      if (includeDomains) {\n        inputDevices = inputDevices.filter((device) => {\n          const devEntities = deviceEntityLookup[device.id];\n          if (!devEntities || !devEntities.length) {\n            return false;\n          }\n          return deviceEntityLookup[device.id].some((entity) =>\n            includeDomains.includes(computeDomain(entity.entity_id))\n          );\n        });\n      }\n\n      if (excludeDomains) {\n        inputDevices = inputDevices.filter((device) => {\n          const devEntities = deviceEntityLookup[device.id];\n          if (!devEntities || !devEntities.length) {\n            return true;\n          }\n          return entities.every(\n            (entity) =>\n              !excludeDomains.includes(computeDomain(entity.entity_id))\n          );\n        });\n      }\n\n      if (excludeDevices) {\n        inputDevices = inputDevices.filter(\n          (device) => !excludeDevices!.includes(device.id)\n        );\n      }\n\n      if (includeDeviceClasses) {\n        inputDevices = inputDevices.filter((device) => {\n          const devEntities = deviceEntityLookup[device.id];\n          if (!devEntities || !devEntities.length) {\n            return false;\n          }\n          return deviceEntityLookup[device.id].some((entity) => {\n            const stateObj = this.hass.states[entity.entity_id];\n            if (!stateObj) {\n              return false;\n            }\n            return (\n              stateObj.attributes.device_class &&\n              includeDeviceClasses.includes(stateObj.attributes.device_class)\n            );\n          });\n        });\n      }\n\n      if (entityFilter) {\n        inputDevices = inputDevices.filter((device) => {\n          const devEntities = deviceEntityLookup[device.id];\n          if (!devEntities || !devEntities.length) {\n            return false;\n          }\n          return devEntities.some((entity) => {\n            const stateObj = this.hass.states[entity.entity_id];\n            if (!stateObj) {\n              return false;\n            }\n            return entityFilter(stateObj);\n          });\n        });\n      }\n\n      if (deviceFilter) {\n        inputDevices = inputDevices.filter(\n          (device) =>\n            // We always want to include the device of the current value\n            device.id === this.value || deviceFilter!(device)\n        );\n      }\n\n      const outputDevices = inputDevices.map<DevicePickerItem>((device) => {\n        const deviceName = computeDeviceNameDisplay(\n          device,\n          this.hass,\n          deviceEntityLookup[device.id]\n        );\n\n        const { area } = getDeviceContext(device, this.hass);\n\n        const areaName = area ? computeAreaName(area) : undefined;\n\n        const configEntry = device.primary_config_entry\n          ? configEntryLookup?.[device.primary_config_entry]\n          : undefined;\n\n        const domain = configEntry?.domain;\n        const domainName = domain\n          ? domainToName(this.hass.localize, domain)\n          : undefined;\n\n        return {\n          id: device.id,\n          label: \"\",\n          primary:\n            deviceName ||\n            this.hass.localize(\"ui.components.device-picker.unnamed_device\"),\n          secondary: areaName,\n          domain: configEntry?.domain,\n          domain_name: domainName,\n          search_labels: [deviceName, areaName, domain, domainName].filter(\n            Boolean\n          ) as string[],\n          sorting_label: deviceName || \"zzz\",\n        };\n      });\n\n      return outputDevices;\n    }\n  );\n\n  private _valueRenderer = memoizeOne(\n    (configEntriesLookup: Record<string, ConfigEntry>) => (value: string) => {\n      const deviceId = value;\n      const device = this.hass.devices[deviceId];\n\n      if (!device) {\n        return html`<span slot=\"headline\">${deviceId}</span>`;\n      }\n\n      const { area } = getDeviceContext(device, this.hass);\n\n      const deviceName = device ? computeDeviceName(device) : undefined;\n      const areaName = area ? computeAreaName(area) : undefined;\n\n      const primary = deviceName;\n      const secondary = areaName;\n\n      const configEntry = device.primary_config_entry\n        ? configEntriesLookup[device.primary_config_entry]\n        : undefined;\n\n      return html`\n        ${configEntry\n          ? html`<img\n              slot=\"start\"\n              alt=\"\"\n              crossorigin=\"anonymous\"\n              referrerpolicy=\"no-referrer\"\n              src=${brandsUrl({\n                domain: configEntry.domain,\n                type: \"icon\",\n                darkOptimized: this.hass.themes?.darkMode,\n              })}\n            />`\n          : nothing}\n        <span slot=\"headline\">${primary}</span>\n        <span slot=\"supporting-text\">${secondary}</span>\n      `;\n    }\n  );\n\n  private _rowRenderer: ComboBoxLitRenderer<DevicePickerItem> = (item) => html`\n    <ha-combo-box-item type=\"button\">\n      ${item.domain\n        ? html`\n            <img\n              slot=\"start\"\n              alt=\"\"\n              crossorigin=\"anonymous\"\n              referrerpolicy=\"no-referrer\"\n              src=${brandsUrl({\n                domain: item.domain,\n                type: \"icon\",\n                darkOptimized: this.hass.themes.darkMode,\n              })}\n            />\n          `\n        : nothing}\n\n      <span slot=\"headline\">${item.primary}</span>\n      ${item.secondary\n        ? html`<span slot=\"supporting-text\">${item.secondary}</span>`\n        : nothing}\n      ${item.domain_name\n        ? html`\n            <div slot=\"trailing-supporting-text\" class=\"domain\">\n              ${item.domain_name}\n            </div>\n          `\n        : nothing}\n    </ha-combo-box-item>\n  `;\n\n  protected render() {\n    const placeholder =\n      this.placeholder ??\n      this.hass.localize(\"ui.components.device-picker.placeholder\");\n    const notFoundLabel = this.hass.localize(\n      \"ui.components.device-picker.no_match\"\n    );\n\n    const valueRenderer = this._valueRenderer(this._configEntryLookup);\n\n    return html`\n      <ha-generic-picker\n        .hass=${this.hass}\n        .autofocus=${this.autofocus}\n        .label=${this.label}\n        .searchLabel=${this.searchLabel}\n        .notFoundLabel=${notFoundLabel}\n        .placeholder=${placeholder}\n        .value=${this.value}\n        .rowRenderer=${this._rowRenderer}\n        .getItems=${this._getItems}\n        .hideClearIcon=${this.hideClearIcon}\n        .valueRenderer=${valueRenderer}\n        @value-changed=${this._valueChanged}\n      >\n      </ha-generic-picker>\n    `;\n  }\n\n  public async open() {\n    await this.updateComplete;\n    await this._picker?.open();\n  }\n\n  private _valueChanged(ev) {\n    ev.stopPropagation();\n    const value = ev.detail.value;\n    this.value = value;\n    fireEvent(this, \"value-changed\", { value });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-device-picker\": HaDevicePicker;\n  }\n}\n","import { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport type { HomeAssistant, ValueChangedEvent } from \"../../types\";\nimport \"./ha-device-picker\";\nimport type {\n  HaDevicePickerDeviceFilterFunc,\n  HaDevicePickerEntityFilterFunc,\n} from \"./ha-device-picker\";\n\n@customElement(\"ha-devices-picker\")\nclass HaDevicesPicker extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ type: Array }) public value?: string[];\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  /**\n   * Show entities from specific domains.\n   * @type {string}\n   * @attr include-domains\n   */\n  @property({ type: Array, attribute: \"include-domains\" })\n  public includeDomains?: string[];\n\n  /**\n   * Show no entities of these domains.\n   * @type {Array}\n   * @attr exclude-domains\n   */\n  @property({ type: Array, attribute: \"exclude-domains\" })\n  public excludeDomains?: string[];\n\n  @property({ type: Array, attribute: \"include-device-classes\" })\n  public includeDeviceClasses?: string[];\n\n  @property({ attribute: \"picked-device-label\" })\n  public pickedDeviceLabel?: string;\n\n  @property({ attribute: \"pick-device-label\" }) public pickDeviceLabel?: string;\n\n  @property({ attribute: false })\n  public deviceFilter?: HaDevicePickerDeviceFilterFunc;\n\n  @property({ attribute: false })\n  public entityFilter?: HaDevicePickerEntityFilterFunc;\n\n  protected render() {\n    if (!this.hass) {\n      return nothing;\n    }\n\n    const currentDevices = this._currentDevices;\n    return html`\n      ${currentDevices.map(\n        (entityId) => html`\n          <div>\n            <ha-device-picker\n              allow-custom-entity\n              .curValue=${entityId}\n              .hass=${this.hass}\n              .deviceFilter=${this.deviceFilter}\n              .entityFilter=${this.entityFilter}\n              .includeDomains=${this.includeDomains}\n              .excludeDomains=${this.excludeDomains}\n              .includeDeviceClasses=${this.includeDeviceClasses}\n              .value=${entityId}\n              .label=${this.pickedDeviceLabel}\n              .disabled=${this.disabled}\n              @value-changed=${this._deviceChanged}\n            ></ha-device-picker>\n          </div>\n        `\n      )}\n      <div>\n        <ha-device-picker\n          allow-custom-entity\n          .hass=${this.hass}\n          .helper=${this.helper}\n          .deviceFilter=${this.deviceFilter}\n          .entityFilter=${this.entityFilter}\n          .includeDomains=${this.includeDomains}\n          .excludeDomains=${this.excludeDomains}\n          .excludeDevices=${currentDevices}\n          .includeDeviceClasses=${this.includeDeviceClasses}\n          .label=${this.pickDeviceLabel}\n          .disabled=${this.disabled}\n          .required=${this.required && !currentDevices.length}\n          @value-changed=${this._addDevice}\n        ></ha-device-picker>\n      </div>\n    `;\n  }\n\n  private get _currentDevices() {\n    return this.value || [];\n  }\n\n  private async _updateDevices(devices) {\n    fireEvent(this, \"value-changed\", {\n      value: devices,\n    });\n\n    this.value = devices;\n  }\n\n  private _deviceChanged(event: ValueChangedEvent<string>) {\n    event.stopPropagation();\n    const curValue = (event.currentTarget as any).curValue;\n    const newValue = event.detail.value;\n    if (newValue === curValue) {\n      return;\n    }\n    if (newValue === undefined) {\n      this._updateDevices(\n        this._currentDevices.filter((dev) => dev !== curValue)\n      );\n    } else {\n      this._updateDevices(\n        this._currentDevices.map((dev) => (dev === curValue ? newValue : dev))\n      );\n    }\n  }\n\n  private async _addDevice(event: ValueChangedEvent<string>) {\n    event.stopPropagation();\n    const toAdd = event.detail.value;\n    (event.currentTarget as any).value = \"\";\n    if (!toAdd) {\n      return;\n    }\n    const currentDevices = this._currentDevices;\n    if (currentDevices.includes(toAdd)) {\n      return;\n    }\n\n    this._updateDevices([...currentDevices, toAdd]);\n  }\n\n  static override styles = css`\n    div {\n      margin-top: 8px;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-devices-picker\": HaDevicesPicker;\n  }\n}\n","import type { HassEntity } from \"home-assistant-js-websocket\";\nimport type { PropertyValues } from \"lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { ensureArray } from \"../../common/array/ensure-array\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport type { DeviceRegistryEntry } from \"../../data/device_registry\";\nimport { getDeviceIntegrationLookup } from \"../../data/device_registry\";\nimport type { EntitySources } from \"../../data/entity_sources\";\nimport { fetchEntitySourcesWithCache } from \"../../data/entity_sources\";\nimport type { DeviceSelector } from \"../../data/selector\";\nimport type { ConfigEntry } from \"../../data/config_entries\";\nimport { getConfigEntries } from \"../../data/config_entries\";\nimport {\n  filterSelectorDevices,\n  filterSelectorEntities,\n} from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../device/ha-device-picker\";\nimport \"../device/ha-devices-picker\";\n\n@customElement(\"ha-selector-device\")\nexport class HaDeviceSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: DeviceSelector;\n\n  @state() private _entitySources?: EntitySources;\n\n  @state() private _configEntries?: ConfigEntry[];\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  private _deviceIntegrationLookup = memoizeOne(getDeviceIntegrationLookup);\n\n  private _hasIntegration(selector: DeviceSelector) {\n    return (\n      (selector.device?.filter &&\n        ensureArray(selector.device.filter).some(\n          (filter) => filter.integration\n        )) ||\n      (selector.device?.entity &&\n        ensureArray(selector.device.entity).some(\n          (device) => device.integration\n        ))\n    );\n  }\n\n  protected willUpdate(changedProperties: PropertyValues): void {\n    if (changedProperties.get(\"selector\") && this.value !== undefined) {\n      if (this.selector.device?.multiple && !Array.isArray(this.value)) {\n        this.value = [this.value];\n        fireEvent(this, \"value-changed\", { value: this.value });\n      } else if (!this.selector.device?.multiple && Array.isArray(this.value)) {\n        this.value = this.value[0];\n        fireEvent(this, \"value-changed\", { value: this.value });\n      }\n    }\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (\n      changedProperties.has(\"selector\") &&\n      this._hasIntegration(this.selector) &&\n      !this._entitySources\n    ) {\n      fetchEntitySourcesWithCache(this.hass).then((sources) => {\n        this._entitySources = sources;\n      });\n    }\n    if (!this._configEntries && this._hasIntegration(this.selector)) {\n      this._configEntries = [];\n      getConfigEntries(this.hass).then((entries) => {\n        this._configEntries = entries;\n      });\n    }\n  }\n\n  protected render() {\n    if (this._hasIntegration(this.selector) && !this._entitySources) {\n      return nothing;\n    }\n\n    if (!this.selector.device?.multiple) {\n      return html`\n        <ha-device-picker\n          .hass=${this.hass}\n          .value=${this.value}\n          .label=${this.label}\n          .helper=${this.helper}\n          .deviceFilter=${this._filterDevices}\n          .entityFilter=${this.selector.device?.entity\n            ? this._filterEntities\n            : undefined}\n          .disabled=${this.disabled}\n          .required=${this.required}\n          allow-custom-entity\n        ></ha-device-picker>\n      `;\n    }\n\n    return html`\n      ${this.label ? html`<label>${this.label}</label>` : \"\"}\n      <ha-devices-picker\n        .hass=${this.hass}\n        .value=${this.value}\n        .helper=${this.helper}\n        .deviceFilter=${this._filterDevices}\n        .entityFilter=${this.selector.device?.entity\n          ? this._filterEntities\n          : undefined}\n        .disabled=${this.disabled}\n        .required=${this.required}\n      ></ha-devices-picker>\n    `;\n  }\n\n  private _filterDevices = (device: DeviceRegistryEntry): boolean => {\n    if (!this.selector.device?.filter) {\n      return true;\n    }\n    const deviceIntegrations = this._entitySources\n      ? this._deviceIntegrationLookup(\n          this._entitySources,\n          Object.values(this.hass.entities),\n          Object.values(this.hass.devices),\n          this._configEntries\n        )\n      : undefined;\n\n    return ensureArray(this.selector.device.filter).some((filter) =>\n      filterSelectorDevices(filter, device, deviceIntegrations)\n    );\n  };\n\n  private _filterEntities = (entity: HassEntity): boolean =>\n    ensureArray(this.selector.device!.entity).some((filter) =>\n      filterSelectorEntities(filter, entity, this._entitySources)\n    );\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-device\": HaDeviceSelector;\n  }\n}\n","import type { HomeAssistant } from \"../../types\";\n\ninterface CacheResult<T> {\n  result: T;\n  cacheKey: any;\n}\n\n/**\n * Caches a result of a promise for X time. Allows optional extra validation\n * check to invalidate the cache.\n * @param cacheKey the key to store the cache\n * @param cacheTime the time to cache the result\n * @param func the function to fetch the data\n * @param generateCacheKey optional function to generate a cache key based on current hass + cached result. Cache is invalid if generates a different cache key.\n * @param hass Home Assistant object\n * @param args extra arguments to pass to the function to fetch the data\n * @returns\n */\nexport const timeCachePromiseFunc = async <T>(\n  cacheKey: string,\n  cacheTime: number,\n  func: (hass: HomeAssistant, ...args: any[]) => Promise<T>,\n  generateCacheKey:\n    | ((hass: HomeAssistant, lastResult: T) => unknown)\n    | undefined,\n  hass: HomeAssistant,\n  ...args: any[]\n): Promise<T> => {\n  const anyHass = hass as any;\n  const lastResult: Promise<CacheResult<T>> | CacheResult<T> | undefined =\n    anyHass[cacheKey];\n\n  const checkCachedResult = (result: CacheResult<T>): T | Promise<T> => {\n    if (\n      !generateCacheKey ||\n      generateCacheKey(hass, result.result) === result.cacheKey\n    ) {\n      return result.result;\n    }\n\n    anyHass[cacheKey] = undefined;\n    return timeCachePromiseFunc(\n      cacheKey,\n      cacheTime,\n      func,\n      generateCacheKey,\n      hass,\n      ...args\n    );\n  };\n\n  // If we have a cached result, return it if it's still valid\n  if (lastResult) {\n    return lastResult instanceof Promise\n      ? lastResult.then(checkCachedResult)\n      : checkCachedResult(lastResult);\n  }\n\n  const resultPromise = func(hass, ...args);\n  anyHass[cacheKey] = resultPromise;\n\n  resultPromise.then(\n    // When successful, set timer to clear cache\n    (result) => {\n      anyHass[cacheKey] = {\n        result,\n        cacheKey: generateCacheKey?.(hass, result),\n      };\n      setTimeout(() => {\n        anyHass[cacheKey] = undefined;\n      }, cacheTime);\n    },\n    // On failure, clear cache right away\n    () => {\n      anyHass[cacheKey] = undefined;\n    }\n  );\n\n  return resultPromise;\n};\n","import { timeCachePromiseFunc } from \"../common/util/time-cache-function-promise\";\nimport type { HomeAssistant } from \"../types\";\n\ninterface EntitySource {\n  domain: string;\n}\n\nexport type EntitySources = Record<string, EntitySource>;\n\nconst fetchEntitySources = (hass: HomeAssistant): Promise<EntitySources> =>\n  hass.callWS({ type: \"entity/source\" });\n\nexport const fetchEntitySourcesWithCache = (\n  hass: HomeAssistant\n): Promise<EntitySources> =>\n  timeCachePromiseFunc(\n    \"_entitySources\",\n    // cache for 30 seconds\n    30000,\n    fetchEntitySources,\n    // We base the cache on number of states. If number of states\n    // changes we force a refresh\n    (hass2) => Object.keys(hass2.states).length,\n    hass\n  );\n","import type { Connection } from \"home-assistant-js-websocket\";\nimport { createCollection } from \"home-assistant-js-websocket\";\nimport type { LocalizeFunc } from \"../common/translations/localize\";\nimport type { HomeAssistant } from \"../types\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport const integrationsWithPanel = {\n  bluetooth: \"config/bluetooth\",\n  dhcp: \"config/dhcp\",\n  matter: \"config/matter\",\n  mqtt: \"config/mqtt\",\n  ssdp: \"config/ssdp\",\n  thread: \"config/thread\",\n  zeroconf: \"config/zeroconf\",\n  zha: \"config/zha/dashboard\",\n  zwave_js: \"config/zwave_js/dashboard\",\n};\n\nexport type IntegrationType =\n  | \"device\"\n  | \"helper\"\n  | \"hub\"\n  | \"service\"\n  | \"hardware\"\n  | \"entity\"\n  | \"system\";\n\nexport interface IntegrationManifest {\n  is_built_in: boolean;\n  overwrites_built_in?: boolean;\n  domain: string;\n  name: string;\n  config_flow: boolean;\n  documentation: string;\n  issue_tracker?: string;\n  dependencies?: string[];\n  after_dependencies?: string[];\n  codeowners?: string[];\n  requirements?: string[];\n  ssdp?: { manufacturer?: string; modelName?: string; st?: string }[];\n  zeroconf?: string[];\n  homekit?: { models: string[] };\n  integration_type?: IntegrationType;\n  loggers?: string[];\n  quality_scale?:\n    | \"bronze\"\n    | \"silver\"\n    | \"gold\"\n    | \"platinum\"\n    | \"no_score\"\n    | \"internal\"\n    | \"legacy\"\n    | \"custom\";\n  iot_class:\n    | \"assumed_state\"\n    | \"cloud_polling\"\n    | \"cloud_push\"\n    | \"local_polling\"\n    | \"local_push\";\n  single_config_entry?: boolean;\n  version?: string;\n}\nexport interface IntegrationSetup {\n  domain: string;\n  seconds?: number;\n}\n\nexport interface IntegrationLogInfo {\n  domain: string;\n  level?: number;\n}\n\nexport enum LogSeverity {\n  CRITICAL = 50,\n  ERROR = 40,\n  WARNING = 30,\n  INFO = 20,\n  DEBUG = 10,\n  NOTSET = 0,\n}\n\nexport type IntegrationLogPersistance = \"none\" | \"once\" | \"permanent\";\n\nexport const integrationIssuesUrl = (\n  domain: string,\n  manifest: IntegrationManifest\n) =>\n  manifest.issue_tracker ||\n  `https://github.com/home-assistant/core/issues?q=is%3Aissue+is%3Aopen+label%3A%22integration%3A+${domain}%22`;\n\nexport const domainToName = (\n  localize: LocalizeFunc,\n  domain: string,\n  manifest?: IntegrationManifest\n) => localize(`component.${domain}.title`) || manifest?.name || domain;\n\nexport const fetchIntegrationManifests = (\n  hass: HomeAssistant,\n  integrations?: string[]\n) => {\n  const params: any = {\n    type: \"manifest/list\",\n  };\n  if (integrations) {\n    params.integrations = integrations;\n  }\n  return hass.callWS<IntegrationManifest[]>(params);\n};\n\nexport const fetchIntegrationManifest = (\n  hass: HomeAssistant,\n  integration: string\n) => hass.callWS<IntegrationManifest>({ type: \"manifest/get\", integration });\n\nexport const fetchIntegrationSetups = (hass: HomeAssistant) =>\n  hass.callWS<IntegrationSetup[]>({ type: \"integration/setup_info\" });\n\nexport const fetchIntegrationLogInfo = (conn) =>\n  conn.sendMessagePromise({\n    type: \"logger/log_info\",\n  });\n\nexport const setIntegrationLogLevel = (\n  hass: HomeAssistant,\n  integration: string,\n  level: string,\n  persistence: IntegrationLogPersistance\n) =>\n  hass.callWS({\n    type: \"logger/integration_log_level\",\n    integration,\n    level,\n    persistence,\n  });\n\nconst subscribeLogInfoUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchIntegrationLogInfo(conn).then((log_infos) =>\n          store.setState(log_infos, true)\n        ),\n      200,\n      true\n    ),\n    \"logging_changed\"\n  );\n\nexport const subscribeLogInfo = (\n  conn: Connection,\n  onChange: (devices: IntegrationLogInfo[]) => void\n) =>\n  createCollection<IntegrationLogInfo[]>(\n    \"_integration_log_info\",\n    fetchIntegrationLogInfo,\n    subscribeLogInfoUpdates,\n    conn,\n    onChange\n  );\n\nexport const waitForIntegrationSetup = (hass: HomeAssistant, domain: string) =>\n  hass.callWS<{ integration_loaded: boolean }>({\n    type: \"integration/wait\",\n    domain,\n  });\n","export interface BrandsOptions {\n  domain: string;\n  type: \"icon\" | \"logo\" | \"icon@2x\" | \"logo@2x\";\n  useFallback?: boolean;\n  darkOptimized?: boolean;\n  brand?: boolean;\n}\n\nexport interface HardwareBrandsOptions {\n  category: string;\n  model?: string;\n  manufacturer: string;\n  darkOptimized?: boolean;\n}\n\nexport const brandsUrl = (options: BrandsOptions): string =>\n  `https://brands.home-assistant.io/${options.brand ? \"brands/\" : \"\"}${\n    options.useFallback ? \"_/\" : \"\"\n  }${options.domain}/${options.darkOptimized ? \"dark_\" : \"\"}${\n    options.type\n  }.png`;\n\nexport const hardwareBrandsUrl = (options: HardwareBrandsOptions): string =>\n  `https://brands.home-assistant.io/hardware/${options.category}/${\n    options.darkOptimized ? \"dark_\" : \"\"\n  }${options.manufacturer}${options.model ? `_${options.model}` : \"\"}.png`;\n\nexport const extractDomainFromBrandUrl = (url: string) => url.split(\"/\")[4];\n\nexport const isBrandUrl = (thumbnail: string | \"\"): boolean =>\n  thumbnail.startsWith(\"https://brands.home-assistant.io/\");\n"],"names":["computeDeviceName","device","name_by_user","name","trim","computeDeviceNameDisplay","hass","entities","fallbackDeviceName","localize","type","entry_type","entity","entityId","entity_id","stateObj","states","computeStateName","memoizeOne","devices","array","duplicates","Set","seen","item","has","add","getDuplicates","Object","values","map","filter","undefined","computeStateNameFromEntityAttributes","attributes","friendly_name","computeObjectId","replace","toString","getDeviceContext","areaId","area_id","area","areas","floorId","floor_id","floor","floors","HaDevicePicker","LitElement","firstUpdated","_changedProperties","super","this","_loadConfigEntries","configEntries","getConfigEntries","_configEntryLookup","fromEntries","entry","entry_id","render","placeholder","notFoundLabel","valueRenderer","_valueRenderer","html","autofocus","label","searchLabel","value","_rowRenderer","_getItems","hideClearIcon","_valueChanged","open","updateComplete","_picker","ev","stopPropagation","detail","fireEvent","args","disabled","required","_getDevices","includeDomains","excludeDomains","includeDeviceClasses","deviceFilter","entityFilter","excludeDevices","haDevices","haEntities","configEntryLookup","deviceEntityLookup","getDeviceEntityDisplayLookup","inputDevices","id","disabled_by","devEntities","length","some","includes","computeDomain","every","device_class","deviceName","areaName","computeAreaName","configEntry","primary_config_entry","domain","domainName","domainToName","primary","secondary","domain_name","search_labels","Boolean","sorting_label","configEntriesLookup","deviceId","brandsUrl","darkOptimized","themes","darkMode","nothing","attribute","String","Array","HaDevicesPicker","currentDevices","_currentDevices","pickedDeviceLabel","_deviceChanged","helper","pickDeviceLabel","_addDevice","_updateDevices","event","curValue","currentTarget","newValue","dev","toAdd","styles","css","HaDeviceSelector","_hasIntegration","selector","ensureArray","integration","willUpdate","changedProperties","get","multiple","isArray","updated","_entitySources","fetchEntitySourcesWithCache","then","sources","_configEntries","entries","_filterDevices","_filterEntities","_deviceIntegrationLookup","getDeviceIntegrationLookup","deviceIntegrations","filterSelectorDevices","filterSelectorEntities","timeCachePromiseFunc","cacheKey","cacheTime","func","generateCacheKey","anyHass","lastResult","checkCachedResult","result","Promise","resultPromise","setTimeout","fetchEntitySources","callWS","hass2","keys","manifest","fetchIntegrationManifests","integrations","params","fetchIntegrationManifest","options","brand","useFallback","extractDomainFromBrandUrl","url","split","isBrandUrl","thumbnail","startsWith"],"mappings":"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"}