{"version":3,"file":"7682.20dc33adeae4a4d0.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/common/language/format_language.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-language-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-language.ts"],"sourcesContent":["import memoizeOne from \"memoize-one\";\nimport type { FrontendLocaleData } from \"../../data/translation\";\n\nexport const formatLanguageCode = (\n  languageCode: string,\n  locale: FrontendLocaleData\n) => {\n  try {\n    return formatLanguageCodeMem(locale)?.of(languageCode) ?? languageCode;\n  } catch {\n    return languageCode;\n  }\n};\n\nconst formatLanguageCodeMem = memoizeOne(\n  (locale: FrontendLocaleData) =>\n    new Intl.DisplayNames(locale.language, {\n      type: \"language\",\n      fallback: \"code\",\n    })\n);\n","import type { PropertyValues } from \"lit\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { stopPropagation } from \"../common/dom/stop_propagation\";\nimport { formatLanguageCode } from \"../common/language/format_language\";\nimport { caseInsensitiveStringCompare } from \"../common/string/compare\";\nimport type { FrontendLocaleData } from \"../data/translation\";\nimport { translationMetadata } from \"../resources/translations-metadata\";\nimport type { HomeAssistant } from \"../types\";\nimport \"./ha-list-item\";\nimport \"./ha-select\";\nimport type { HaSelect } from \"./ha-select\";\n\nexport const getLanguageOptions = (\n  languages: string[],\n  nativeName: boolean,\n  noSort: boolean,\n  locale?: FrontendLocaleData\n) => {\n  let options: { label: string; value: string }[] = [];\n\n  if (nativeName) {\n    const translations = translationMetadata.translations;\n    options = languages.map((lang) => {\n      let label = translations[lang]?.nativeName;\n      if (!label) {\n        try {\n          // this will not work if Intl.DisplayNames is polyfilled, it will return in the language of the user\n          label = new Intl.DisplayNames(lang, {\n            type: \"language\",\n            fallback: \"code\",\n          }).of(lang)!;\n        } catch (_err) {\n          label = lang;\n        }\n      }\n      return {\n        value: lang,\n        label,\n      };\n    });\n  } else if (locale) {\n    options = languages.map((lang) => ({\n      value: lang,\n      label: formatLanguageCode(lang, locale),\n    }));\n  }\n\n  if (!noSort && locale) {\n    options.sort((a, b) =>\n      caseInsensitiveStringCompare(a.label, b.label, locale.language)\n    );\n  }\n  return options;\n};\n\n@customElement(\"ha-language-picker\")\nexport class HaLanguagePicker extends LitElement {\n  @property() public value?: string;\n\n  @property() public label?: string;\n\n  @property({ type: Array }) public languages?: string[];\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property({ attribute: \"native-name\", type: Boolean })\n  public nativeName = false;\n\n  @property({ attribute: \"no-sort\", type: Boolean }) public noSort = false;\n\n  @property({ attribute: \"inline-arrow\", type: Boolean })\n  public inlineArrow = false;\n\n  @state() _defaultLanguages: string[] = [];\n\n  @query(\"ha-select\") private _select!: HaSelect;\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.firstUpdated(changedProps);\n    this._computeDefaultLanguageOptions();\n  }\n\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n\n    const localeChanged =\n      changedProperties.has(\"hass\") &&\n      this.hass &&\n      changedProperties.get(\"hass\") &&\n      changedProperties.get(\"hass\").locale.language !==\n        this.hass.locale.language;\n    if (\n      changedProperties.has(\"languages\") ||\n      changedProperties.has(\"value\") ||\n      localeChanged\n    ) {\n      this._select.layoutOptions();\n      if (!this.disabled && this._select.value !== this.value) {\n        fireEvent(this, \"value-changed\", { value: this._select.value });\n      }\n      if (!this.value) {\n        return;\n      }\n      const languageOptions = this._getLanguagesOptions(\n        this.languages ?? this._defaultLanguages,\n        this.nativeName,\n        this.noSort,\n        this.hass?.locale\n      );\n      const selectedItemIndex = languageOptions.findIndex(\n        (option) => option.value === this.value\n      );\n      if (selectedItemIndex === -1) {\n        this.value = undefined;\n      }\n      if (localeChanged) {\n        this._select.select(selectedItemIndex);\n      }\n    }\n  }\n\n  private _getLanguagesOptions = memoizeOne(getLanguageOptions);\n\n  private _computeDefaultLanguageOptions() {\n    this._defaultLanguages = Object.keys(translationMetadata.translations);\n  }\n\n  protected render() {\n    const languageOptions = this._getLanguagesOptions(\n      this.languages ?? this._defaultLanguages,\n      this.nativeName,\n      this.noSort,\n      this.hass?.locale\n    );\n\n    const value =\n      this.value ??\n      (this.required && !this.disabled\n        ? languageOptions[0]?.value\n        : this.value);\n\n    return html`\n      <ha-select\n        .label=${this.label ??\n        (this.hass?.localize(\"ui.components.language-picker.language\") ||\n          \"Language\")}\n        .value=${value || \"\"}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        @selected=${this._changed}\n        @closed=${stopPropagation}\n        fixedMenuPosition\n        naturalMenuWidth\n        .inlineArrow=${this.inlineArrow}\n      >\n        ${languageOptions.length === 0\n          ? html`<ha-list-item value=\"\"\n              >${this.hass?.localize(\n                \"ui.components.language-picker.no_languages\"\n              ) || \"No languages\"}</ha-list-item\n            >`\n          : languageOptions.map(\n              (option) => html`\n                <ha-list-item .value=${option.value}\n                  >${option.label}</ha-list-item\n                >\n              `\n            )}\n      </ha-select>\n    `;\n  }\n\n  static styles = css`\n    ha-select {\n      width: 100%;\n    }\n  `;\n\n  private _changed(ev): void {\n    const target = ev.target as HaSelect;\n    if (this.disabled || target.value === \"\" || target.value === this.value) {\n      return;\n    }\n    this.value = target.value;\n    fireEvent(this, \"value-changed\", { value: this.value });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-language-picker\": HaLanguagePicker;\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { LanguageSelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-language-picker\";\n\n@customElement(\"ha-selector-language\")\nexport class HaLanguageSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: LanguageSelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  protected render() {\n    return html`\n      <ha-language-picker\n        .hass=${this.hass}\n        .value=${this.value}\n        .label=${this.label}\n        .helper=${this.helper}\n        .languages=${this.selector.language?.languages}\n        .nativeName=${Boolean(this.selector?.language?.native_name)}\n        .noSort=${Boolean(this.selector?.language?.no_sort)}\n        .disabled=${this.disabled}\n        .required=${this.required}\n      ></ha-language-picker>\n    `;\n  }\n\n  static styles = css`\n    ha-language-picker {\n      width: 100%;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-language\": HaLanguageSelector;\n  }\n}\n"],"names":["formatLanguageCode","languageCode","locale","_formatLanguageCodeMe","_formatLanguageCodeMe2","formatLanguageCodeMem","of","_unused","memoizeOne","Intl","DisplayNames","language","type","fallback","getLanguageOptions","languages","nativeName","noSort","options","translations","translationMetadata","map","lang","_translations$lang","label","_err","value","sort","a","b","caseInsensitiveStringCompare","HaLanguagePicker","LitElement","firstUpdated","changedProps","super","this","_computeDefaultLanguageOptions","updated","changedProperties","localeChanged","has","hass","get","_this$languages","_this$hass","_select","layoutOptions","disabled","fireEvent","selectedItemIndex","_getLanguagesOptions","_defaultLanguages","findIndex","option","undefined","select","Object","keys","render","_this$languages2","_this$hass2","_this$value","_languageOptions$","_this$label","_this$hass3","_this$hass4","languageOptions","required","html","_t","_","localize","_changed","stopPropagation","inlineArrow","length","_t2","_t3","ev","target","args","styles","css","_t4","Array","attribute","Boolean","reflect","HaLanguageSelector","_this$selector$langua","_this$selector","_this$selector2","helper","selector","native_name","no_sort"],"mappings":"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"}