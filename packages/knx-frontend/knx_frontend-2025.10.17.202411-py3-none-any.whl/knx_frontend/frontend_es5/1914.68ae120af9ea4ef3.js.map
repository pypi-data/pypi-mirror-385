{"version":3,"file":"1914.68ae120af9ea4ef3.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/common/string/title-case.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-navigation-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-navigation.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/lovelace/config/types.ts"],"sourcesContent":["export const titleCase = (s) =>\n  s.replace(/^_*(.)|_+(.)/g, (_s, c, d) =>\n    c ? c.toUpperCase() : \" \" + d.toUpperCase()\n  );\n","import type { ComboBoxLitRenderer } from \"@vaadin/combo-box/lit\";\nimport type { PropertyValues, TemplateResult } from \"lit\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { titleCase } from \"../common/string/title-case\";\nimport { fetchConfig } from \"../data/lovelace/config/types\";\nimport type { LovelaceViewRawConfig } from \"../data/lovelace/config/view\";\nimport type { HomeAssistant, PanelInfo, ValueChangedEvent } from \"../types\";\nimport \"./ha-combo-box\";\nimport type { HaComboBox } from \"./ha-combo-box\";\nimport \"./ha-combo-box-item\";\nimport \"./ha-icon\";\n\ninterface NavigationItem {\n  path: string;\n  icon: string;\n  title: string;\n}\n\nconst DEFAULT_ITEMS: NavigationItem[] = [];\n\nconst rowRenderer: ComboBoxLitRenderer<NavigationItem> = (item) => html`\n  <ha-combo-box-item type=\"button\">\n    <ha-icon .icon=${item.icon} slot=\"start\"></ha-icon>\n    <span slot=\"headline\">${item.title || item.path}</span>\n    ${item.title\n      ? html`<span slot=\"supporting-text\">${item.path}</span>`\n      : nothing}\n  </ha-combo-box-item>\n`;\n\nconst createViewNavigationItem = (\n  prefix: string,\n  view: LovelaceViewRawConfig,\n  index: number\n) => ({\n  path: `/${prefix}/${view.path ?? index}`,\n  icon: view.icon ?? \"mdi:view-compact\",\n  title: view.title ?? (view.path ? titleCase(view.path) : `${index}`),\n});\n\nconst createPanelNavigationItem = (hass: HomeAssistant, panel: PanelInfo) => ({\n  path: `/${panel.url_path}`,\n  icon: panel.icon ?? \"mdi:view-dashboard\",\n  title:\n    panel.url_path === hass.defaultPanel\n      ? hass.localize(\"panel.states\")\n      : hass.localize(`panel.${panel.title}`) ||\n        panel.title ||\n        (panel.url_path ? titleCase(panel.url_path) : \"\"),\n});\n\n@customElement(\"ha-navigation-picker\")\nexport class HaNavigationPicker extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property() public label?: string;\n\n  @property() public value?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @state() private _opened = false;\n\n  private navigationItemsLoaded = false;\n\n  private navigationItems: NavigationItem[] = DEFAULT_ITEMS;\n\n  @query(\"ha-combo-box\", true) private comboBox!: HaComboBox;\n\n  protected render(): TemplateResult {\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        item-value-path=\"path\"\n        item-label-path=\"path\"\n        .value=${this._value}\n        allow-custom-value\n        .filteredItems=${this.navigationItems}\n        .label=${this.label}\n        .helper=${this.helper}\n        .disabled=${this.disabled}\n        .required=${this.required}\n        .renderer=${rowRenderer}\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n        @filter-changed=${this._filterChanged}\n      >\n      </ha-combo-box>\n    `;\n  }\n\n  private async _openedChanged(ev: ValueChangedEvent<boolean>) {\n    this._opened = ev.detail.value;\n    if (this._opened && !this.navigationItemsLoaded) {\n      this._loadNavigationItems();\n    }\n  }\n\n  private async _loadNavigationItems() {\n    this.navigationItemsLoaded = true;\n\n    const panels = Object.entries(this.hass!.panels).map(([id, panel]) => ({\n      id,\n      ...panel,\n    }));\n    const lovelacePanels = panels.filter(\n      (panel) => panel.component_name === \"lovelace\"\n    );\n\n    const viewConfigs = await Promise.all(\n      lovelacePanels.map((panel) =>\n        fetchConfig(\n          this.hass!.connection,\n          // path should be null to fetch default lovelace panel\n          panel.url_path === \"lovelace\" ? null : panel.url_path,\n          true\n        )\n          .then((config) => [panel.id, config] as [string, typeof config])\n          .catch((_) => [panel.id, undefined] as [string, undefined])\n      )\n    );\n\n    const panelViewConfig = new Map(viewConfigs);\n\n    this.navigationItems = [];\n\n    for (const panel of panels) {\n      this.navigationItems.push(createPanelNavigationItem(this.hass!, panel));\n\n      const config = panelViewConfig.get(panel.id);\n\n      if (!config || !(\"views\" in config)) continue;\n\n      config.views.forEach((view, index) =>\n        this.navigationItems.push(\n          createViewNavigationItem(panel.url_path, view, index)\n        )\n      );\n    }\n\n    this.comboBox.filteredItems = this.navigationItems;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues) {\n    return !this._opened || changedProps.has(\"_opened\");\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    ev.stopPropagation();\n    this._setValue(ev.detail.value);\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    fireEvent(\n      this,\n      \"value-changed\",\n      { value: this._value },\n      {\n        bubbles: false,\n        composed: false,\n      }\n    );\n  }\n\n  private _filterChanged(ev: CustomEvent): void {\n    const filterString = ev.detail.value.toLowerCase();\n    const characterCount = filterString.length;\n    if (characterCount >= 2) {\n      const filteredItems: NavigationItem[] = [];\n\n      this.navigationItems.forEach((item) => {\n        if (\n          item.path.toLowerCase().includes(filterString) ||\n          item.title.toLowerCase().includes(filterString)\n        ) {\n          filteredItems.push(item);\n        }\n      });\n\n      if (filteredItems.length > 0) {\n        this.comboBox.filteredItems = filteredItems;\n      } else {\n        this.comboBox.filteredItems = [];\n      }\n    } else {\n      this.comboBox.filteredItems = this.navigationItems;\n    }\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  static styles = css`\n    ha-icon,\n    ha-svg-icon {\n      color: var(--primary-text-color);\n      position: relative;\n      bottom: 0px;\n    }\n    *[slot=\"prefix\"] {\n      margin-right: 8px;\n      margin-inline-end: 8px;\n      margin-inline-start: initial;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-navigation-picker\": HaNavigationPicker;\n  }\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport type { NavigationSelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-navigation-picker\";\n\n@customElement(\"ha-selector-navigation\")\nexport class HaNavigationSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: NavigationSelector;\n\n  @property() public value?: string;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean, reflect: true }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  protected render() {\n    return html`\n      <ha-navigation-picker\n        .hass=${this.hass}\n        .label=${this.label}\n        .value=${this.value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        .helper=${this.helper}\n        @value-changed=${this._valueChanged}\n      ></ha-navigation-picker>\n    `;\n  }\n\n  private _valueChanged(ev: CustomEvent) {\n    fireEvent(this, \"value-changed\", { value: ev.detail.value });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-navigation\": HaNavigationSelector;\n  }\n}\n","import type { Connection } from \"home-assistant-js-websocket\";\nimport type { HomeAssistant } from \"../../../types\";\nimport type { LovelaceResource } from \"../resource\";\nimport type { LovelaceStrategyConfig } from \"./strategy\";\nimport type { LovelaceViewRawConfig } from \"./view\";\n\nexport interface LovelaceDashboardBaseConfig {}\n\nexport interface LovelaceConfig extends LovelaceDashboardBaseConfig {\n  background?: string;\n  views: LovelaceViewRawConfig[];\n}\n\nexport interface LovelaceDashboardStrategyConfig\n  extends LovelaceDashboardBaseConfig {\n  strategy: LovelaceStrategyConfig;\n}\n\nexport interface LegacyLovelaceConfig extends LovelaceConfig {\n  resources?: LovelaceResource[];\n}\n\nexport type LovelaceRawConfig =\n  | LovelaceConfig\n  | LovelaceDashboardStrategyConfig;\n\nexport function isStrategyDashboard(\n  config: LovelaceRawConfig\n): config is LovelaceDashboardStrategyConfig {\n  return \"strategy\" in config;\n}\n\nexport const fetchConfig = (\n  conn: Connection,\n  urlPath: string | null,\n  force: boolean\n): Promise<LovelaceRawConfig> =>\n  conn.sendMessagePromise({\n    type: \"lovelace/config\",\n    url_path: urlPath,\n    force,\n  });\n\nexport const saveConfig = (\n  hass: HomeAssistant,\n  urlPath: string | null,\n  config: LovelaceRawConfig\n): Promise<void> =>\n  hass.callWS({\n    type: \"lovelace/config/save\",\n    url_path: urlPath,\n    config,\n  });\n\nexport const deleteConfig = (\n  hass: HomeAssistant,\n  urlPath: string | null\n): Promise<void> =>\n  hass.callWS({\n    type: \"lovelace/config/delete\",\n    url_path: urlPath,\n  });\n"],"names":["titleCase","s","replace","_s","c","d","toUpperCase","DEFAULT_ITEMS","rowRenderer","item","html","_t","_2","icon","title","path","_t2","nothing","createViewNavigationItem","prefix","view","index","_view$path","_view$icon","_view$title","createPanelNavigationItem","hass","panel","_panel$icon","url_path","defaultPanel","localize","HaNavigationPicker","LitElement","render","_t3","_value","navigationItems","label","helper","disabled","required","_openedChanged","_valueChanged","_filterChanged","ev","this","_opened","detail","value","navigationItemsLoaded","_loadNavigationItems","panels","Object","entries","map","id","assign","lovelacePanels","filter","component_name","viewConfigs","Promise","all","fetchConfig","connection","then","config","catch","_","undefined","panelViewConfig","Map","push","get","views","forEach","comboBox","filteredItems","shouldUpdate","changedProps","has","stopPropagation","_setValue","fireEvent","bubbles","composed","filterString","toLowerCase","length","includes","args","styles","css","_t4","attribute","type","Boolean","HaNavigationSelector","reflect","conn","urlPath","force","sendMessagePromise"],"mappings":"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"}