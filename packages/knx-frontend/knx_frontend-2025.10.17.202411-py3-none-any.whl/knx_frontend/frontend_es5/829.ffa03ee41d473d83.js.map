{"version":3,"file":"829.ffa03ee41d473d83.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/ha-config-entry-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-config-entry.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/integration.ts","webpack://knx-frontend/./homeassistant-frontend/src/util/brands-url.ts"],"sourcesContent":["import type { ComboBoxLitRenderer } from \"@vaadin/combo-box/lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { caseInsensitiveStringCompare } from \"../common/string/compare\";\nimport type { ConfigEntry } from \"../data/config_entries\";\nimport { getConfigEntries } from \"../data/config_entries\";\nimport { domainToName } from \"../data/integration\";\nimport type { ValueChangedEvent, HomeAssistant } from \"../types\";\nimport { brandsUrl } from \"../util/brands-url\";\nimport \"./ha-combo-box\";\nimport type { HaComboBox } from \"./ha-combo-box\";\nimport \"./ha-combo-box-item\";\n\nexport interface ConfigEntryExtended extends ConfigEntry {\n  localized_domain_name?: string;\n}\n\n@customElement(\"ha-config-entry-picker\")\nclass HaConfigEntryPicker extends LitElement {\n  public hass!: HomeAssistant;\n\n  @property() public integration?: string;\n\n  @property() public label?: string;\n\n  @property() public value = \"\";\n\n  @property() public helper?: string;\n\n  @state() private _configEntries?: ConfigEntryExtended[];\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @query(\"ha-combo-box\") private _comboBox!: HaComboBox;\n\n  public open() {\n    this._comboBox?.open();\n  }\n\n  public focus() {\n    this._comboBox?.focus();\n  }\n\n  protected firstUpdated() {\n    this._getConfigEntries();\n  }\n\n  private _rowRenderer: ComboBoxLitRenderer<ConfigEntryExtended> = (\n    item\n  ) => html`\n    <ha-combo-box-item type=\"button\">\n      <span slot=\"headline\">\n        ${item.title ||\n        this.hass.localize(\n          \"ui.panel.config.integrations.config_entry.unnamed_entry\"\n        )}\n      </span>\n      <span slot=\"supporting-text\">${item.localized_domain_name}</span>\n      <img\n        alt=\"\"\n        slot=\"start\"\n        src=${brandsUrl({\n          domain: item.domain,\n          type: \"icon\",\n          darkOptimized: this.hass.themes?.darkMode,\n        })}\n        crossorigin=\"anonymous\"\n        referrerpolicy=\"no-referrer\"\n        @error=${this._onImageError}\n        @load=${this._onImageLoad}\n      />\n    </ha-combo-box-item>\n  `;\n\n  protected render() {\n    if (!this._configEntries) {\n      return nothing;\n    }\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .label=${this.label === undefined && this.hass\n          ? this.hass.localize(\"ui.components.config-entry-picker.config_entry\")\n          : this.label}\n        .value=${this._value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        .helper=${this.helper}\n        .renderer=${this._rowRenderer}\n        .items=${this._configEntries}\n        item-value-path=\"entry_id\"\n        item-id-path=\"entry_id\"\n        item-label-path=\"title\"\n        @value-changed=${this._valueChanged}\n      ></ha-combo-box>\n    `;\n  }\n\n  private _onImageLoad(ev) {\n    ev.target.style.visibility = \"initial\";\n  }\n\n  private _onImageError(ev) {\n    ev.target.style.visibility = \"hidden\";\n  }\n\n  private async _getConfigEntries() {\n    getConfigEntries(this.hass, {\n      type: [\"device\", \"hub\", \"service\"],\n      domain: this.integration,\n    }).then((configEntries) => {\n      this._configEntries = configEntries\n        .map(\n          (entry: ConfigEntry): ConfigEntryExtended => ({\n            ...entry,\n            localized_domain_name: domainToName(\n              this.hass.localize,\n              entry.domain\n            ),\n          })\n        )\n        .sort((conf1, conf2) =>\n          caseInsensitiveStringCompare(\n            conf1.localized_domain_name + conf1.title,\n            conf2.localized_domain_name + conf2.title,\n            this.hass.locale.language\n          )\n        );\n    });\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    ev.stopPropagation();\n    const newValue = ev.detail.value;\n\n    if (newValue !== this._value) {\n      this._setValue(newValue);\n    }\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    setTimeout(() => {\n      fireEvent(this, \"value-changed\", { value });\n      fireEvent(this, \"change\");\n    }, 0);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-config-entry-picker\": HaConfigEntryPicker;\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { ConfigEntrySelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-config-entry-picker\";\n\n@customElement(\"ha-selector-config_entry\")\nexport class HaConfigEntrySelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: ConfigEntrySelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  protected render() {\n    return html`<ha-config-entry-picker\n      .hass=${this.hass}\n      .value=${this.value}\n      .label=${this.label}\n      .helper=${this.helper}\n      .disabled=${this.disabled}\n      .required=${this.required}\n      .integration=${this.selector.config_entry?.integration}\n      allow-custom-entity\n    ></ha-config-entry-picker>`;\n  }\n\n  static styles = css`\n    ha-config-entry-picker {\n      width: 100%;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-config_entry\": HaConfigEntrySelector;\n  }\n}\n","import type { Connection } from \"home-assistant-js-websocket\";\nimport { createCollection } from \"home-assistant-js-websocket\";\nimport type { LocalizeFunc } from \"../common/translations/localize\";\nimport type { HomeAssistant } from \"../types\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport const integrationsWithPanel = {\n  bluetooth: \"config/bluetooth\",\n  dhcp: \"config/dhcp\",\n  matter: \"config/matter\",\n  mqtt: \"config/mqtt\",\n  ssdp: \"config/ssdp\",\n  thread: \"config/thread\",\n  zeroconf: \"config/zeroconf\",\n  zha: \"config/zha/dashboard\",\n  zwave_js: \"config/zwave_js/dashboard\",\n};\n\nexport type IntegrationType =\n  | \"device\"\n  | \"helper\"\n  | \"hub\"\n  | \"service\"\n  | \"hardware\"\n  | \"entity\"\n  | \"system\";\n\nexport interface IntegrationManifest {\n  is_built_in: boolean;\n  overwrites_built_in?: boolean;\n  domain: string;\n  name: string;\n  config_flow: boolean;\n  documentation: string;\n  issue_tracker?: string;\n  dependencies?: string[];\n  after_dependencies?: string[];\n  codeowners?: string[];\n  requirements?: string[];\n  ssdp?: { manufacturer?: string; modelName?: string; st?: string }[];\n  zeroconf?: string[];\n  homekit?: { models: string[] };\n  integration_type?: IntegrationType;\n  loggers?: string[];\n  quality_scale?:\n    | \"bronze\"\n    | \"silver\"\n    | \"gold\"\n    | \"platinum\"\n    | \"no_score\"\n    | \"internal\"\n    | \"legacy\"\n    | \"custom\";\n  iot_class:\n    | \"assumed_state\"\n    | \"cloud_polling\"\n    | \"cloud_push\"\n    | \"local_polling\"\n    | \"local_push\";\n  single_config_entry?: boolean;\n  version?: string;\n}\nexport interface IntegrationSetup {\n  domain: string;\n  seconds?: number;\n}\n\nexport interface IntegrationLogInfo {\n  domain: string;\n  level?: number;\n}\n\nexport enum LogSeverity {\n  CRITICAL = 50,\n  ERROR = 40,\n  WARNING = 30,\n  INFO = 20,\n  DEBUG = 10,\n  NOTSET = 0,\n}\n\nexport type IntegrationLogPersistance = \"none\" | \"once\" | \"permanent\";\n\nexport const integrationIssuesUrl = (\n  domain: string,\n  manifest: IntegrationManifest\n) =>\n  manifest.issue_tracker ||\n  `https://github.com/home-assistant/core/issues?q=is%3Aissue+is%3Aopen+label%3A%22integration%3A+${domain}%22`;\n\nexport const domainToName = (\n  localize: LocalizeFunc,\n  domain: string,\n  manifest?: IntegrationManifest\n) => localize(`component.${domain}.title`) || manifest?.name || domain;\n\nexport const fetchIntegrationManifests = (\n  hass: HomeAssistant,\n  integrations?: string[]\n) => {\n  const params: any = {\n    type: \"manifest/list\",\n  };\n  if (integrations) {\n    params.integrations = integrations;\n  }\n  return hass.callWS<IntegrationManifest[]>(params);\n};\n\nexport const fetchIntegrationManifest = (\n  hass: HomeAssistant,\n  integration: string\n) => hass.callWS<IntegrationManifest>({ type: \"manifest/get\", integration });\n\nexport const fetchIntegrationSetups = (hass: HomeAssistant) =>\n  hass.callWS<IntegrationSetup[]>({ type: \"integration/setup_info\" });\n\nexport const fetchIntegrationLogInfo = (conn) =>\n  conn.sendMessagePromise({\n    type: \"logger/log_info\",\n  });\n\nexport const setIntegrationLogLevel = (\n  hass: HomeAssistant,\n  integration: string,\n  level: string,\n  persistence: IntegrationLogPersistance\n) =>\n  hass.callWS({\n    type: \"logger/integration_log_level\",\n    integration,\n    level,\n    persistence,\n  });\n\nconst subscribeLogInfoUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchIntegrationLogInfo(conn).then((log_infos) =>\n          store.setState(log_infos, true)\n        ),\n      200,\n      true\n    ),\n    \"logging_changed\"\n  );\n\nexport const subscribeLogInfo = (\n  conn: Connection,\n  onChange: (devices: IntegrationLogInfo[]) => void\n) =>\n  createCollection<IntegrationLogInfo[]>(\n    \"_integration_log_info\",\n    fetchIntegrationLogInfo,\n    subscribeLogInfoUpdates,\n    conn,\n    onChange\n  );\n\nexport const waitForIntegrationSetup = (hass: HomeAssistant, domain: string) =>\n  hass.callWS<{ integration_loaded: boolean }>({\n    type: \"integration/wait\",\n    domain,\n  });\n","export interface BrandsOptions {\n  domain: string;\n  type: \"icon\" | \"logo\" | \"icon@2x\" | \"logo@2x\";\n  useFallback?: boolean;\n  darkOptimized?: boolean;\n  brand?: boolean;\n}\n\nexport interface HardwareBrandsOptions {\n  category: string;\n  model?: string;\n  manufacturer: string;\n  darkOptimized?: boolean;\n}\n\nexport const brandsUrl = (options: BrandsOptions): string =>\n  `https://brands.home-assistant.io/${options.brand ? \"brands/\" : \"\"}${\n    options.useFallback ? \"_/\" : \"\"\n  }${options.domain}/${options.darkOptimized ? \"dark_\" : \"\"}${\n    options.type\n  }.png`;\n\nexport const hardwareBrandsUrl = (options: HardwareBrandsOptions): string =>\n  `https://brands.home-assistant.io/hardware/${options.category}/${\n    options.darkOptimized ? \"dark_\" : \"\"\n  }${options.manufacturer}${options.model ? `_${options.model}` : \"\"}.png`;\n\nexport const extractDomainFromBrandUrl = (url: string) => url.split(\"/\")[4];\n\nexport const isBrandUrl = (thumbnail: string | \"\"): boolean =>\n  thumbnail.startsWith(\"https://brands.home-assistant.io/\");\n"],"names":["HaConfigEntryPicker","LitElement","open","_this$_comboBox","this","_comboBox","focus","_this$_comboBox2","firstUpdated","_getConfigEntries","render","_configEntries","html","_t","_","hass","undefined","label","localize","_value","required","disabled","helper","_rowRenderer","_valueChanged","nothing","_onImageLoad","ev","target","style","visibility","_onImageError","getConfigEntries","type","domain","integration","then","configEntries","map","entry","Object","assign","localized_domain_name","domainToName","sort","conf1","conf2","caseInsensitiveStringCompare","title","locale","language","value","stopPropagation","newValue","detail","_setValue","setTimeout","fireEvent","args","item","_this$hass$themes","_t2","brandsUrl","darkOptimized","themes","darkMode","Boolean","HaConfigEntrySelector","_this$selector$config","selector","config_entry","styles","css","attribute","manifest","name","fetchIntegrationManifests","integrations","params","callWS","fetchIntegrationManifest","options","brand","useFallback","extractDomainFromBrandUrl","url","split","isBrandUrl","thumbnail","startsWith"],"mappings":"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"}