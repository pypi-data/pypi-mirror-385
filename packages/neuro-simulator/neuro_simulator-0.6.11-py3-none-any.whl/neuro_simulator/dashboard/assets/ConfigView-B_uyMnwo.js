const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FieldRenderer-B-fLeJO4.js","assets/index-CxlwjfZg.js","assets/index-CmE5ZLMr.css"])))=>i.map(i=>d[i]);
import{d as U,u as E,j as G,b as I,k as V,l as W,m as $,n as _,f as n,i as k,e as i,t as f,h as d,w as s,F as A,p as F,g as m,o as c,c as O,q as P,s as q,v as z}from"./index-CxlwjfZg.js";const Z={key:0,class:"text-center pa-10"},H={class:"mt-4"},J={key:1},K={class:"text-h4 mb-6"},Q={key:0,class:"mt-10"},X={class:"mb-4"},Y={class:"d-flex flex-wrap ga-4"},ae=U({__name:"ConfigView",setup(ee){const{t}=E(),B=q(()=>z(()=>import("./FieldRenderer-B-fLeJO4.js"),__vite__mapDeps([0,1,2]))),v=G(),h=I(),C=V(!0),y=V(null),x=V(!1),D=W(()=>{const o=v.schema;if(!o||!o.properties)return[];const p=["llm_providers","tts_providers","neuro","chatbot","stream","server"],g=Object.keys(o.properties);return g.sort((a,r)=>{const l=p.indexOf(a),u=p.indexOf(r);return l!==-1&&u!==-1?l-u:l!==-1?-1:u!==-1?1:a.localeCompare(r)}),g.map(a=>{const r=o.properties[a];if(r.$ref){const l=r.$ref.split("/").pop()||"",u=o.$defs?.[l]||{},w=u.properties||{};return{key:a,title:r.title||u.title||a.charAt(0).toUpperCase()+a.slice(1),isGroup:!0,properties:Object.keys(w).map(b=>({key:b,schema:w[b]}))}}return{key:a,title:r.title||a.charAt(0).toUpperCase()+a.slice(1),isGroup:!1,properties:[{key:a,schema:r}]}})});async function N(){if(h.isConnected){x.value=!0;try{await h.sendAdminWsMessage("update_configs",v.config),console.log("Config saved successfully!")}catch(o){console.error("Failed to save config:",o)}finally{x.value=!1}}}async function j(){if(confirm(t("Are you sure you want to reset all settings to their default values? This cannot be undone.")))try{await h.sendAdminWsMessage("reset_config_to_defaults",{}),alert(t("Configuration has been reset. The new settings are now active."))}catch(o){console.error("Failed to reset config:",o),alert(t("Failed to reset configuration."))}}async function L(){if(confirm(t("Are you sure you want to reset all data (prompts, memory, etc.) to the initial state? This cannot be undone.")))try{await h.sendAdminWsMessage("reset_data_directories",{}),alert(t("Data has been reset. The application is re-initializing with the new data."))}catch(o){console.error("Failed to reset data:",o),alert(t("Failed to reset data."))}}return $(async()=>{C.value=!0;try{await v.fetchSchema(),await v.fetchConfig()}finally{C.value=!1}}),(o,p)=>{const g=i("v-progress-circular"),a=i("v-tab"),r=i("v-tabs"),l=i("v-btn"),u=i("v-card-actions"),w=i("v-card-title"),b=i("v-card-text"),T=i("v-card"),M=i("v-window-item"),R=i("v-window");return c(),_("div",null,[C.value?(c(),_("div",Z,[n(g,{indeterminate:"",color:"primary"}),k("p",H,f(d(t)("Loading configuration...")),1)])):(c(),_("div",J,[n(r,{modelValue:y.value,"onUpdate:modelValue":p[0]||(p[0]=e=>y.value=e),"bg-color":"primary",class:"mb-4 config-tabs",grow:""},{default:s(()=>[(c(!0),_(A,null,F(D.value,e=>(c(),O(a,{key:e.key,value:e.key},{default:s(()=>[m(f(d(t)(e.title)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),n(u,{class:"justify-end pa-4"},{default:s(()=>[n(l,{onClick:N,color:"primary",variant:"flat",loading:x.value},{default:s(()=>[m(f(d(t)("Save Configuration")),1)]),_:1},8,["loading"])]),_:1}),n(R,{modelValue:y.value,"onUpdate:modelValue":p[1]||(p[1]=e=>y.value=e),eager:""},{default:s(()=>[(c(!0),_(A,null,F(D.value,e=>(c(),O(M,{key:e.key,value:e.key},{default:s(()=>[n(T,{flat:"",class:"pa-4"},{default:s(()=>[k("h1",K,f(d(t)(e.title)),1),(c(!0),_(A,null,F(e.properties,S=>(c(),_("div",{key:S.key},[n(d(B),{"group-key":e.isGroup?e.key:null,"prop-key":S.key,"prop-schema":S.schema},null,8,["group-key","prop-key","prop-schema"])]))),128)),e.key==="server"?(c(),_("div",Q,[n(T,{border:"",color:"error",variant:"outlined"},{default:s(()=>[n(w,{class:"text-h5"},{default:s(()=>[m(f(d(t)("Danger Zone")),1)]),_:1}),n(b,null,{default:s(()=>[k("p",X,f(d(t)("These actions are destructive and cannot be undone.")),1),k("div",Y,[n(l,{onClick:j,color:"error",variant:"flat"},{default:s(()=>[m(f(d(t)("Reset Settings to Default")),1)]),_:1}),n(l,{onClick:L,color:"error",variant:"flat"},{default:s(()=>[m(f(d(t)("Reset Data to Initial State")),1)]),_:1})])]),_:1})]),_:1})])):P("",!0)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]))])}}});export{ae as default};
